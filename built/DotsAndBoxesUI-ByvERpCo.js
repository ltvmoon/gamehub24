import{j as e}from"./index-DRyUeaM1.js";import{j as s,Q as t,m as a}from"./react-vendor-BD7JSMcH.js";import"./socket-DRbsQkF5.js";import"./zustand-BJRBDsWD.js";const l={red:"bg-red-500/60",blue:"bg-blue-500/60"},r={red:"text-red-500",blue:"text-blue-500"};function n({game:n,currentUserId:i}){const o=n,[d,c]=s.useState(o.getState());s.useEffect(()=>{o.onUpdate(c),c(o.getState()),o.requestSync()},[o]);const x=d.players[d.currentPlayerIndex],m=x?.id===i,u=d.isGameEnded,h=100/(d.gridSize-1);return e.jsxs("div",{className:"flex flex-col items-center gap-6 p-4 w-full max-w-2xl mx-auto",children:[e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("h2",{className:"text-3xl font-bold text-white",children:"Dots & Boxes"}),u||"playing"!==d.gamePhase?u?e.jsxs("div",{className:"text-2xl font-bold text-white mb-2",children:["Game Over!"," ","draw"===d.winner?"It's a Draw!":`${d.players.find(e=>e.id===d.winner)?.username} Wins!`]}):null:e.jsx("div",{className:"text-lg",children:m?e.jsx("span",{className:"text-green-400 font-bold animate-pulse",children:"Your Turn!"}):e.jsxs("span",{className:"text-gray-300",children:["Waiting for"," ",e.jsx("span",{className:`${r[x.color]} font-bold`,children:x.username}),"..."]})}),e.jsx("div",{className:"flex gap-4 md:gap-8 bg-slate-800 p-4 rounded-xl shadow-lg border border-slate-700 w-full justify-center",children:d.players.map((s,t)=>e.jsxs("div",{className:`flex flex-col items-center gap-2 p-2 rounded-lg transition-all ${d.currentPlayerIndex!==t||u?"border-2 border-transparent":"bg-slate-700 scale-105 shadow-md border-2 "+("red"===s.color?"border-red-500":"border-blue-500")} ${s.id?"":"opacity-60"}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full "+("red"===s.color?"bg-red-500":"bg-blue-500")}),e.jsx("div",{className:"text-sm font-bold "+("red"===s.color?"text-red-500":"text-blue-500"),children:s.id?s.username:"Empty"})]}),s.id?e.jsx("div",{className:"flex flex-col items-center",children:e.jsx("div",{className:"text-3xl font-black "+("red"===s.color?"text-red-500":"text-blue-500"),children:s.score})}):e.jsx("div",{className:"h-9 flex items-center",children:e.jsx("span",{className:"text-gray-500 text-xs italic",children:"Waiting..."})}),o.isHostUser&&!u&&d.boxes.every(e=>e.every(e=>null===e))&&e.jsx("div",{className:"mt-1",children:s.isBot?e.jsx("button",{onClick:()=>o.requestRemoveBot(t),className:"text-xs bg-red-900 hover:bg-red-800 text-red-100 px-2 py-1 rounded",children:"Remove Bot"}):!s.id&&e.jsx("button",{onClick:()=>o.requestAddBot(t),className:"text-xs bg-cyan-900 hover:bg-cyan-800 text-cyan-100 px-2 py-1 rounded",children:"+ Add Bot"})})]},`player-${t}`))})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 justify-center",children:[!u&&"waiting"===d.gamePhase&&o.isHostUser&&e.jsxs("button",{onClick:()=>o.requestStartGame(),disabled:!o.canStartGame(),className:"flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-500 text-white rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(t,{className:"w-4 h-4"})," Start Game"]}),o.isHostUser&&"waiting"!==d.gamePhase&&e.jsxs("button",{onClick:()=>o.requestNewGame(),className:"flex items-center gap-2 px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg transition-colors",children:[e.jsx(a,{className:"w-4 h-4"})," ",u?"Play Again":"New Game"]}),"playing"===d.gamePhase&&!u&&e.jsx("button",{onClick:()=>o.requestUndo(),className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg",children:"Undo"})]}),d.undoRequest&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:e.jsxs("div",{className:"bg-slate-800 p-4 rounded-lg shadow-xl border border-slate-600 flex flex-col gap-3",children:[e.jsxs("p",{className:"text-white",children:[d.players.find(e=>e.id===d.undoRequest?.requesterId)?.username," ","requested to undo the last move."]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>o.rejectUndo(),className:"px-3 py-1 bg-red-600 hover:bg-red-500 text-white rounded",children:"Reject"}),e.jsx("button",{onClick:()=>o.approveUndo(),className:"px-3 py-1 bg-green-600 hover:bg-green-500 text-white rounded",children:"Approve"})]})]})}),e.jsx("div",{className:"relative aspect-square w-full max-w-[400px] bg-slate-900 p-6 rounded-lg shadow-2xl select-none touch-none border-2 border-slate-700",children:e.jsxs("div",{className:"relative w-full h-full",children:[d.boxes.map((s,t)=>s.map((s,a)=>{const n=d.players.find(e=>e.id===s);return n?e.jsx("div",{className:`absolute flex items-center justify-center rounded-sm transition-all duration-500 scale-90 ${l[n.color]}`,style:{top:t*h+"%",left:a*h+"%",width:`${h}%`,height:`${h}%`},children:e.jsx("div",{className:`text-2xl font-bold ${r[n.color]}`,children:n.username[0].toUpperCase()})},`box-${t}-${a}`):null})),["horizontal","vertical"].map(s=>("horizontal"===s?d.horizontalLines:d.verticalLines).map((t,a)=>t.map((t,l)=>{const r=d.lastLine?.type===s&&d.lastLine.row===a&&d.lastLine.col===l,n="horizontal"===s;return e.jsx("div",{onClick:()=>{return e=s,t=a,r=l,void(m&&!u&&"playing"===d.gamePhase&&("horizontal"===e&&d.horizontalLines[t][r]||"vertical"===e&&d.verticalLines[t][r]||o.requestPlaceLine(e,t,r)));var e,t,r},className:`absolute cursor-pointer transition-all duration-200 rounded-full z-10\n                      ${n?"h-2 -translate-y-1/2":"w-2 -translate-x-1/2"}\n                      ${t?r?"bg-yellow-400 shadow-[0_0_12px_4px_rgba(250,204,21,0.7)] animate-pulse":"bg-white shadow-[0_0_8px_2px_rgba(255,255,255,0.4)]":"playing"===d.gamePhase?"bg-slate-700 hover:bg-slate-400":"bg-slate-800 cursor-default"}`,style:{top:a*h+"%",left:l*h+"%",...n?{width:`${h}%`}:{height:`${h}%`}},children:!t&&"playing"===d.gamePhase&&e.jsx("div",{className:"absolute inset-0 "+(n?"-top-2 -bottom-2":"-left-2 -right-2")})},`${s[0]}-${a}-${l}`)})))]})})]})}export{n as default};
