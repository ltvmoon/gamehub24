import{u as e,j as s}from"./index-DMqWoiuV.js";import{c as n,ab as t,J as l,X as a,a9 as i,a3 as r,$ as o,s as c,ae as d}from"./react-vendor-BYtLKAeB.js";import"./socket-DRbsQkF5.js";import{C as h,R as x}from"./types-zc5glPn-.js";import"./zustand-BLoNJECv.js";function m({game:m,currentUserId:u}){const g=m,[p,f]=n.useState(g.getState()),[v,b]=n.useState(null),[j,w]=n.useState(!1),{ti:y,ts:N}=e();n.useEffect(()=>g.onUpdate(f),[g]);const C=g.getMyPlayerIndex(),k=C>=0?p.players[C].color:null,q=p.players[p.currentPlayerIndex],P=q?.id===u,$=g.isHost,R=e=>{"playing"===p.gamePhase&&P&&(g.isColumnFull(e)||g.requestMove(e))},B=(e,n)=>{const t=p.board[e][n],l=((e,s)=>p.winningCells?.some(n=>n.row===e&&n.col===s))(e,n),a=((e,s)=>p.lastMove?.row===e&&p.lastMove?.col===s)(e,n);return s.jsx("div",{className:"aspect-square flex items-center justify-center bg-blue-700 p-1",children:s.jsx("div",{className:`\n            w-full h-full rounded-full transition-all duration-200\n            ${t?"":"bg-blue-900"}\n            ${"red"===t?"bg-red-500":""}\n            ${"yellow"===t?"bg-yellow-400":""}\n            ${l?"ring-4 ring-white animate-pulse":""}\n            ${a&&!l?"ring-2 ring-white/50":""}\n          `,style:a&&t?{animation:"drop 0.5s ease-out"}:void 0})},`${e}-${n}`)};return s.jsxs("div",{className:"flex flex-col items-center gap-4 p-4 w-full max-w-lg mx-auto",children:[j&&t.createPortal(s.jsx("div",{className:"fixed inset-0 z-60 flex items-center justify-center bg-black/80 p-4",onClick:()=>w(!1),children:s.jsxs("div",{className:"bg-slate-800 rounded-xl max-w-2xl w-full max-h-[90%] flex flex-col shadow-2xl border border-slate-600",onClick:e=>e.stopPropagation(),children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-700",children:[s.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[s.jsx(d,{className:"w-6 h-6 text-yellow-500"}),y({en:"Game Rules",vi:"Lu·∫≠t Ch∆°i"})]}),s.jsx("button",{onClick:()=>w(!1),className:"p-1 hover:bg-slate-700 rounded transition-colors text-white",children:s.jsx(a,{className:"w-6 h-6"})})]}),s.jsx("div",{className:"flex-1 overflow-y-auto p-6 custom-scrollbar text-slate-300",children:s.jsxs("div",{className:"space-y-4",children:[s.jsx("p",{children:y({en:"Connect 4 is a two-player connection board game, in which the players choose a color and then take turns dropping colored discs into a seven-column, six-row vertically suspended grid.",vi:"Connect 4 (C·ªù ca-r√¥ x·∫øp ƒë·ª©ng) l√† tr√≤ ch∆°i d√†nh cho 2 ng∆∞·ªùi, l·∫ßn l∆∞·ª£t th·∫£ c√°c qu√¢n c·ªù m√†u v√†o l∆∞·ªõi x·∫øp ƒë·ª©ng 7 c·ªôt 6 h√†ng."})}),s.jsx("h3",{className:"text-lg font-bold text-yellow-400 mt-4",children:y({en:"Objective",vi:"M·ª•c ti√™u"})}),s.jsx("ul",{className:"list-disc pl-5 space-y-1",children:s.jsx("li",{children:y({en:"Be the first to form a horizontal, vertical, or diagonal line of four of one's own discs.",vi:"L√† ng∆∞·ªùi ƒë·∫ßu ti√™n x·∫øp ƒë∆∞·ª£c 4 qu√¢n li√™n ti·∫øp theo h√†ng ngang, d·ªçc ho·∫∑c ch√©o."})})}),s.jsx("h3",{className:"text-lg font-bold text-yellow-400 mt-4",children:y({en:"Gameplay",vi:"Lu·∫≠t ch∆°i"})}),s.jsxs("ul",{className:"list-disc pl-5 space-y-1",children:[s.jsx("li",{children:y({en:"Players take turns dropping one of their discs into an unfilled column.",vi:"Ng∆∞·ªùi ch∆°i l·∫ßn l∆∞·ª£t th·∫£ qu√¢n c·ªßa m√¨nh v√†o m·ªôt c·ªôt ch∆∞a ƒë·∫ßy."})}),s.jsx("li",{children:y({en:"The disc occupies the lowest available space within the column.",vi:"Qu√¢n c·ªù s·∫Ω r∆°i xu·ªëng v·ªã tr√≠ th·∫•p nh·∫•t c√≥ th·ªÉ trong c·ªôt."})})]}),s.jsx("h3",{className:"text-lg font-bold text-yellow-400 mt-4",children:y({en:"Winning",vi:"Chi·∫øn th·∫Øng"})}),s.jsx("ul",{className:"list-disc pl-5 space-y-1",children:s.jsx("li",{children:y({en:"The game ends when a player connects 4 discs or the board is full (draw).",vi:"Tr√≤ ch∆°i k·∫øt th√∫c khi c√≥ ng∆∞·ªùi x·∫øp ƒë∆∞·ª£c 4 qu√¢n ho·∫∑c b√†n c·ªù ƒë·∫ßy (h√≤a)."})})})]})})]})}),document.body),s.jsx("style",{dangerouslySetInnerHTML:{__html:"\n@keyframes drop {\n  0% { transform: translateY(-400px); }\n  60% { transform: translateY(10px); }\n  80% { transform: translateY(-5px); }\n  100% { transform: translateY(0); }\n}\n"}}),s.jsxs("div",{className:"flex flex-col gap-2 p-4 bg-slate-800 rounded-lg w-full",children:[s.jsx("h3",{className:"text-sm font-medium text-gray-400 mb-1",children:"Players"}),p.players.map((e,n)=>s.jsxs("div",{className:`\n              flex items-center justify-between p-2 rounded-lg\n              ${p.currentPlayerIndex===n&&"playing"===p.gamePhase?"bg-slate-600 ring-2 ring-blue-400":"bg-slate-700"}\n            `,children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:`\n                  w-6 h-6 rounded-full\n                  ${"red"===e.color?"bg-red-500":"bg-yellow-400"}\n                `}),s.jsxs("span",{className:"text-white",children:[e.id?e.username:y({en:"(waiting...)",vi:"(ƒëang ch·ªù...)"}),e.isBot&&" ü§ñ",e.id===u&&y({en:" (You)",vi:" (B·∫°n)"})]})]}),e.isBot&&$&&"waiting"===p.gamePhase&&s.jsx("button",{onClick:()=>g.requestRemoveBot(),className:"text-xs px-2 py-1 bg-red-600 hover:bg-red-500 text-white rounded transition-colors",children:y({en:"Remove",vi:"X√≥a"})})]},n))]}),"playing"===p.gamePhase&&s.jsx("div",{className:"text-lg text-gray-400",children:P?s.jsx("span",{className:"text-green-400",children:y({en:"Your turn! Click a column.",vi:"L∆∞·ª£t c·ªßa b·∫°n! Ch·ªçn m·ªôt c·ªôt."})}):s.jsxs("span",{children:[y({en:"Waiting for",vi:"ƒêang ch·ªù"})," ",q?.username,"..."]})}),p.undoRequest&&p.undoRequest.fromId!==u&&s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-slate-800 rounded-xl p-6 shadow-xl max-w-sm mx-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:y({en:"Undo Request",vi:"Y√™u c·∫ßu ho√†n t√°c"})}),s.jsxs("p",{className:"text-gray-400 mb-4",children:[p.undoRequest.fromName," ",y({en:"wants to undo their last move.",vi:"mu·ªën ho√†n t√°c n∆∞·ªõc ƒëi cu·ªëi."})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsxs("button",{onClick:()=>g.acceptUndo(),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-500 text-white rounded-lg transition-colors",children:[s.jsx(l,{className:"w-4 h-4"})," ",y({en:"Accept",vi:"ƒê·ªìng √Ω"})]}),s.jsxs("button",{onClick:()=>g.declineUndo(),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-red-600 hover:bg-red-500 text-white rounded-lg transition-colors",children:[s.jsx(a,{className:"w-4 h-4"})," ",y({en:"Decline",vi:"T·ª´ ch·ªëi"})]})]})]})}),p.undoRequest&&p.undoRequest.fromId===u&&s.jsx("div",{className:"text-yellow-400 text-sm",children:y({en:"Waiting for opponent to accept undo...",vi:"ƒêang ch·ªù ƒë·ªëi th·ªß ch·∫•p nh·∫≠n ho√†n t√°c..."})}),"ended"===p.gamePhase&&s.jsxs("div",{className:"text-center p-4 bg-slate-800 rounded-lg",children:[s.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:y({en:"Game Over!",vi:"K·∫øt th√∫c!"})}),s.jsx("p",{className:"text-gray-300",children:"draw"===p.winner?y({en:"It's a draw!",vi:"H√≤a!"}):p.winner===u?y({en:"üéâ You won!",vi:"üéâ B·∫°n th·∫Øng!"}):`${p.players.find(e=>e.id===p.winner)?.username} ${y({en:"wins!",vi:"th·∫Øng!"})}`})]}),s.jsxs("div",{className:"flex gap-3 flex-wrap justify-center",children:["waiting"===p.gamePhase&&s.jsxs(s.Fragment,{children:[$&&!p.players[1].id&&s.jsxs("button",{onClick:()=>g.requestAddBot(),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white rounded-lg transition-colors",children:[s.jsx(i,{className:"w-4 h-4"})," ",y({en:"Add Bot",vi:"Th√™m Bot"})]}),$&&g.canStartGame()&&s.jsxs("button",{onClick:()=>g.requestStartGame(),className:"flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-500 text-white rounded-lg transition-colors",children:[s.jsx(r,{className:"w-4 h-4"})," ",y({en:"Start Game",vi:"B·∫Øt ƒë·∫ßu"})]})]}),"playing"===p.gamePhase&&s.jsx(s.Fragment,{children:C>=0&&p.moveHistory.length>0&&!p.undoRequest&&s.jsxs("button",{onClick:()=>g.requestUndo(),className:"flex items-center gap-2 px-4 py-2 bg-slate-600 hover:bg-slate-500 text-white rounded-lg transition-colors",children:[s.jsx(o,{className:"w-4 h-4"})," ",y({en:"Undo",vi:"Ho√†n t√°c"})]})}),"ended"===p.gamePhase&&s.jsxs("button",{onClick:()=>g.requestNewGame(),className:"flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-500 text-white rounded-lg transition-colors",children:[s.jsx(c,{className:"w-4 h-4"})," ",y({en:"Play Again",vi:"Ch∆°i l·∫°i"})]})]}),s.jsxs("div",{className:"w-full max-w-[400px]",children:["playing"===p.gamePhase&&s.jsx("div",{className:"grid grid-cols-7 gap-1 mb-1",children:Array(h).fill(null).map((e,n)=>{const t="playing"===p.gamePhase&&P&&!g.isColumnFull(n),l=v===n&&t;return s.jsx("div",{className:`\n                  aspect-square flex items-center justify-center\n                  rounded-full transition-all duration-200\n                  ${t?"cursor-pointer":"cursor-default"}\n                `,onMouseEnter:()=>b(n),onMouseLeave:()=>b(null),onClick:()=>R(n),children:l&&s.jsx("div",{className:`\n                      w-[80%] h-[80%] rounded-full opacity-60\n                      ${"red"===k?"bg-red-500":"bg-yellow-400"}\n                    `})},n)})}),s.jsx("div",{className:"grid gap-1 p-2 bg-blue-800 rounded-lg shadow-xl",style:{gridTemplateColumns:`repeat(${h}, 1fr)`},onMouseLeave:()=>b(null),children:Array(x).fill(null).map((e,n)=>Array(h).fill(null).map((e,t)=>s.jsx("div",{className:"cursor-pointer",onMouseEnter:()=>b(t),onClick:()=>R(t),children:B(n,t)},`${n}-${t}`)))})]}),s.jsx("button",{onClick:()=>w(!0),className:"fixed bottom-4 right-4 p-3 bg-slate-700 hover:bg-slate-600 rounded-full text-yellow-500 transition-colors z-40 shadow-lg border border-slate-500",title:N({en:"Rules",vi:"Lu·∫≠t ch∆°i"}),children:s.jsx(d,{size:24})})]})}export{m as default};
