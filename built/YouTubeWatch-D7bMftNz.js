import{B as t}from"./BaseGame-Di8Z51TE.js";import"./socket-DRbsQkF5.js";import"./index-CZ7EuLwr.js";import"./react-vendor-B6_iA-Ai.js";import"./zustand-DzQBgWHa.js";class e extends t{getInitState(){return{videoId:"",isPlaying:!1,timestamp:0,lastUpdate:Date.now(),allowGuestControl:!1}}onSocketGameAction(t){const e=t.action;"SET_VIDEO"===e.type?this.handleSetVideo(e.payload):"TOGGLE_GUEST_CONTROL"===e.type&&this.isHost&&this.handleToggleGuestControl(e.payload)}makeAction(t){this.isHost?("SET_VIDEO"===t.type&&this.handleSetVideo(t.payload),"TOGGLE_GUEST_CONTROL"===t.type&&this.handleToggleGuestControl(t.payload)):this.sendSocketGameAction(t)}sync(t,e){this.state.isPlaying=t,this.state.timestamp=e,this.syncState()}handleSetVideo(t){this.isHost&&(this.state.videoId=t,this.state.isPlaying=!0,this.state.timestamp=0,this.state.lastUpdate=Date.now(),this.syncState())}handleToggleGuestControl(t){this.isHost&&(this.state.allowGuestControl=t,this.syncState())}setVideo(t){const e=this.extractVideoId(t);if(!e)return;const s={type:"SET_VIDEO",payload:e};this.makeAction(s)}toggleGuestControl(t){const e={type:"TOGGLE_GUEST_CONTROL",payload:t};this.makeAction(e)}extractVideoId(t){const e=[/(?:youtube\.com\/watch\?v=|youtu\.be\/|youtube\.com\/embed\/)([^&\n?#]+)/,/^([a-zA-Z0-9_-]{11})$/];for(const s of e){const e=t.match(s);if(e)return e[1]}return null}}export{e as default};
