import{j as e,b as s,a as t,u as a,e as l,S as n}from"./index-BuwAuyRH.js";import{b as r,c as i,y as d,aI as c,as as o,X as h,av as x,aF as m,aG as u,aH as g,S as p,bp as b,l as f,bq as v,aD as j,ar as w,U as N,a4 as y}from"./react-vendor-BPKxesl1.js";import"./BaseGame-Bn3OX2xB.js";import{d as P,a as C,S as k}from"./types-BxbibcNM.js";import{u as R}from"./useGameState-6Sg9cn7I.js";import{u as D}from"./usePrevious-CkimZINh.js";import{F as I}from"./FlyingCard-By50-_Qd.js";import"./socket-DRbsQkF5.js";import"./zustand-BVhu8Aq7.js";const T={[k.SPADE]:e.jsx(p,{className:"@md:w-4 @md:h-4 w-3 h-3",fill:"black"}),[k.CLUB]:e.jsx(g,{className:"@md:w-4 @md:h-4 w-3 h-3",fill:"black"}),[k.DIAMOND]:e.jsx(u,{className:"@md:w-4 @md:h-4 w-3 h-3",fill:"red"}),[k.HEART]:e.jsx(m,{className:"@md:w-4 @md:h-4 w-3 h-3",fill:"red"})};function S({game:m}){const u=m,{confirm:g}=s(),[p]=R(u),[w,N]=r.useState(null),[y,S]=r.useState(!1),[$,E]=r.useState(!1),[G,q]=r.useState(null),M=r.useRef(null),{username:O}=t(),{ti:z,ts:J}=a(),{currentRoom:L}=l(),[K,V]=r.useState(null),F=r.useRef(null),W=r.useRef(Array(4).fill(null)),Y=r.useRef(null),Q=r.useRef(null),U=u.canStartGame(),X=u.isHost,Z=u.getMyPlayerIndex(),_=Z>=0?p.players[Z]:null,ee=p.currentTurnIndex===Z,se=D(p.drawPile.length),te=D(p.players.map(e=>e.hand.length)),ae=D(p.lastDiscardedCard),le=D(p.currentTurnIndex);r.useEffect(()=>{if("playing"===p.gamePhase)if(ae&&!p.lastDiscardedCard){const e=p.players.findIndex((e,s)=>{const t=te?.[s]??0;return e.hand.length>t});-1!==e&&(V({fromPlayerIndex:-2,direction:"toHand",targetPlayerIndex:e,card:ae,hidden:!1}),e===Z&&q(ae))}else if(void 0!==se&&p.drawPile.length<se){const e=p.players.findIndex((e,s)=>{const t=te?.[s]??0;return e.hand.length>t});if(-1!==e){const s=e===Z?p.players[e].hand[p.players[e].hand.length-1]:void 0;V({fromPlayerIndex:-1,direction:"toHand",targetPlayerIndex:e,hidden:e!==Z,card:s}),e===Z&&void 0!==s&&q(s)}}else if(p.lastDiscardedCard&&p.lastDiscardedCard!==ae){V({fromPlayerIndex:le??0,direction:"toDiscard",card:p.lastDiscardedCard,hidden:!1})}},[p,Z,se,te,ae,le]),r.useEffect(()=>{"drawing"===p.turnPhase&&q(null)},[p.turnPhase]),r.useEffect(()=>{"playing"===p.gamePhase&&void 0!==le&&le!==p.currentTurnIndex&&n.playTurnSwitch(ee)},[p.currentTurnIndex,ee,p.gamePhase,le]);const ne=r.useMemo(()=>{if(!K||!F.current)return null;const{fromPlayerIndex:e,direction:s,targetPlayerIndex:t}=K,a=e=>{const s=(e-(Z>=0?Z:0)+4)%4;return 0===s&&M.current?M.current.getBoundingClientRect():W.current[s]?W.current[s].getBoundingClientRect():null};let l=null,n=null;return"toDiscard"===s?(l=a(e),n=Q.current?Q.current.getBoundingClientRect():null):"toHand"===s?(l=-1===e?Y.current?Y.current.getBoundingClientRect():null:-2===e&&Q.current?Q.current.getBoundingClientRect():null,n=a(t)):"toPhom"===s&&(l=a(e),n=W.current[(t-(Z>=0?Z:0)+4)%4]?W.current[(t-(Z>=0?Z:0)+4)%4].getBoundingClientRect():null),l&&n?{sourceRect:l,targetRect:n}:null},[K,Z]),re=r.useMemo(()=>L?.players.some(e=>e.id===u.userId)??!1,[L,u]);r.useEffect(()=>u.onUpdate(e=>{N(null)}),[u]);const ie=e=>{ee&&"playing"===p.gamePhase&&_&&"drawing"!==p.turnPhase&&N(w===e?null:e)},de=()=>{u.requestDraw()},ce=()=>{u.requestEat()},oe=r.useMemo(()=>{const e=[],s=Z>=0?Z:0;for(let t=0;t<4;t++){const a=(s+t)%4;e.push({slot:p.players[a],actualIndex:a})}return e},[p.players,Z]),he=(s,t=!1)=>{const a=oe[s];if(!a)return null;const l=Z>=0;return e.jsx(B,{slot:a.slot,index:a.actualIndex,isCurrentTurn:p.currentTurnIndex===a.actualIndex,isHost:X,gamePhase:p.gamePhase,onAddBot:()=>u.requestAddBot(a.actualIndex),onJoinSlot:()=>u.requestJoinSlot(a.actualIndex,O),onRemove:()=>u.requestRemovePlayer(a.actualIndex),compact:t,isInGame:l,canJoin:!X&&"waiting"===p.gamePhase&&!l&&re},a.actualIndex)};return e.jsxs("div",{ref:F,className:"relative flex flex-col h-full p-2 @md:p-4 gap-4 @md:gap-6 overflow-hidden pb-16!",children:[e.jsx("div",{className:"flex flex-wrap justify-center gap-2 @md:gap-4",children:oe.slice(1).map((s,t)=>e.jsx("div",{ref:e=>{W.current[t+1]=e},children:he(t+1,!0)},t+1))}),e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center min-h-[220px] bg-slate-800/30 rounded-2xl p-4 @md:p-8 relative",children:["waiting"===p.gamePhase&&e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("span",{className:"text-slate-400",children:J({en:"Waiting for players...",vi:"Äang chá» ngÆ°á»i chÆ¡i..."})}),X&&U&&e.jsxs("button",{onClick:()=>u.requestStartGame(),className:"px-8 py-3 bg-slate-600 hover:bg-slate-500 rounded-xl font-bold flex items-center gap-2",children:[e.jsx(d,{className:"w-5 h-5"}),J({en:"Start Game",vi:"Báº¯t Ä‘áº§u"})]}),X&&!U&&e.jsx("span",{className:"text-sm text-slate-500",children:"Need at least 2 players"})]}),"playing"===p.gamePhase&&e.jsxs("div",{className:"flex flex-col items-center gap-6 w-full",children:[e.jsxs("div",{className:"flex items-center gap-8 justify-center min-h-[120px]",children:[e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx("div",{ref:Y,className:"w-14 h-20 @md:w-16 @md:h-24 bg-slate-700 rounded-lg border-2 border-slate-600 shadow-xl flex items-center justify-center relative transition-all active:scale-95 "+("drawing"===p.turnPhase&&ee?"ring-2 ring-primary-400 cursor-pointer shadow-primary-500/20 shadow-2xl hover:border-primary-400 hover:scale-105 hover:shadow-primary-500/30":""),onClick:"drawing"===p.turnPhase&&ee?de:void 0,children:e.jsx("div",{className:"w-8 h-8 rounded-full border-2 border-slate-500/50 flex items-center justify-center",children:e.jsx(b,{className:"w-4 h-4 text-slate-400"})})}),e.jsxs("span",{className:"text-xs text-slate-400 font-bold whitespace-nowrap",children:[p.drawPile.length," ",J({en:"cards",vi:"lÃ¡"})]}),"drawing"===p.turnPhase&&ee&&e.jsxs("button",{onClick:de,className:"px-3 py-1.5 bg-slate-600 hover:bg-slate-500 rounded-lg font-bold text-xs flex items-center gap-1 transition-all hover:scale-105 active:scale-95",children:[e.jsx(b,{className:"w-3 h-3"})," ",J({en:"Draw",vi:"Bá»‘c bÃ i"})]})]}),e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsxs("div",{ref:Q,className:"relative",children:[p.lastDiscardedCard?e.jsx(A,{card:p.lastDiscardedCard,isHighlight:"drawing"===p.turnPhase&&ee,onClick:"drawing"===p.turnPhase&&ee&&u.canFormPhomPublic(_?.hand||[],p.lastDiscardedCard)?ce:void 0}):e.jsx("div",{className:"w-14 h-20 @md:w-16 @md:h-24 rounded-lg border-2 border-dashed border-slate-600 flex items-center justify-center",children:e.jsx(f,{className:"w-4 h-4 text-slate-500"})}),p.discardHistory.length>0&&e.jsx("button",{onClick:()=>E(!0),className:"absolute -top-1 -right-1 w-5 h-5 bg-slate-600 hover:bg-slate-500 rounded-full text-[10px] flex items-center justify-center z-20 cursor-pointer transition-colors",title:J({en:"View history",vi:"Xem lá»‹ch sá»­"}),children:p.discardHistory.length})]}),e.jsx("span",{className:"text-xs text-slate-500 font-medium whitespace-nowrap",children:J({en:"Last Discard",vi:"BÃ i má»›i nháº¥t"})}),p.lastDiscardedCard&&"drawing"===p.turnPhase&&ee&&e.jsxs("button",{onClick:ce,disabled:!u.canFormPhomPublic(_?.hand||[],p.lastDiscardedCard),className:"mt-0.5 px-3 py-1.5 bg-green-600 hover:bg-green-500 disabled:bg-slate-800 disabled:text-slate-600 text-white rounded-lg font-bold text-xs flex items-center gap-1 shadow-lg shadow-green-900/20 transition-all enabled:hover:scale-105 enabled:active:scale-95 enabled:hover:shadow-green-500/40 animate-in fade-in slide-in-from-top-2 duration-300",children:[e.jsx(v,{className:"w-3 h-3"})," ",J({en:"Eat",vi:"Ä‚n bÃ i"})]})]})]}),"playing"===p.gamePhase&&e.jsxs("div",{className:"text-xs @md:text-sm border-t border-slate-700 mt-2 pt-2 text-center w-full",children:[ee?e.jsx("span",{className:"text-primary-400 font-bold animate-pulse",children:"drawing"===p.turnPhase?J({en:"Your Turn: Draw or Eat",vi:"LÆ°á»£t báº¡n: Bá»‘c hoáº·c Ä‚n"}):J({en:"Your Turn: Discard",vi:"LÆ°á»£t báº¡n: ÄÃ¡nh bÃ i"})}):e.jsxs("span",{className:"text-slate-400",children:[J({en:"Turn of",vi:"LÆ°á»£t cá»§a"})," ",p.players[p.currentTurnIndex]?.username," (",p.turnPhase,")"]}),e.jsxs("div",{className:"text-[10px] text-slate-500 mt-1 uppercase tracking-widest",children:[J({en:"Round",vi:"VÃ²ng"})," ",p.roundNumber," / 4"]})]})]}),"ended"===p.gamePhase&&(()=>{const s=[...p.players].filter(e=>e.id).sort((e,s)=>(e.rank||99)-(s.rank||99));return e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(j,{className:"w-8 h-8 text-yellow-400"}),e.jsx("span",{className:"text-xl font-bold text-yellow-400",children:J({en:"Result",vi:"Káº¿t quáº£"})})]}),p.sentCards.length>0&&e.jsxs("div",{className:"space-y-1 w-full max-w-md mb-2",children:[e.jsx("span",{className:"text-[10px] text-slate-500 uppercase tracking-wider font-bold",children:J({en:"Cards Sent",vi:"BÃ i Ä‘Ã£ gá»­i"})}),p.sentCards.map((s,t)=>{const a=p.players.find(e=>e.id===s.fromId),l=p.players.find(e=>e.id===s.toId),{rank:n,suit:r}=P(s.card),i=r===k.HEART||r===k.DIAMOND?"text-red-500":"text-slate-800";return e.jsxs("div",{className:"flex items-center gap-2 text-xs bg-yellow-500/10 border border-yellow-500/20 rounded px-2 py-1",children:[e.jsx("span",{className:"text-slate-300 font-medium",children:a?.username}),e.jsx("span",{className:"text-slate-500",children:"â†’"}),e.jsx("div",{className:`w-5 h-8 bg-white rounded relative shrink-0 ${i} border border-slate-200`,children:e.jsxs("div",{className:"flex flex-col items-center leading-none mt-0.5",children:[e.jsx("span",{className:"text-[10px] font-bold",children:C[n]}),e.jsx("span",{className:"text-[10px] -mt-0.5",children:T[r]})]})}),e.jsx("span",{className:"text-slate-500",children:"â†’"}),e.jsx("span",{className:"text-green-400 font-medium",children:l?.username})]},t)})]}),e.jsx("div",{className:"flex flex-col gap-2 w-full min-w-[200px]",children:s.map((s,t)=>e.jsxs("div",{className:"flex items-center justify-between gap-4 p-2 rounded-lg bg-slate-800/50 border "+(0===t?"border-yellow-500/50 text-yellow-400":"border-slate-700 text-slate-300"),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",children:0===t?"ðŸ¥‡":1===t?"ðŸ¥ˆ":2===t?"ðŸ¥‰":"ðŸ’©"}),e.jsx("span",{className:"font-bold",children:s.username})]}),e.jsx("div",{className:"flex flex-col items-end",children:e.jsx("span",{className:"text-xs font-bold",children:s.isMom?"MÃ“M":s.score>0?`${s.score} pts`:"Ã™"})})]},s.id))})]})})()]}),e.jsxs("div",{className:"flex flex-col items-center gap-3 @md:gap-6 mt-auto",children:[he(0,!0),_&&"playing"===p.gamePhase&&_.hand.length>0&&(()=>{const s=u.getPhomsPublic(_.hand),t=new Set(s.flatMap(e=>e.cards)),a=_.hand.filter(e=>!t.has(e)),l=u.getDiscardSuggestionsPublic(_.hand)[0],n=[{border:"border-green-500",bg:"bg-green-500/10",label:"bg-green-500"},{border:"border-blue-500",bg:"bg-blue-500/10",label:"bg-blue-500"},{border:"border-purple-500",bg:"bg-purple-500/10",label:"bg-purple-500"},{border:"border-amber-500",bg:"bg-amber-500/10",label:"bg-amber-500"}];return e.jsxs("div",{ref:M,className:"w-full flex flex-wrap justify-center items-end gap-1.5 mt-3 px-1",style:{maxWidth:"100%"},children:[s.map((s,t)=>{const a=n[t%n.length];return e.jsxs("div",{className:`flex items-end pt-3 pb-1 px-1.5 rounded-lg border-2 max-w-full ${a.border} ${a.bg} relative overflow-visible`,children:[e.jsxs("div",{className:`absolute -top-2 left-1 ${a.label} text-white text-[8px] px-1 rounded font-bold z-10`,children:["P",t+1]}),s.cards.map((t,a)=>{const l=_.hand.indexOf(t),n=a===s.cards.length-1;return e.jsx("div",{className:"shrink-0",style:{width:n?void 0:32,zIndex:a},children:e.jsx(H,{card:t,selected:w===l,onClick:()=>ie(l),disabled:!ee||"drawing"===p.turnPhase,isSuggested:!1,isHighlighted:G===t})},`${t}-${l}`)})]},`phom-${t}`)}),a.length>0&&e.jsxs("div",{className:"flex items-end pt-3 pb-1 px-1.5 rounded-lg border-2 max-w-full border-red-500/40 bg-red-500/5 relative overflow-visible",children:[e.jsx("div",{className:"absolute -top-2 left-1 bg-red-500/80 text-white text-[8px] px-1 rounded font-bold z-10",children:J({en:"TRASH",vi:"RÃC"})}),a.map((s,t)=>{const n=_.hand.indexOf(s),r=t===a.length-1;return e.jsx("div",{className:"shrink-0",style:{width:r?void 0:32,zIndex:t},children:e.jsx(H,{card:s,selected:w===n,onClick:()=>ie(n),disabled:!ee||"drawing"===p.turnPhase,isSuggested:"discarding"===p.turnPhase&&ee&&s===l,isHighlighted:G===s})},`${s}-${n}`)})]})]})})(),"playing"===p.gamePhase&&ee&&"discarding"===p.turnPhase&&e.jsx("div",{className:"flex gap-4",children:e.jsxs("button",{onClick:()=>{null!==w&&_&&(u.requestDiscard(_.hand[w]),N(null))},disabled:null===w,className:"px-8 py-2.5 bg-red-600 hover:bg-red-500 text-white disabled:bg-slate-800 disabled:text-slate-500 rounded-lg font-extrabold flex items-center gap-2 transition-all enabled:hover:scale-105 active:scale-95 disabled:scale-100",children:[e.jsx(c,{className:"w-5 h-5"})," ",J({en:"Discard",vi:"ÄÃ¡nh bÃ i"})]})}),"waiting"!==p.gamePhase&&e.jsxs("button",{onClick:async()=>{await g(J({en:"Current game progress will be lost",vi:"Tiáº¿n trÃ¬nh hiá»‡n táº¡i sáº½ máº¥t"}),J({en:"New Game?",vi:"VÃ¡n má»›i?"}))&&u.requestNewGame()},className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 hover:text-white rounded-lg text-sm flex items-center gap-2 transition-colors border border-slate-600",children:[e.jsx(o,{className:"w-4 h-4"})," ",J({en:"New Game",vi:"VÃ¡n má»›i"})]})]}),X&&p.newGameRequest&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-slate-800 rounded-xl p-6 max-w-sm w-full shadow-2xl border border-slate-700",children:[e.jsx("h3",{className:"text-lg font-bold mb-4",children:J({en:"New Game Request",vi:"YÃªu cáº§u chÆ¡i láº¡i"})}),e.jsx("p",{className:"text-slate-300 mb-6",children:J({en:`${p.newGameRequest.fromName} wants to start a new game.`,vi:`${p.newGameRequest.fromName} muá»‘n chÆ¡i láº¡i vÃ¡n má»›i.`})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>u.declineNewGame(),className:"flex-1 py-2 bg-slate-700 rounded-lg",children:J({en:"Decline",vi:"Tá»« chá»‘i"})}),e.jsx("button",{onClick:()=>u.acceptNewGame(),className:"flex-1 py-2 bg-green-600 rounded-lg font-bold",children:J({en:"Accept",vi:"Cháº¥p nháº­n"})})]})]})}),$&&e.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",onClick:()=>E(!1),children:e.jsxs("div",{className:"bg-slate-800 rounded-xl p-4 @md:p-6 max-w-md w-full max-h-[80vh] shadow-xl",onClick:e=>e.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-base @md:text-lg font-bold",children:J({en:`Discard Pile (${p.discardHistory.length} cards)`,vi:`Lá»‹ch sá»­ Ä‘Ã¡nh (${p.discardHistory.length} lÃ¡ bÃ i)`})}),e.jsx("button",{onClick:()=>E(!1),className:"p-1 hover:bg-slate-700 rounded",children:e.jsx(h,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"overflow-y-auto max-h-[60vh] space-y-1",children:[...p.discardHistory].reverse().map((s,t)=>{const{rank:a,suit:l}=P(s.card),n=l===k.HEART||l===k.DIAMOND?"text-red-500":"text-slate-800";return e.jsxs("div",{className:"flex items-center gap-2 px-2 py-1.5 rounded-lg bg-slate-700/50 hover:bg-slate-700",children:[e.jsxs("div",{className:`w-8 h-12 bg-white rounded relative shrink-0 ${n} border border-slate-200 flex flex-col items-center justify-center`,children:[e.jsx("span",{className:"text-xs font-bold leading-none",children:C[a]}),e.jsx("span",{className:"text-[10px] leading-none",children:T[l]})]}),e.jsxs("div",{className:"flex flex-col min-w-0",children:[e.jsx("span",{className:"text-xs font-medium text-slate-300 truncate",children:s.playerName}),e.jsxs("span",{className:"text-[10px] text-slate-500",children:["#",p.discardHistory.length-t]})]})]},`${s.card}-${t}`)})})]})}),e.jsx("button",{onClick:()=>S(!0),className:"fixed bottom-4 right-4 p-3 bg-slate-800 hover:bg-slate-700 rounded-full text-yellow-500 transition-colors z-40 shadow-xl border border-slate-600",title:J({en:"Rules",vi:"Luáº­t chÆ¡i"}),children:e.jsx(x,{size:24})}),y&&i.createPortal(e.jsx("div",{className:"fixed inset-0 z-60 flex items-center justify-center bg-black/80 p-4",children:e.jsxs("div",{className:"bg-slate-900 border border-slate-700 rounded-xl max-w-lg w-full shadow-2xl relative",children:[e.jsxs("div",{className:"flex justify-between p-4 pr-2",children:[e.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[e.jsx(x,{className:"w-6 h-6 text-yellow-500"}),z({en:"Game Rules: Phom (TÃ¡ Láº£)",vi:"Luáº­t ChÆ¡i: Phá»m (TÃ¡ Láº£)"})]}),e.jsx("button",{onClick:()=>S(!1),className:"p-2 hover:bg-white/10 rounded-full transition-colors text-slate-400 hover:text-white",children:e.jsx(h,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-4 pt-0 space-y-4 text-slate-300 leading-relaxed max-h-[80vh] overflow-y-auto",children:[e.jsxs("section",{className:"space-y-2",children:[e.jsx("h3",{className:"text-lg font-bold text-yellow-400 border-b border-yellow-500/30 pb-1",children:J({en:"Objective",vi:"Má»¥c tiÃªu"})}),e.jsx("p",{children:J({en:"Group your cards into 'Phom' (sets) during the game. At the end, the player with the lowest trash points (cards NOT in any Phom) wins.",vi:"Xáº¿p cÃ¡c lÃ¡ bÃ i thÃ nh 'Phá»m' trong suá»‘t vÃ¡n bÃ i. Khi káº¿t thÃºc, ngÆ°á»i cÃ³ tá»•ng Ä‘iá»ƒm bÃ i RÃC (khÃ´ng náº±m trong Phá»m) tháº¥p nháº¥t sáº½ tháº¯ng."})})]}),e.jsxs("section",{className:"space-y-2",children:[e.jsx("h3",{className:"text-lg font-bold text-yellow-400 border-b border-yellow-500/30 pb-1",children:J({en:"What is a Phom?",vi:"Phá»m lÃ  gÃ¬?"})}),e.jsxs("ul",{className:"list-disc pl-5 space-y-1",children:[e.jsxs("li",{children:[e.jsxs("span",{className:"font-bold text-white",children:[J({en:"Sets of Kind",vi:"Bá»™ SÃ¡m / Tá»© quÃ½"}),":"]})," ",J({en:"3 or 4 cards of the same rank (e.g., three Jacks).",vi:"3 hoáº·c 4 lÃ¡ bÃ i cÃ¹ng giÃ¡ trá»‹ (VD: ba lÃ¡ J)."})]}),e.jsxs("li",{children:[e.jsxs("span",{className:"font-bold text-white",children:[J({en:"Sequences",vi:"Bá»™ Sáº£nh"}),":"]})," ",J({en:"3 or more cards of the same suit in sequence (e.g., 5-6-7 of Hearts).",vi:"3 lÃ¡ trá»Ÿ lÃªn cÃ¹ng cháº¥t vÃ  liÃªn tiáº¿p nhau (VD: 5-6-7 cÆ¡)."})]})]})]}),e.jsxs("section",{className:"space-y-2",children:[e.jsx("h3",{className:"text-lg font-bold text-yellow-400 border-b border-yellow-500/30 pb-1",children:J({en:"How to Play",vi:"CÃ¡ch chÆ¡i"})}),e.jsxs("ol",{className:"list-decimal pl-5 space-y-2",children:[e.jsxs("li",{children:[e.jsxs("span",{className:"font-bold text-white",children:[J({en:"Start your turn",vi:"Báº¯t Ä‘áº§u lÆ°á»£t"}),":"]})," ",J({en:"EAT the card discarded by the previous player (if it helps form a Phom), OR DRAW a new card from the deck.",vi:"Ä‚N lÃ¡ bÃ i ngÆ°á»i trÆ°á»›c vá»«a Ä‘Ã¡nh (náº¿u giÃºp táº¡o Phá»m), HOáº¶C Bá»C má»™t lÃ¡ bÃ i má»›i tá»« ná»c."})]}),e.jsxs("li",{children:[e.jsxs("span",{className:"font-bold text-white",children:[J({en:"End your turn",vi:"Káº¿t thÃºc lÆ°á»£t"}),":"]})," ",J({en:"Discard one unwanted card from your hand.",vi:"ÄÃ¡nh ra má»™t lÃ¡ bÃ i rÃ¡c tá»« trÃªn tay."})]}),e.jsxs("li",{children:[e.jsxs("span",{className:"font-bold text-white",children:[J({en:"Game End",vi:"Káº¿t thÃºc vÃ¡n"}),":"]})," ",J({en:"When the deck runs out, the game automatically detects the best Phoms for each player, sends compatible trash cards to others' Phoms, and shows the final results.",vi:"Khi ná»c háº¿t bÃ i, há»‡ thá»‘ng tá»± Ä‘á»™ng tÃ¬m Phá»m tá»‘i Æ°u cho má»—i ngÆ°á»i, gá»­i bÃ i rÃ¡c há»£p lá»‡ vÃ o Phá»m ngÆ°á»i khÃ¡c, vÃ  hiá»ƒn thá»‹ káº¿t quáº£."})]})]})]}),e.jsxs("section",{className:"space-y-2",children:[e.jsx("h3",{className:"text-lg font-bold text-yellow-400 border-b border-yellow-500/30 pb-1",children:J({en:"Scoring",vi:"TÃ­nh Ä‘iá»ƒm"})}),e.jsxs("ul",{className:"list-disc pl-5 space-y-1",children:[e.jsx("li",{children:J({en:"Each card is worth its face value (A=1, 2=2, ..., J=11, Q=12, K=13).",vi:"Má»—i lÃ¡ bÃ i tÃ­nh theo máº·t (A=1, 2=2, ..., J=11, Q=12, K=13)."})}),e.jsx("li",{children:J({en:"Your score = total value of trash cards (cards NOT in Phoms). Lower is better!",vi:"Äiá»ƒm = tá»•ng giÃ¡ trá»‹ bÃ i rÃ¡c (bÃ i KHÃ”NG náº±m trong Phá»m). CÃ ng tháº¥p cÃ ng tá»‘t!"})})]})]}),e.jsxs("section",{className:"space-y-2 bg-white/5 p-3 rounded-lg border border-white/10",children:[e.jsx("h3",{className:"text-md font-bold text-primary-400",children:J({en:"Special Terms",vi:"Thuáº­t ngá»¯ quan trá»ng"})}),e.jsxs("ul",{className:"space-y-2 text-sm",children:[e.jsxs("li",{children:[e.jsx("span",{className:"text-green-400 font-bold",children:"Ã™:"})," ",J({en:"All 9 cards form Phoms â†’ Instant win with 0 points!",vi:"Táº¥t cáº£ 9 lÃ¡ bÃ i Ä‘á»u náº±m trong Phá»m â†’ Tháº¯ng tráº¯ng vá»›i 0 Ä‘iá»ƒm!"})]}),e.jsxs("li",{children:[e.jsxs("span",{className:"text-blue-400 font-bold",children:[J({en:"TÃ¡i (Extension)",vi:"TÃ¡i (Gia háº¡n)"}),":"]})," ",J({en:"If someone eats a card in the last round, everyone gets another round to draw/discard.",vi:"Náº¿u cÃ³ ngÆ°á»i Äƒn bÃ i á»Ÿ vÃ²ng cuá»‘i, má»i ngÆ°á»i Ä‘Æ°á»£c thÃªm má»™t vÃ²ng bá»‘c/Ä‘Ã¡nh bÃ i."})]}),e.jsxs("li",{children:[e.jsxs("span",{className:"text-purple-400 font-bold",children:[J({en:"Auto Send",vi:"Tá»± Ä‘á»™ng gá»­i bÃ i"}),":"]})," ",J({en:"After Phoms are shown, trash cards that fit into other players' Phoms are automatically sent to reduce your score.",vi:"Sau khi háº¡ Phá»m, bÃ i rÃ¡c há»£p lá»‡ sáº½ Ä‘Æ°á»£c tá»± Ä‘á»™ng gá»­i vÃ o Phá»m ngÆ°á»i khÃ¡c Ä‘á»ƒ giáº£m Ä‘iá»ƒm cho báº¡n."})]}),e.jsxs("li",{children:[e.jsxs("span",{className:"text-red-400 font-bold",children:[J({en:"MÃ³m (Burned)",vi:"MÃ³m (ChÃ¡y)"}),":"]})," ",J({en:"No Phoms at the end â†’ Highest penalty, ranked last.",vi:"KhÃ´ng cÃ³ Phá»m nÃ o khi káº¿t thÃºc â†’ Pháº¡t náº·ng nháº¥t, vá» bÃ©t."})]})]})]})]})]})}),document.body),K&&ne&&e.jsx(I,{containerRef:F,sourceRect:ne.sourceRect,targetRect:ne.targetRect,isOpen:!0,duration:500,onComplete:()=>V(null),children:K.hidden?e.jsx("div",{className:"w-14 h-20 @md:w-16 @md:h-24 bg-slate-700 rounded-lg border-2 border-slate-600 shadow-xl"}):e.jsx(A,{card:K.card||0})})]})}function H({card:s,selected:t,onClick:l,disabled:n=!1,isSuggested:r=!1,isHighlighted:i=!1}){const{ts:d}=a(),{rank:c,suit:o}=P(s),h=o===k.HEART||o===k.DIAMOND?"text-red-500":"text-slate-800";return e.jsxs("button",{onClick:l,disabled:n,style:{transform:t?"translateY(-12px)":void 0},className:`\n        w-14 h-20 @md:w-16 @md:h-24\n        bg-white rounded-lg @md:rounded-xl shadow-lg\n        border-2 transition-all duration-300 font-bold shrink-0\n        group/card relative\n        ${t?"border-primary-500 ring-2 ring-primary-400 shadow-primary-500/30 shadow-xl":i?"border-yellow-400 ring-2 ring-yellow-400/70 shadow-yellow-400/40 shadow-xl animate-pulse":r?"border-red-500 ring-2 ring-red-400/50":"border-slate-200"}\n        ${!n&&l?(t?"":"hover:border-slate-400 hover:scale-105 hover:-translate-y-1")+" cursor-pointer":"cursor-default"}\n      `,children:[r&&e.jsx("div",{className:"absolute -top-2 bg-red-600/50 text-white px-1 rounded text-xs z-10 shadow-sm animate-bounce",children:e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsx("span",{children:d({en:"TRASH",vi:"BÃ€I RÃC"})}),e.jsx("span",{className:"text-xs group-hover/card:max-h-50 max-h-0 overflow-hidden transition-all duration-300",children:d({en:"Should discard",vi:"NÃªn Ä‘Ã¡nh"})})]})}),e.jsxs("div",{className:`absolute top-1 left-1.5 @md:top-1.5 @md:left-2 flex flex-col items-center leading-none ${h}`,children:[e.jsx("span",{className:"text-base @md:text-xl font-bold",children:C[c]}),e.jsx("span",{className:"text-sm @md:text-lg",children:T[o]})]})]})}function A({card:s,isHighlight:t,onClick:a}){const{rank:l,suit:n}=P(s),r=n===k.HEART||n===k.DIAMOND?"text-red-500":"text-slate-800";return e.jsx("div",{onClick:a,className:`\n        w-14 h-20 @md:w-16 @md:h-24\n        bg-white rounded-lg @md:rounded-xl shadow-lg\n        border-2 font-bold shrink-0 relative transition-all active:scale-95\n        ${t?"border-primary-500 ring-2 ring-primary-400 cursor-pointer shadow-primary-500/20 shadow-2xl hover:scale-105":"border-slate-200"}\n      `,children:e.jsxs("div",{className:`absolute top-1 left-1.5 @md:top-1.5 @md:left-2 flex flex-col items-center leading-none ${r}`,children:[e.jsx("span",{className:"text-sm @md:text-xl font-bold",children:C[l]}),e.jsx("span",{className:"text-xs @md:text-base",children:T[n]})]})})}function B({slot:s,isCurrentTurn:t,isHost:l,gamePhase:n,onAddBot:r,onJoinSlot:i,onRemove:d,compact:c=!1,canJoin:o=!1}){const{ts:x}=a(),m=null===s.id,u=l&&"waiting"===n;return e.jsx("div",{className:`\n        ${c?"p-2 min-w-[90px]":"p-2 @md:p-3 min-w-[100px] @md:min-w-[120px]"}\n        rounded-lg @md:rounded-xl transition-all border-2\n        ${t&&"playing"===n?"border-primary-600 bg-primary-500/10 animate-bounce":"border-slate-700 bg-slate-800/50"}\n        ${m?"border-dashed":""}\n      `,children:m?e.jsxs("div",{className:"flex flex-col gap-1 items-center",children:[e.jsx("span",{className:"text-slate-500 text-xs text-center font-medium",children:x({en:"Slot empty",vi:"CÃ²n trá»‘ng"})}),e.jsxs("div",{className:"flex gap-1 w-full",children:[u&&e.jsxs("button",{onClick:r,className:"flex-1 p-1 bg-slate-700 hover:bg-slate-600 rounded text-[10px] flex items-center justify-center gap-1",title:x({en:"Add Bot",vi:"ThÃªm Bot"}),children:[e.jsx(w,{className:"w-3 h-3"})," ",x({en:"Bot",vi:"Bot"})]}),o&&e.jsxs("button",{onClick:i,className:"flex-1 p-1 bg-primary-700 hover:bg-primary-600 rounded text-[10px] flex items-center justify-center gap-1 font-bold",title:x({en:"Join",vi:"Tham gia"}),children:[e.jsx(N,{className:"w-3 h-3"})," ",x({en:"Join",vi:"Tham gia"})]})]})]}):e.jsxs("div",{className:"flex flex-col items-center gap-0.5 relative",children:[e.jsxs("div",{className:"flex items-center gap-1 w-full justify-center",children:[s.isBot?e.jsx(w,{className:"w-4 h-4 text-blue-400"}):s.isHost?e.jsx(y,{className:"w-4 h-4 text-yellow-400"}):e.jsx(N,{className:"w-4 h-4 text-green-400"}),e.jsx("span",{className:"text-xs font-bold truncate max-w-[60px] @md:max-w-[80px]",children:s.username}),l&&!s.isHost&&"waiting"===n&&e.jsx("button",{onClick:d,className:"p-0.5 hover:bg-slate-700 rounded",title:"Remove",children:e.jsx(h,{className:"w-4 h-4 text-red-400"})})]}),"ended"===n&&s.phoms.length>0&&e.jsx("div",{className:"flex flex-col gap-1 mt-1 w-full",children:s.phoms.map((s,t)=>{const a=["border-green-500/60 bg-green-500/10","border-blue-500/60 bg-blue-500/10","border-purple-500/60 bg-purple-500/10","border-amber-500/60 bg-amber-500/10"],l=a[t%a.length];return e.jsx("div",{className:`flex flex-wrap justify-center gap-0.5 p-1 rounded border-2 ${l}`,children:s.cards.map((s,t)=>{const{rank:a,suit:l}=P(s),n=l===k.HEART||l===k.DIAMOND?"text-red-500":"text-slate-800";return e.jsx("div",{className:`w-5 h-8 @md:w-6 @md:h-9 bg-white rounded relative shrink-0 ${n} border border-slate-200`,children:e.jsxs("div",{className:"flex flex-col items-center leading-none mt-0.5",children:[e.jsx("span",{className:"text-[10px] @md:text-xs font-bold",children:C[a]}),e.jsx("span",{className:"text-[10px] @md:text-xs -mt-0.5",children:T[l]})]})},t)})},t)})}),"ended"===n&&s.hand.length>0?e.jsx("div",{className:"flex flex-wrap justify-center gap-0.5 max-w-[140px] @md:max-w-[200px] mt-1",children:s.hand.map((s,t)=>{const{rank:a,suit:l}=P(s),n=l===k.HEART||l===k.DIAMOND?"text-red-500":"text-slate-800";return e.jsx("div",{className:`\n                      w-6 h-10 @md:w-7 @md:h-11\n                      bg-white rounded\n                      relative shrink-0\n                      ${n}\n                      border border-slate-200\n                    `,children:e.jsxs("div",{className:"flex flex-col items-center leading-none mt-0.5",children:[e.jsx("span",{className:"text-xs @md:text-xs font-bold",children:C[a]}),e.jsx("span",{className:"text-xs @md:text-xs -mt-0.5",children:T[l]})]})},t)})}):("playing"===n||"ended"===n)&&e.jsxs("div",{className:"flex flex-col items-center gap-0.5 mt-1",children:[e.jsxs("span",{className:"text-[10px] text-slate-400 font-medium",children:[s.hand.length," ",x({en:"cards",vi:"lÃ¡"})]}),s.eatenCards.length>0&&e.jsx("div",{className:"flex gap-0.5 flex-wrap justify-center",children:s.eatenCards.map((s,t)=>e.jsx("div",{className:"w-1.5 h-2.5 bg-green-500 rounded-sm shadow-sm",title:x({en:"Eaten",vi:"Bá»‹ Äƒn"})},t))})]})]})})}export{T as SUIT_SYMBOLS,S as default};
