import{j as e}from"./index-BrrJSH2n.js";import{j as s,z as n,X as t,M as a,Z as l,Q as r,m as i}from"./react-vendor-BZRLljed.js";import"./socket-DRbsQkF5.js";import{C as o,R as d}from"./types-zc5glPn-.js";import"./zustand-B3oBTGP0.js";function c({game:c,currentUserId:m}){const u=c,[x,g]=s.useState(u.getState()),[p,h]=s.useState(null);s.useEffect(()=>{u.onUpdate(g),g(u.getState()),u.requestSync()},[u]);const f=u.getMyPlayerIndex(),j=f>=0?x.players[f].color:null,b=x.players[x.currentPlayerIndex],y=b?.id===m,w=u.isHostUser,N=e=>{"playing"===x.gamePhase&&y&&(u.isColumnFull(e)||u.requestMove(e))},v=(s,n)=>{const t=x.board[s][n],a=((e,s)=>x.winningCells?.some(n=>n.row===e&&n.col===s))(s,n),l=((e,s)=>x.lastMove?.row===e&&x.lastMove?.col===s)(s,n);return e.jsx("div",{className:"aspect-square flex items-center justify-center bg-blue-700 p-1",children:e.jsx("div",{className:`\n            w-full h-full rounded-full transition-all duration-200\n            ${t?"":"bg-blue-900"}\n            ${"red"===t?"bg-red-500":""}\n            ${"yellow"===t?"bg-yellow-400":""}\n            ${a?"ring-4 ring-white animate-pulse":""}\n            ${l&&!a?"ring-2 ring-white/50":""}\n          `,style:l&&t?{animation:"drop 0.5s ease-out"}:void 0})},`${s}-${n}`)};return e.jsxs("div",{className:"flex flex-col items-center gap-4 p-4 w-full max-w-lg mx-auto",children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:"\n@keyframes drop {\n  0% { transform: translateY(-400px); }\n  60% { transform: translateY(10px); }\n  80% { transform: translateY(-5px); }\n  100% { transform: translateY(0); }\n}\n"}}),e.jsxs("div",{className:"flex flex-col gap-2 p-4 bg-slate-800 rounded-lg w-full",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-400 mb-1",children:"Players"}),x.players.map((s,n)=>e.jsxs("div",{className:`\n              flex items-center justify-between p-2 rounded-lg\n              ${x.currentPlayerIndex===n&&"playing"===x.gamePhase?"bg-slate-600 ring-2 ring-blue-400":"bg-slate-700"}\n            `,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`\n                  w-6 h-6 rounded-full\n                  ${"red"===s.color?"bg-red-500":"bg-yellow-400"}\n                `}),e.jsxs("span",{className:"text-white",children:[s.id?s.username:"(waiting...)",s.isBot&&" ðŸ¤–",s.id===m&&" (You)"]})]}),s.isBot&&w&&"waiting"===x.gamePhase&&e.jsx("button",{onClick:()=>u.requestRemoveBot(),className:"text-xs px-2 py-1 bg-red-600 hover:bg-red-500 text-white rounded transition-colors",children:"Remove"})]},n))]}),"playing"===x.gamePhase&&e.jsx("div",{className:"text-lg text-gray-400",children:y?e.jsx("span",{className:"text-green-400",children:"Your turn! Click a column."}):e.jsxs("span",{children:["Waiting for ",b?.username,"..."]})}),x.undoRequest&&x.undoRequest.fromId!==m&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-slate-800 rounded-xl p-6 shadow-xl max-w-sm mx-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Undo Request"}),e.jsxs("p",{className:"text-gray-400 mb-4",children:[x.undoRequest.fromName," wants to undo their last move."]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>u.acceptUndo(),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-500 text-white rounded-lg transition-colors",children:[e.jsx(n,{className:"w-4 h-4"})," Accept"]}),e.jsxs("button",{onClick:()=>u.declineUndo(),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-red-600 hover:bg-red-500 text-white rounded-lg transition-colors",children:[e.jsx(t,{className:"w-4 h-4"})," Decline"]})]})]})}),x.undoRequest&&x.undoRequest.fromId===m&&e.jsx("div",{className:"text-yellow-400 text-sm",children:"Waiting for opponent to accept undo..."}),"ended"===x.gamePhase&&e.jsxs("div",{className:"text-center p-4 bg-slate-800 rounded-lg",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Game Over!"}),e.jsx("p",{className:"text-gray-300",children:"draw"===x.winner?"It's a draw!":x.winner===m?"ðŸŽ‰ You won!":`${x.players.find(e=>e.id===x.winner)?.username} wins!`})]}),e.jsxs("div",{className:"flex gap-3 flex-wrap justify-center",children:["waiting"===x.gamePhase&&e.jsxs(e.Fragment,{children:[w&&!x.players[1].id&&e.jsxs("button",{onClick:()=>u.requestAddBot(),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white rounded-lg transition-colors",children:[e.jsx(a,{className:"w-4 h-4"})," Add Bot"]}),w&&u.canStartGame()&&e.jsxs("button",{onClick:()=>u.requestStartGame(),className:"flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-500 text-white rounded-lg transition-colors",children:[e.jsx(l,{className:"w-4 h-4"})," Start Game"]})]}),"playing"===x.gamePhase&&e.jsx(e.Fragment,{children:f>=0&&x.moveHistory.length>0&&!x.undoRequest&&e.jsxs("button",{onClick:()=>u.requestUndo(),className:"flex items-center gap-2 px-4 py-2 bg-slate-600 hover:bg-slate-500 text-white rounded-lg transition-colors",children:[e.jsx(r,{className:"w-4 h-4"})," Undo"]})}),"ended"===x.gamePhase&&e.jsxs("button",{onClick:()=>u.requestNewGame(),className:"flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-500 text-white rounded-lg transition-colors",children:[e.jsx(i,{className:"w-4 h-4"})," Play Again"]})]}),e.jsxs("div",{className:"w-full max-w-[400px]",children:["playing"===x.gamePhase&&e.jsx("div",{className:"grid grid-cols-7 gap-1 mb-1",children:Array(o).fill(null).map((s,n)=>{const t="playing"===x.gamePhase&&y&&!u.isColumnFull(n),a=p===n&&t;return e.jsx("div",{className:`\n                  aspect-square flex items-center justify-center\n                  rounded-full transition-all duration-200\n                  ${t?"cursor-pointer":"cursor-default"}\n                `,onMouseEnter:()=>h(n),onMouseLeave:()=>h(null),onClick:()=>N(n),children:a&&e.jsx("div",{className:`\n                      w-[80%] h-[80%] rounded-full opacity-60\n                      ${"red"===j?"bg-red-500":"bg-yellow-400"}\n                    `})},n)})}),e.jsx("div",{className:"grid gap-1 p-2 bg-blue-800 rounded-lg shadow-xl",style:{gridTemplateColumns:`repeat(${o}, 1fr)`},onMouseLeave:()=>h(null),children:Array(d).fill(null).map((s,n)=>Array(o).fill(null).map((s,t)=>e.jsx("div",{className:"cursor-pointer",onMouseEnter:()=>h(t),onClick:()=>N(t),children:v(n,t)},`${n}-${t}`)))})]})]})}export{c as default};
