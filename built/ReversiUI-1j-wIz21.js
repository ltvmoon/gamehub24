import{j as e}from"./index-CeSpnX2h.js";import{l as s,z as t,X as a,a2 as l,a3 as n,a5 as r,o}from"./react-vendor-C7uwXrww.js";import"./socket-DRbsQkF5.js";import"./zustand-D2o_pnFT.js";function i({game:i,currentUserId:d}){const c=i,[m,x]=s.useState(c.getState());s.useEffect(()=>{c.onUpdate(x),x(c.getState()),c.requestSync()},[c]);const g=c.getMyPlayerIndex(),h=g>=0?m.players[g].color:null,u=m.players[m.currentPlayerIndex],p=u?.id===d,b="playing"===m.gamePhase&&p?c.getValidMoves(h):[],f=c.getPieceCount(),w=c.isHostUser,j=(e,s)=>b.some(([t,a])=>t===e&&a===s),y=(s,t,a)=>{const l=j(t,a),n=m.lastMove?.row===t&&m.lastMove?.col===a,r=m.flippedCells?.some(e=>e.row===t&&e.col===a);return e.jsxs("button",{onClick:()=>((e,s)=>{"playing"===m.gamePhase&&p&&j(e,s)&&c.requestMove(e,s)})(t,a),className:`\n          aspect-square flex items-center justify-center\n          bg-green-700 border border-green-800\n          ${l?"cursor-pointer hover:bg-green-600":"cursor-default"}\n          ${n?"ring-2 ring-yellow-400 ring-inset":""}\n        `,disabled:!l,children:[s&&e.jsx("div",{className:`\n              w-[80%] h-[80%] rounded-full shadow-lg\n              ${"black"===s?"bg-gray-900":"bg-white"}\n              ${n?"scale-110":""}\n              ${r?"animate-flip":""}\n            `,style:r?{animation:"flip 0.4s ease-in-out"}:void 0}),!s&&l&&e.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500/50"})]},`${t}-${a}`)};return e.jsxs("div",{className:"flex flex-col items-center gap-4 p-4 w-full max-w-2xl mx-auto",children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:"\n@keyframes flip {\n  0% { transform: rotateY(0deg) scale(1); }\n  50% { transform: rotateY(90deg) scale(1.1); }\n  100% { transform: rotateY(180deg) scale(1); }\n}\n"}}),e.jsxs("div",{className:"flex flex-col gap-2 p-4 bg-slate-800 rounded-lg w-full max-w-md",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-400 mb-1",children:"Players"}),m.players.map((s,t)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-slate-700 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-6 h-6 rounded-full ${"black"===s.color?"bg-gray-900":"bg-white"} ${"black"===s.color?"text-white":"text-black"}`,children:"black"===s.color?f.black:f.white}),e.jsxs("span",{className:"text-white",children:[s.id?s.username:"(waiting...)",s.isBot&&" ðŸ¤–"]})]}),s.isBot&&w&&e.jsx("button",{onClick:()=>c.requestRemoveBot(),className:"text-xs px-2 py-1 bg-red-600 hover:bg-red-500 text-white rounded transition-colors",children:"Remove"})]},t))]}),"playing"===m.gamePhase&&e.jsxs("div",{className:"text-lg text-gray-400",children:[p?e.jsx("span",{className:"text-green-400",children:"Your turn!"}):e.jsxs("span",{children:["Waiting for ",u?.username,"..."]}),0===b.length&&p&&e.jsx("span",{className:"ml-2 text-yellow-400",children:"(No valid moves - must pass)"})]}),m.undoRequest&&m.undoRequest.fromId!==d&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-slate-800 rounded-xl p-6 shadow-xl max-w-sm mx-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Undo Request"}),e.jsxs("p",{className:"text-gray-400 mb-4",children:[m.undoRequest.fromName," wants to undo their last move."]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>c.acceptUndo(),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-500 text-white rounded-lg transition-colors",children:[e.jsx(t,{className:"w-4 h-4"})," Accept"]}),e.jsxs("button",{onClick:()=>c.declineUndo(),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-red-600 hover:bg-red-500 text-white rounded-lg transition-colors",children:[e.jsx(a,{className:"w-4 h-4"})," Decline"]})]})]})}),m.undoRequest&&m.undoRequest.fromId===d&&e.jsx("div",{className:"text-yellow-400 text-sm",children:"Waiting for opponent to accept undo..."}),"ended"===m.gamePhase&&e.jsxs("div",{className:"text-center p-4 bg-slate-800 rounded-lg",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Game Over!"}),e.jsx("p",{className:"text-gray-300 mb-4",children:"draw"===m.winner?"It's a draw!":m.winner===d?"ðŸŽ‰ You won!":`${m.players.find(e=>e.id===m.winner)?.username} wins!`}),e.jsxs("p",{className:"text-gray-400",children:["Black: ",f.black," | White: ",f.white]})]}),e.jsxs("div",{className:"flex gap-3",children:["waiting"===m.gamePhase&&e.jsxs(e.Fragment,{children:[w&&!m.players[1].id&&e.jsxs("button",{onClick:()=>c.requestAddBot(),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white rounded-lg transition-colors",children:[e.jsx(l,{className:"w-4 h-4"})," Add Bot"]}),w&&c.canStartGame()&&e.jsxs("button",{onClick:()=>c.requestStartGame(),className:"flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-500 text-white rounded-lg transition-colors",children:[e.jsx(n,{className:"w-4 h-4"})," Start Game"]})]}),"playing"===m.gamePhase&&e.jsxs(e.Fragment,{children:[p&&0===b.length&&e.jsx("button",{onClick:()=>c.requestPass(),className:"px-4 py-2 bg-yellow-600 hover:bg-yellow-500 text-white rounded-lg transition-colors",children:"Pass Turn"}),g>=0&&m.moveHistory.length>0&&!m.undoRequest&&e.jsxs("button",{onClick:()=>c.requestUndo(),className:"flex items-center gap-2 px-4 py-2 bg-slate-600 hover:bg-slate-500 text-white rounded-lg transition-colors",children:[e.jsx(r,{className:"w-4 h-4"})," Undo"]})]}),"ended"===m.gamePhase&&e.jsxs("button",{onClick:()=>c.requestNewGame(),className:"flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-500 text-white rounded-lg transition-colors",children:[e.jsx(o,{className:"w-4 h-4"})," Play Again"]})]}),e.jsx("div",{className:"grid grid-cols-8 gap-0 rounded-lg overflow-hidden shadow-xl border-4 border-green-900 w-full max-w-[500px]",children:m.board.map((e,s)=>e.map((e,t)=>y(e,s,t)))})]})}export{i as default};
