const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["built/TicTacToeUI-YqqKmDEo.js","built/index-CknsrN0a.js","built/react-vendor-8v1eX67m.js","built/socket-DRbsQkF5.js","built/zustand-BrUGvFZl.js","built/index-B8AuIEpP.css","built/registry-DE2lkhG8.js","built/chess-DTd62Tay.js","built/CaroUI-D1Div_7u.js","built/ChessUI-jyIO9Yzb.js","built/chessground-CpDKPGt0.js","built/ChessUI-D1wC9UDJ.css","built/YouTubeWatchUI-CZoUSsT-.js","built/CanvasGameUI--OLX7sfK.js"])))=>i.map(i=>d[i]);
import{u as e,g as s,j as t,l as a,_ as r}from"./index-CknsrN0a.js";import{b as n,S as o,e as l,u as i,A as c,C as d}from"./react-vendor-8v1eX67m.js";import{u as m,T as x,C as u,a as f,Y as p,b as g,c as h}from"./registry-DE2lkhG8.js";import{c as j}from"./zustand-BrUGvFZl.js";const y=j(e=>({messages:[],addMessage:s=>e(e=>({messages:[...e.messages,s]})),clearMessages:()=>e({messages:[]}),setMessages:s=>e({messages:s})}));function b(){const[a,r]=n.useState(""),l=n.useRef(null),{messages:i,addMessage:c}=y(),{currentRoom:d}=m(),{userId:x,username:u}=e(),f=s();n.useEffect(()=>(f.on("chat:message",e=>{c(e)}),d&&f.emit("chat:history",{roomId:d.id},e=>{e.forEach(e=>c(e))}),()=>{f.off("chat:message")}),[f,c,d]),n.useEffect(()=>{l.current?.scrollIntoView({behavior:"smooth"})},[i]);const p=()=>{if(!a.trim()||!d)return;const e={roomId:d.id,userId:x,username:u,message:a.trim(),type:"user"};f.emit("chat:message",e),r("")};return t.jsxs("div",{className:"glass-card rounded-2xl flex flex-col h-[600px]",children:[t.jsxs("div",{className:"p-4 border-b border-white/10",children:[t.jsxs("h3",{className:"text-sm font-semibold text-text-secondary mb-3",children:["PLAYERS (",d?.players.length||0,"/",d?.maxPlayers||0,")"]}),t.jsx("div",{className:"space-y-2",children:d?.players.map(e=>t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-2 h-2 rounded-full bg-neon-green"}),t.jsxs("span",{className:"text-sm text-text-primary",children:[e.username,e.isHost&&" ðŸ‘‘"]})]},e.id))})]}),t.jsxs("div",{className:"flex-1 p-4 overflow-y-auto space-y-3",children:[i.map(e=>"system"===e.type?t.jsx(N,{message:e},e.id):t.jsx(v,{message:e,isHost:e.userId===d?.ownerId},e.id)),t.jsx("div",{ref:l})]}),t.jsx("div",{className:"p-4 border-t border-white/10",children:t.jsxs("div",{className:"flex gap-2",children:[t.jsx("input",{type:"text",value:a,onChange:e=>r(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),p())},placeholder:"Type a message...",className:"flex-1 px-4 py-2 bg-white/5 border border-white/10 rounded-lg text-text-primary placeholder-text-muted focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"}),t.jsx("button",{onClick:p,disabled:!a.trim(),className:"p-2 bg-primary hover:bg-primary-light disabled:bg-primary/30 disabled:cursor-not-allowed text-white rounded-lg transition-colors cursor-pointer","aria-label":"Send message",children:t.jsx(o,{className:"w-5 h-5"})})]})})]})}function v({message:e,isHost:s}){const a=new Date(e.timestamp).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"});return t.jsxs("div",{className:"flex gap-3",children:[t.jsx("div",{className:"w-8 h-8 rounded-full bg-primary/20 flex items-center justify-center flex-shrink-0",children:t.jsx("span",{className:"text-xs font-bold text-primary",children:e.username[0].toUpperCase()})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-baseline gap-2 mb-1",children:[t.jsxs("span",{className:"font-semibold text-text-primary text-sm truncate",children:[e.username,s?" ðŸ‘‘":""]}),t.jsx("span",{className:"text-xs text-text-muted flex-shrink-0",children:a})]}),t.jsx("p",{className:"text-text-secondary text-sm break-words text-left",children:e.message})]})]})}function N({message:e}){return t.jsx("div",{className:"flex items-center justify-center my-2",children:t.jsx("div",{className:"px-4 py-1.5 bg-white/5 border border-white/10 rounded-full text-xs text-text-muted",children:e.message})})}const I=j(e=>({gameInstance:null,gameState:null,isHost:!1,setGameInstance:s=>e({gameInstance:s}),updateGameState:s=>e({gameState:s}),setIsHost:s=>e({isHost:s})})),w=a(()=>r(()=>import("./TicTacToeUI-YqqKmDEo.js"),__vite__mapDeps([0,1,2,3,4,5,6,7])),{fallback:t.jsx("div",{children:"Loading TicTacToe..."})}),_=a(()=>r(()=>import("./CaroUI-D1Div_7u.js"),__vite__mapDeps([8,1,2,3,4,5])),{fallback:t.jsx("div",{children:"Loading Caro..."})}),T=a(()=>r(()=>import("./ChessUI-jyIO9Yzb.js"),__vite__mapDeps([9,1,2,3,4,5,7,10,11])),{fallback:t.jsx("div",{children:"Loading Chess..."})}),k=a(()=>r(()=>import("./YouTubeWatchUI-CZoUSsT-.js"),__vite__mapDeps([12,1,2,3,4,5])),{fallback:t.jsx("div",{children:"Loading YouTube..."})}),E=a(()=>r(()=>import("./CanvasGameUI--OLX7sfK.js"),__vite__mapDeps([13,1,2,3,4,5])),{fallback:t.jsx("div",{children:"Loading Canvas..."})});function S(){const{currentRoom:a}=m(),{userId:r}=e(),{gameInstance:o,setGameInstance:l,setIsHost:i}=I(),c=s(),[d,j]=n.useState(null);return n.useEffect(()=>{if(!a)return;if(o&&o.roomId===a.id){const e=a.ownerId===r;i(e),o.updatePlayers(a.players)}else(()=>{o&&o.destroy();const e=a.gameType,s=h(e);if(!s)return j(`Game "${e}" not found`),void l(null);j(null);const t=a.ownerId===r;i(t);const n=s.createGame(a.id,c,t,r,a.players);l(n)})()},[a?.id,a?.gameType,a?.players,r,c,l,i]),n.useEffect(()=>()=>{I.getState().gameInstance?.destroy(),I.getState().setGameInstance(null)},[]),a?d?t.jsx("div",{className:"flex items-center justify-center h-full",children:t.jsx("p",{className:"text-text-secondary",children:d})}):o?o instanceof x?t.jsx(w,{game:o}):o instanceof u?t.jsx(_,{game:o}):o instanceof f?t.jsx(T,{game:o}):o instanceof p?t.jsx(k,{game:o}):o instanceof g?t.jsx(E,{game:o,currentUserId:r}):t.jsx("div",{className:"flex items-center justify-center h-full",children:t.jsx("p",{className:"text-text-muted",children:"Unknown game type"})}):t.jsx("div",{className:"flex items-center justify-center h-full",children:t.jsx("p",{className:"text-text-muted",children:"Loading game..."})}):t.jsx("div",{className:"flex items-center justify-center h-full",children:t.jsx("p",{className:"text-text-muted",children:"No room selected"})})}const L=Object.freeze(Object.defineProperty({__proto__:null,default:function(){const{roomId:a}=l(),r=i(),{currentRoom:o,setCurrentRoom:x,updatePlayers:u}=m(),{clearMessages:f}=y(),{userId:p}=e(),g=s();if(n.useEffect(()=>{if(!a)return void r("/");if(o?.id===a)return void console.log("Already have room data, skipping join");let e=!1,s=null;const t=()=>{e||(e=!0,console.log("Attempting to join room:",a,"socket.id:",g.id),s=setTimeout(()=>{console.log("Join timeout - callback never received"),e=!1},5e3),g.emit("room:join",{roomId:a},t=>{console.log("room:join response:",t),s&&clearTimeout(s),t.success&&t.room?x(t.room):(e=!1,alert(t.error||"Failed to join room"),r("/"))}))},n=()=>{console.log("Socket connected, will attempt join"),setTimeout(t,100)};return g.connected?t():(console.log("Socket not connected, waiting..."),g.on("connect",n)),()=>{g.off("connect",n),s&&clearTimeout(s)}},[a,g,r,x]),n.useEffect(()=>{if(a)return g.on("room:players",e=>{u(e)}),g.on("room:update",e=>{x(e)}),g.on("room:deleted",e=>{alert(e.reason||"Room deleted by host"),x(null),f(),r("/")}),()=>{g.off("room:players"),g.off("room:update"),g.off("room:deleted")}},[a,g,u,x,r,f]),!o)return t.jsx("div",{className:"min-h-screen bg-background-primary flex items-center justify-center",children:t.jsx("div",{className:"text-center",children:t.jsx("p",{className:"text-text-secondary",children:"Loading room..."})})});const h=o.ownerId===p;return t.jsxs("div",{className:"min-h-screen bg-background-primary",children:[t.jsx("header",{className:"md:sticky md:top-0 z-40 glass-card border-b border-white/10",children:t.jsx("div",{className:"max-w-7xl mx-auto px-2 md:px-4 py-2 md:py-4",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("button",{onClick:()=>{g.emit("room:leave",{roomId:a}),x(null),f(),r("/")},className:"p-2 hover:bg-white/10 rounded-lg transition-colors cursor-pointer","aria-label":"Leave room",children:t.jsx(c,{className:"w-5 h-5 text-text-secondary"})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-xl font-display text-text-primary",children:o.name}),t.jsx("p",{className:"text-sm text-text-muted capitalize",children:o.gameType})]})]}),t.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[t.jsx(d,{className:"w-4 h-4"}),t.jsxs("span",{children:["Host:"," ",o.players.find(e=>e.id===o.ownerId)?.username," ",h?"(You)":""]})]})]})})}),t.jsx("main",{className:"max-w-7xl mx-auto px-2 md:px-4 py-6",children:t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-[1fr_400px] gap-6",children:[t.jsx("div",{className:"glass-card rounded-2xl p-2 md:p-4",children:t.jsx(S,{})}),t.jsx(b,{})]})})]})}},Symbol.toStringTag,{value:"Module"}));export{L as R,y as u};
