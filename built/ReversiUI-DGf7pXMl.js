import{j as e}from"./index-DvVjFfh0.js";import{i as s,y as t,X as a,J as l,Y as n,M as r,l as o}from"./react-vendor-DdoU0YZ6.js";import"./socket-DRbsQkF5.js";import"./zustand-BHVQ_asN.js";import"./chess-DTd62Tay.js";function i({game:i,currentUserId:c}){const[d,m]=s.useState(i.getState());s.useEffect(()=>{i.onUpdate(m),m(i.getState()),i.requestSync()},[i]);const x=i.getMyPlayerIndex(),g=x>=0?d.players[x].color:null,h=d.players[d.currentPlayerIndex],u=h?.id===c,p="playing"===d.gamePhase&&u?i.getValidMoves(g):[],b=i.getPieceCount(),f=i.isHostUser,w=(e,s)=>p.some(([t,a])=>t===e&&a===s),j=(s,t,a)=>{const l=w(t,a),n=d.lastMove?.row===t&&d.lastMove?.col===a,r=d.flippedCells?.some(e=>e.row===t&&e.col===a);return e.jsxs("button",{onClick:()=>((e,s)=>{"playing"===d.gamePhase&&u&&w(e,s)&&i.requestMove(e,s)})(t,a),className:`\n          aspect-square flex items-center justify-center\n          bg-green-700 border border-green-800\n          ${l?"cursor-pointer hover:bg-green-600":"cursor-default"}\n          ${n?"ring-2 ring-yellow-400 ring-inset":""}\n        `,disabled:!l,children:[s&&e.jsx("div",{className:`\n              w-[80%] h-[80%] rounded-full shadow-lg\n              ${"black"===s?"bg-gray-900":"bg-white"}\n              ${n?"scale-110":""}\n              ${r?"animate-flip":""}\n            `,style:r?{animation:"flip 0.4s ease-in-out"}:void 0}),!s&&l&&e.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500/50"})]},`${t}-${a}`)};return e.jsxs("div",{className:"flex flex-col items-center gap-4 p-4 w-full max-w-2xl mx-auto",children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:"\n@keyframes flip {\n  0% { transform: rotateY(0deg) scale(1); }\n  50% { transform: rotateY(90deg) scale(1.1); }\n  100% { transform: rotateY(180deg) scale(1); }\n}\n"}}),e.jsxs("div",{className:"flex flex-col gap-2 p-4 bg-slate-800 rounded-lg w-full max-w-md",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-400 mb-1",children:"Players"}),d.players.map((s,t)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-slate-700 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-6 h-6 rounded-full ${"black"===s.color?"bg-gray-900":"bg-white"} ${"black"===s.color?"text-white":"text-black"}`,children:"black"===s.color?b.black:b.white}),e.jsxs("span",{className:"text-white",children:[s.id?s.username:"(waiting...)",s.isBot&&" ðŸ¤–"]})]}),s.isBot&&f&&e.jsx("button",{onClick:()=>i.requestRemoveBot(),className:"text-xs px-2 py-1 bg-red-600 hover:bg-red-500 text-white rounded transition-colors",children:"Remove"})]},t))]}),"playing"===d.gamePhase&&e.jsxs("div",{className:"text-lg text-gray-400",children:[u?e.jsx("span",{className:"text-green-400",children:"Your turn!"}):e.jsxs("span",{children:["Waiting for ",h?.username,"..."]}),0===p.length&&u&&e.jsx("span",{className:"ml-2 text-yellow-400",children:"(No valid moves - must pass)"})]}),d.undoRequest&&d.undoRequest.fromId!==c&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-slate-800 rounded-xl p-6 shadow-xl max-w-sm mx-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Undo Request"}),e.jsxs("p",{className:"text-gray-400 mb-4",children:[d.undoRequest.fromName," wants to undo their last move."]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>i.acceptUndo(),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-500 text-white rounded-lg transition-colors",children:[e.jsx(t,{className:"w-4 h-4"})," Accept"]}),e.jsxs("button",{onClick:()=>i.declineUndo(),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-red-600 hover:bg-red-500 text-white rounded-lg transition-colors",children:[e.jsx(a,{className:"w-4 h-4"})," Decline"]})]})]})}),d.undoRequest&&d.undoRequest.fromId===c&&e.jsx("div",{className:"text-yellow-400 text-sm",children:"Waiting for opponent to accept undo..."}),"ended"===d.gamePhase&&e.jsxs("div",{className:"text-center p-4 bg-slate-800 rounded-lg",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Game Over!"}),e.jsx("p",{className:"text-gray-300 mb-4",children:"draw"===d.winner?"It's a draw!":d.winner===c?"ðŸŽ‰ You won!":`${d.players.find(e=>e.id===d.winner)?.username} wins!`}),e.jsxs("p",{className:"text-gray-400",children:["Black: ",b.black," | White: ",b.white]})]}),e.jsxs("div",{className:"flex gap-3",children:["waiting"===d.gamePhase&&e.jsxs(e.Fragment,{children:[f&&!d.players[1].id&&e.jsxs("button",{onClick:()=>i.requestAddBot(),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white rounded-lg transition-colors",children:[e.jsx(l,{className:"w-4 h-4"})," Add Bot"]}),f&&i.canStartGame()&&e.jsxs("button",{onClick:()=>i.requestStartGame(),className:"flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-500 text-white rounded-lg transition-colors",children:[e.jsx(n,{className:"w-4 h-4"})," Start Game"]})]}),"playing"===d.gamePhase&&e.jsxs(e.Fragment,{children:[u&&0===p.length&&e.jsx("button",{onClick:()=>i.requestPass(),className:"px-4 py-2 bg-yellow-600 hover:bg-yellow-500 text-white rounded-lg transition-colors",children:"Pass Turn"}),x>=0&&d.moveHistory.length>0&&!d.undoRequest&&e.jsxs("button",{onClick:()=>i.requestUndo(),className:"flex items-center gap-2 px-4 py-2 bg-slate-600 hover:bg-slate-500 text-white rounded-lg transition-colors",children:[e.jsx(r,{className:"w-4 h-4"})," Undo"]})]}),"ended"===d.gamePhase&&e.jsxs("button",{onClick:()=>i.requestNewGame(),className:"flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-500 text-white rounded-lg transition-colors",children:[e.jsx(o,{className:"w-4 h-4"})," Play Again"]})]}),e.jsx("div",{className:"grid grid-cols-8 gap-0 rounded-lg overflow-hidden shadow-xl border-4 border-green-900 w-full max-w-[500px]",children:d.board.map((e,s)=>e.map((e,t)=>j(e,s,t)))})]})}export{i as default};
