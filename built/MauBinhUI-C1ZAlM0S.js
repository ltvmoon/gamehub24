import{u as e,b as s,S as a,j as t,m as l,f as n}from"./index-DeW22Zn2.js";import{b as r,c as i,aP as d,br as o,aO as c,i as x,ak as m,T as h,a9 as p,aJ as u,X as g,bz as b,U as f,aF as j,ax as v,ay as N,aA as y,b3 as w}from"./react-vendor-BeKtp5AY.js";import"./BaseGame-DNUNIW8N.js";import{I as k,G as R,a as C,b as S,H as A,c as T,d as P,S as I,e as B}from"./types-C-uNVF7e.js";import{b as M,c as F,d as H,S as _}from"./types-qIwhz3td.js";import{u as O}from"./useGameState-BSMNmzbB.js";import"./socket-DRbsQkF5.js";import"./zustand-C88HNARu.js";const E={BACK:"back",MIDDLE:"middle",FRONT:"front"};function D({game:n}){const f=n,[j]=O(f),{ti:v,ts:N}=e(),{confirm:y}=s(),[w,M]=r.useState(!1),[F,H]=r.useState(null),[_,D]=r.useState(E.BACK),[K,V]=r.useState(!1),[Y,J]=r.useState([]),[Q,Z]=r.useState([]),[ee,se]=r.useState([]),ae=f.getMyPlayerIndex(),te=ae>=0?j.players[ae]:null,le=f.isHost,ne=r.useMemo(()=>{if(!te)return[];const e=new Set([...Y,...Q,...ee]);return te.hand.filter(s=>!e.has(s))},[te,Y,Q,ee]),re=r.useMemo(()=>te&&13===te.hand.length?f.checkInstantWinRaw(te.hand):k.NONE,[te,f]),ie=r.useMemo(()=>3===Y.length?f.evaluate3CardHand(Y):null,[Y,f]),de=r.useMemo(()=>5===Q.length?f.evaluate5CardHand(Q):null,[Q,f]),oe=r.useMemo(()=>5===ee.length?f.evaluate5CardHand(ee):null,[ee,f]),ce=3===Y.length&&5===Q.length&&5===ee.length,xe=r.useMemo(()=>!!ce&&f.isValidArrangement(Y,Q,ee),[ce,Y,Q,ee,f]);"arranging"===r.useMemo(()=>j.gamePhase,[j.gamePhase])&&0===Y.length&&0===Q.length&&0===ee.length&&te&&te.isReady;const me=r.useCallback(e=>{"arranging"===j.gamePhase&&te&&!te.isReady&&(Y.includes(e)?J(Y.filter(s=>s!==e)):Q.includes(e)?Z(Q.filter(s=>s!==e)):ee.includes(e)?se(ee.filter(s=>s!==e)):(_===E.BACK&&ee.length<5?(se([...ee,e]),ee.length+1===5&&D(E.MIDDLE)):_===E.MIDDLE&&Q.length<5?(Z([...Q,e]),Q.length+1===5&&D(E.FRONT)):_===E.FRONT&&Y.length<3?J([...Y,e]):ee.length<5?se([...ee,e]):Q.length<5?Z([...Q,e]):Y.length<3&&J([...Y,e]),V(!1),a.play("click")))},[j.gamePhase,te,_,Y,Q,ee]),[he,pe]=r.useState(!1),ue=r.useMemo(()=>te&&0!==te.hand.length?f.generateSuggestions(te.hand):[],[te?.hand,f]),ge=r.useCallback(e=>{J(e.front),Z(e.middle),se(e.back),V(!0),pe(!1),a.play("click")},[]),be=r.useCallback(()=>{J([]),Z([]),se([]),D(E.BACK),V(!1)},[]),fe=r.useCallback(()=>{f.requestDeclareInstantWin(),a.play("click")},[f]),je=r.useMemo(()=>{const e=[],s=j.players.length;for(let a=0;a<s;a++){const t=ae>=0?(ae+a)%s:a;e.push({player:j.players[t],index:t})}return e},[j.players,ae]),ve=r.useMemo(()=>"ended"!==j.gamePhase?[]:f.computePostGameAnalysis(j.players,j.players.map((e,s)=>s)),[j.players,j.gamePhase,f]);return t.jsxs("div",{className:"flex flex-col w-full h-full bg-slate-900 text-white relative overflow-hidden select-none mb-16!",children:[t.jsxs("div",{className:"flex flex-col gap-2",children:[t.jsx("div",{className:"flex justify-center gap-2 px-2 py-2 pt-6",children:je.slice(1).map(e=>t.jsx(L,{player:e.player,isSelf:!1,isHost:le,gamePhase:j.gamePhase,ti:v,onAddBot:()=>f.requestAddBot(e.index),onRemove:()=>f.requestRemovePlayer(e.index),onShowAnalytics:(()=>{const s=ve.find(s=>s.playerIndex===e.index);if(s&&s.optimalScore>s.actualScore)return()=>{const s=ve.findIndex(s=>s.playerIndex===e.index);-1!==s&&H(s)}})(),game:f},e.index))}),j.players.some(e=>null!==e.id&&0!==e.score)&&t.jsx("div",{className:"flex justify-center gap-3 px-2 py-1",children:j.players.filter(e=>null!==e.id).map((e,s)=>t.jsxs("div",{className:"flex items-center gap-1 text-xs",children:[t.jsxs("span",{className:"text-slate-400 truncate max-w-[60px]",children:[e.username,":"]}),t.jsxs("span",{className:e.score>0?"text-green-400 font-bold":e.score<0?"text-red-400 font-bold":"text-slate-500",children:[e.score>0?"+":"",e.score]})]},s))}),t.jsxs("div",{className:"flex flex-col items-center justify-center gap-2 p-2 border border-slate-700 rounded-xl bg-slate-800/50 min-h-40",children:["arranging"===j.gamePhase&&t.jsx(z,{timerEndsAt:j.timerEndsAt,isReady:!!te?.isReady}),t.jsxs("div",{className:"bg-black/40 px-3 py-1 rounded-full border border-slate-600 text-xs text-slate-300",children:[v(R[j.gamePhase]),j.roundNumber>0&&t.jsx("span",{className:"ml-1.5 text-slate-500",children:v({en:`Round ${j.roundNumber}`,vi:`V√°n ${j.roundNumber}`})})]}),"ended"===j.gamePhase&&j.roundResults.length>0&&t.jsxs("div",{className:"bg-slate-900/80 px-3 py-2 rounded-xl border border-yellow-500/30 w-full max-w-xs",children:[t.jsxs("h3",{className:"text-yellow-400 font-bold text-md mb-1 flex items-center justify-center gap-1",children:[t.jsx(d,{className:"w-3 h-3"}),v({en:"Results",vi:"K·∫øt qu·∫£"})]}),t.jsx("div",{className:"space-y-0.5",children:j.roundResults.map((e,s)=>{const a=j.players[e.p1Index],l=j.players[e.p2Index];return t.jsxs("div",{className:"flex items-center justify-between text-xs bg-slate-800/50 px-1.5 py-0.5 rounded",children:[t.jsxs("span",{className:e.p1Total>0?"text-green-400 font-bold":e.p1Total<0?"text-red-400":"text-slate-400",children:[a.username," (",e.p1Total>0?"+":"",e.p1Total,")"]}),t.jsx("span",{className:"text-slate-500 mx-1",children:"vs"}),t.jsxs("span",{className:e.p2Total>0?"text-green-400 font-bold":e.p2Total<0?"text-red-400":"text-slate-400",children:[l.username," (",e.p2Total>0?"+":"",e.p2Total,")"]})]},s)})})]})]}),je.length>0&&t.jsx("div",{className:"flex justify-center px-2 py-1",children:t.jsx(L,{player:je[0].player,isSelf:!0,isHost:le,gamePhase:j.gamePhase,ti:v,onAddBot:()=>f.requestAddBot(je[0].index),onRemove:()=>f.requestRemovePlayer(je[0].index),onShowAnalytics:(()=>{const e=ve.find(e=>e.playerIndex===je[0].index);if(e&&e.optimalScore>e.actualScore)return()=>{const e=ve.findIndex(e=>e.playerIndex===je[0].index);-1!==e&&H(e)}})(),game:f})})]}),t.jsxs("div",{className:"w-full shrink-0 bg-slate-900/90 glass-blur z-20",children:["arranging"===j.gamePhase&&te&&!te.isReady&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"px-2 py-3 space-y-3",children:[t.jsx("div",{className:"grid grid-cols-3 gap-1",children:[{title:N({en:"BACK (5)",vi:"CHI ƒê·∫¶U (5)"}),key:E.BACK,cards:ee,eval:oe,size:5},{title:N({en:"MIDDLE (5)",vi:"CHI GI·ªÆA (5)"}),key:E.MIDDLE,cards:Q,eval:de,size:5},{title:N({en:"FRONT (3)",vi:"CHI CU·ªêI (3)"}),key:E.FRONT,cards:Y,eval:ie,size:3}].map(e=>t.jsxs("div",{onClick:()=>D(e.key),className:"p-2 px-0 rounded-lg border-2 cursor-pointer transition-all "+(_===e.key?"border-red-500 bg-red-500/10":"border-slate-700 bg-slate-800/50"),children:[t.jsxs("div",{className:"text-[10px] font-bold text-center mb-2",children:[t.jsx("span",{children:e.title}),t.jsx("br",{}),e.eval&&t.jsx("span",{className:`mt-2 px-1.5 py-0.5 rounded-full border ${U(e.eval.rank)}`,children:v(C[e.eval.rank])})]}),t.jsxs("div",{className:"flex justify-center gap-0.5 min-h-[40px] flex-wrap",children:[e.cards.map(e=>t.jsx(l.div,{layoutId:`card-${e}`,layout:!0,children:t.jsx($,{card:e,onClick:()=>me(e),highlight:!0})},e)),Array(e.size-e.cards.length).fill(null).map((e,s)=>t.jsx("div",{className:"w-8 h-11 border border-dashed border-slate-600 rounded bg-slate-800/30"},`e-${s}`))]})]},e.key))}),t.jsx("div",{className:"flex flex-wrap justify-center gap-1 px-1",children:ne.map(e=>t.jsx(l.div,{layoutId:`card-${e}`,layout:!0,children:t.jsx(G,{card:e,size:"md",onClick:()=>me(e),className:"cursor-pointer hover:scale-110 hover:-translate-y-1 transition-all"})},e))}),t.jsxs("div",{className:"flex items-center justify-center gap-2 flex-wrap",children:[re!==k.NONE&&t.jsxs("button",{onClick:fe,className:"px-4 py-2.5 bg-linear-to-r from-amber-600 to-yellow-500 hover:from-amber-500 hover:to-yellow-400 rounded-xl font-bold text-sm flex items-center gap-2 shadow-lg shadow-amber-900/30 animate-pulse",children:[t.jsx(o,{className:"w-4 h-4"}),v(S[re])]}),t.jsxs("button",{onClick:()=>pe(!he),className:"px-4 py-2.5 rounded-xl font-bold text-sm flex items-center gap-2 transition-all "+(he?"bg-purple-500 ring-2 ring-purple-300":"bg-purple-700 hover:bg-purple-600"),children:[t.jsx(c,{className:"w-4 h-4"}),v({en:"Suggest",vi:"G·ª£i √Ω"})]}),t.jsxs("button",{onClick:be,className:"px-4 py-2.5 bg-slate-700 hover:bg-slate-600 rounded-xl font-bold text-sm flex items-center gap-2",children:[t.jsx(x,{className:"w-4 h-4"}),v({en:"Clear",vi:"Xo√°"})]}),t.jsxs("button",{onClick:async()=>{if(ce){if(!xe){if(!(await y(N({en:"Your arrangement is invalid (Fouled). You might lose many points. Submit anyway?",vi:"B√†i c·ªßa b·∫°n ƒëang b·ªã Binh L·ªßng. B·∫°n c√≥ th·ªÉ b·ªã tr·ª´ r·∫•t nhi·ªÅu ƒëi·ªÉm. V·∫´n mu·ªën n·ªôp?"}),N({en:"Submit Anyway?",vi:"V·∫´n n·ªôp?"}))))return}f.requestArrangeCards(Y,Q,ee,K),a.play("click")}},disabled:!ce,className:"px-6 py-2.5 rounded-xl font-bold text-sm flex items-center gap-2 shadow-lg "+(ce?xe?"bg-green-600 hover:bg-green-500 shadow-green-900/30":"bg-orange-600 hover:bg-orange-500 shadow-orange-900/30":"bg-slate-600 cursor-not-allowed opacity-50"),children:[t.jsx(m,{className:"w-4 h-4"}),ce?xe?v({en:"Submit",vi:"X√°c nh·∫≠n"}):t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx(h,{className:"w-3 h-3"}),v({en:"Submit (Fouled!)",vi:"X√°c nh·∫≠n (L·ªßng!)"})]}):v({en:"Place all cards",vi:"X·∫øp h·∫øt b√†i"})]})]})]}),he&&ue.length>0&&t.jsx("div",{className:"px-2 pb-2",children:t.jsx("div",{className:"flex gap-1 flex-wrap pb-1 justify-center",children:ue.map((e,s)=>t.jsxs("button",{onClick:()=>ge(e),className:"shrink-0 bg-slate-800 border border-purple-500/40 hover:border-purple-400 rounded-xl p-2.5 text-left transition-all hover:bg-slate-700 min-w-[140px]",children:[t.jsx("div",{className:"text-xs font-bold text-purple-300 mb-1.5 text-center",children:v(e.label)}),t.jsxs("div",{className:"flex flex-col gap-1.5 ",children:[t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx("div",{className:`flex items-center gap-1 px-1.5 py-0.5 rounded-full border mb-0.5 ${U(e.backRank)}`,children:t.jsx("span",{className:"text-xs font-bold",children:v(C[e.backRank])})}),t.jsx("div",{className:"flex -space-x-1",children:e.back.map((e,s)=>t.jsx(W,{card:e},s))})]}),t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx("div",{className:`flex items-center gap-1 px-1.5 py-0.5 rounded-full border mb-0.5 ${U(e.middleRank)}`,children:t.jsx("span",{className:"text-xs font-bold",children:v(C[e.middleRank])})}),t.jsx("div",{className:"flex -space-x-1",children:e.middle.map((e,s)=>t.jsx(W,{card:e},s))})]}),t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx("div",{className:`flex items-center gap-1 px-1.5 py-0.5 rounded-full border mb-0.5 ${U(e.frontRank)}`,children:t.jsx("span",{className:"text-xs font-bold",children:v(C[e.frontRank])})}),t.jsx("div",{className:"flex -space-x-1",children:e.front.map((e,s)=>t.jsx(W,{card:e},s))})]})]})]},s))})})]}),"arranging"===j.gamePhase&&te?.isReady&&t.jsxs("div",{className:"flex items-center justify-center p-4 text-slate-400",children:[t.jsx(m,{className:"w-5 h-5 mr-2 text-green-500"}),v({en:"Waiting for others...",vi:"ƒêang ch·ªù ng∆∞·ªùi kh√°c..."})]}),"waiting"===j.gamePhase&&le&&t.jsx("div",{className:"w-full flex justify-center p-3",children:j.players.filter(e=>null!==e.id).length>=2?t.jsx("button",{onClick:()=>f.requestStartGame(),className:"px-8 py-3 bg-green-600 hover:bg-green-500 rounded-xl font-bold text-lg shadow-lg shadow-green-900/20 w-full @md:w-auto",children:v({en:"Start Game",vi:"B·∫Øt ƒë·∫ßu"})}):t.jsx("div",{className:"px-8 py-3 bg-slate-700/50 rounded-xl font-bold text-lg text-slate-400 border border-slate-600 w-full @md:w-auto text-center cursor-not-allowed",children:v({en:"Waiting for players (min 2)...",vi:"ƒêang ch·ªù ng∆∞·ªùi ch∆°i (t·ªëi thi·ªÉu 2)..."})})}),"ended"===j.gamePhase&&le&&t.jsxs("div",{className:"w-full flex justify-center items-center gap-4 p-3",children:[t.jsxs("button",{onClick:()=>{be(),f.requestStartGame()},className:"px-6 py-3 bg-green-600 hover:bg-green-500 rounded-xl font-bold text-lg shadow-lg shadow-green-900/40 flex items-center gap-2 transition-all transform hover:scale-105",children:[t.jsx(p,{className:"w-5 h-5"}),v({en:"Next Round",vi:"V√°n ti·∫øp"})]}),t.jsxs("button",{onClick:async()=>{await y(N({en:"Reset all scores?",vi:"Reset ƒëi·ªÉm v√† ch∆°i l·∫°i?"}),N({en:"Reset",vi:"Reset"}))&&(be(),f.requestResetGame())},className:"px-6 py-3 bg-slate-700 hover:bg-slate-600 rounded-xl font-bold text-lg border border-slate-600 flex items-center gap-2 text-slate-300 hover:text-white transition-all",children:[t.jsx(x,{className:"w-5 h-5"}),v({en:"Reset",vi:"Reset"})]})]})]}),null!==F&&ve&&ve[F]&&i.createPortal(t.jsx(X,{analysis:ve[F],player:j.players[ve[F].playerIndex],ti:v,ts:N,onClose:()=>H(null)}),document.body),t.jsx("button",{onClick:()=>M(!0),className:"fixed bottom-4 right-4 p-3 bg-slate-700 hover:bg-slate-600 rounded-full text-yellow-500 transition-colors z-40 shadow-lg border border-slate-500",title:N({en:"Rules",vi:"Lu·∫≠t ch∆°i"}),children:t.jsx(u,{size:24})}),w&&i.createPortal(t.jsx("div",{className:"fixed inset-0 z-100 flex items-center justify-center bg-black/80 p-4 animate-in fade-in duration-200",onClick:()=>M(!1),children:t.jsxs("div",{className:"bg-slate-900 border border-slate-700 rounded-xl max-w-lg w-full max-h-[85vh] flex flex-col shadow-2xl relative overflow-hidden",onClick:e=>e.stopPropagation(),children:[t.jsxs("div",{className:"flex justify-between items-center p-4 bg-slate-800 border-b border-slate-700 shrink-0",children:[t.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[t.jsx(u,{className:"w-6 h-6 text-yellow-500"}),v({en:"How to Play M·∫≠u Binh",vi:"Lu·∫≠t Ch∆°i M·∫≠u Binh"})]}),t.jsx("button",{onClick:()=>M(!1),className:"p-2 hover:bg-slate-700 rounded-lg transition-colors text-slate-400 hover:text-white",children:t.jsx(g,{className:"w-5 h-5"})})]}),t.jsxs("div",{className:"md:p-6 p-4 overflow-y-auto space-y-8 text-slate-300",children:[t.jsx("section",{children:t.jsx("p",{className:"text-base text-slate-100 italic border-l-4 border-yellow-500 pl-4 py-1 bg-yellow-500/10 rounded-r",children:v({en:"Arrange 13 cards into 3 hands (Back ‚â• Middle ‚â• Front) and compare with opponents.",vi:"X·∫øp 13 l√° b√†i th√†nh 3 chi (ƒê·∫ßu ‚â• Gi·ªØa ‚â• Cu·ªëi) r·ªìi so b√†i v·ªõi ƒë·ªëi th·ªß."})})}),t.jsxs("section",{children:[t.jsxs("h3",{className:"text-lg font-bold text-yellow-400 mb-3 flex items-center gap-2",children:[t.jsx(d,{className:"w-5 h-5"}),v({en:"Card Arrangement",vi:"C√°ch X·∫øp B√†i"})]}),t.jsxs("ul",{className:"space-y-2 text-sm text-slate-300",children:[t.jsxs("li",{className:"flex justify-between border-b border-slate-800 pb-1",children:[t.jsx("span",{children:v({en:"Back (Chi ƒë·∫ßu)",vi:"Chi ƒë·∫ßu"})}),t.jsx("span",{className:"font-bold text-red-400",children:v({en:"5 cards ‚Äî Strongest",vi:"5 l√° ‚Äî M·∫°nh nh·∫•t"})})]}),t.jsxs("li",{className:"flex justify-between border-b border-slate-800 pb-1",children:[t.jsx("span",{children:v({en:"Middle (Chi gi·ªØa)",vi:"Chi gi·ªØa"})}),t.jsx("span",{className:"font-bold text-blue-400",children:v({en:"5 cards",vi:"5 l√°"})})]}),t.jsxs("li",{className:"flex justify-between border-b border-slate-800 pb-1",children:[t.jsx("span",{children:v({en:"Front (Chi cu·ªëi)",vi:"Chi cu·ªëi"})}),t.jsx("span",{className:"font-bold text-green-400",children:v({en:"3 cards ‚Äî Weakest",vi:"3 l√° ‚Äî Y·∫øu nh·∫•t"})})]}),t.jsx("li",{className:"text-xs text-red-400 italic mt-2",children:v({en:"‚ö† Back ‚â• Middle ‚â• Front required, or you get Fouled (auto-lose)!",vi:"‚ö† Chi ƒë·∫ßu ‚â• Chi gi·ªØa ‚â• Chi cu·ªëi b·∫Øt bu·ªôc, n·∫øu kh√¥ng s·∫Ω b·ªã Binh L·ªßng (thua)!"})})]})]}),t.jsxs("section",{children:[t.jsxs("h3",{className:"text-lg font-bold text-yellow-400 mb-3 flex items-center gap-2",children:[t.jsx(d,{className:"w-5 h-5"}),v({en:"Hand Rankings",vi:"Th·ª© T·ª± Tay B√†i"}),t.jsx("span",{className:"text-xs font-normal text-slate-400 bg-slate-800 px-2 py-0.5 rounded ml-auto",children:v({en:"Strongest to Weakest",vi:"T·ª´ m·∫°nh ƒë·∫øn y·∫øu"})})]}),t.jsx("div",{className:"space-y-0 text-sm",children:Object.values(A).reverse().map((e,s)=>t.jsxs("div",{className:"flex justify-between items-center p-2 rounded "+(s%2==0?"bg-slate-800/50":""),children:[t.jsxs("div",{className:`flex items-center gap-2 px-2 py-0.5 rounded-full border ${U(e)}`,children:[t.jsx(d,{className:`w-3 h-3 ${q(e)}`}),t.jsx("span",{className:"font-bold",children:v(C[e])})]}),t.jsx("span",{className:"text-slate-400 text-sm",children:v(T[e])})]},s))})]}),t.jsxs("section",{children:[t.jsxs("h3",{className:"text-lg font-bold text-yellow-400 mb-3 flex items-center gap-2",children:[t.jsx(o,{className:"w-5 h-5"}),v({en:"Instant Wins",vi:"M·∫≠u Binh T·ªõi Tr·∫Øng"})]}),t.jsx("p",{className:"text-base text-slate-100 italic border-l-4 border-yellow-500 pl-4 py-1 mb-2 bg-yellow-500/10 rounded-r",children:v({en:"Win immediately if you have one of these hands",vi:"Th·∫Øng ngay l·∫≠p t·ª©c n·∫øu c√≥ 1 trong c√°c tay b√†i sau"})}),t.jsx("div",{className:"space-y-0 text-sm",children:Object.values(k).filter(e=>e!==k.NONE).map((e,s)=>t.jsxs("div",{className:"flex justify-between items-center p-2 rounded "+(s%2==0?"bg-amber-900/20":""),children:[t.jsxs("div",{className:"flex items-center gap-2 px-2 py-0.5 rounded-full border bg-amber-900/50 border-amber-500/30 text-amber-200",children:[t.jsx(o,{className:"w-3 h-3 text-amber-400"}),t.jsx("span",{className:"font-bold",children:v(S[e])})]}),t.jsx("span",{className:"text-slate-400 text-sm",children:v(P[e])})]},s))})]}),t.jsxs("section",{children:[t.jsxs("h3",{className:"text-lg font-bold text-yellow-400 mb-3 flex items-center gap-2",children:[t.jsx(x,{className:"w-5 h-5"}),v({en:"Comparison",vi:"C√°ch So B√†i"})]}),t.jsxs("ul",{className:"space-y-2 text-sm text-slate-300",children:[t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"text-yellow-500 font-bold",children:"‚Ä¢"}),t.jsx("span",{children:v({en:"Hands are compared one by one: Back vs Back, Middle vs Middle, Front vs Front.",vi:"So s√°nh t·ª´ng chi t∆∞∆°ng ·ª©ng: Chi ƒë·∫ßu vs Chi ƒë·∫ßu, Gi·ªØa vs Gi·ªØa, Cu·ªëi vs Cu·ªëi."})})]}),t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"text-yellow-500 font-bold",children:"‚Ä¢"}),t.jsx("span",{children:v({en:"Winning a chi grants +1 point, losing a chi takes -1 point.",vi:"Th·∫Øng m·ªói chi ƒë∆∞·ª£c +1 ƒëi·ªÉm, thua m·ªói chi b·ªã -1 ƒëi·ªÉm."})})]})]})]}),t.jsxs("section",{children:[t.jsxs("h3",{className:"text-lg font-bold text-yellow-400 mb-3 flex items-center gap-2",children:[t.jsx(d,{className:"w-5 h-5"}),v({en:"Scoring & Bonuses",vi:"T√≠nh ƒêi·ªÉm & Th∆∞·ªüng"})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:"space-y-0 text-sm",children:Object.keys(I).map((e,s)=>t.jsxs("div",{className:"flex justify-between items-center p-2 rounded "+(s%2==0?"bg-slate-800/50":""),children:[t.jsx("span",{className:"text-slate-200",children:v(B[e])}),t.jsxs("span",{className:"font-bold text-green-400",children:["+",I[e]]})]},s))}),t.jsxs("div",{className:"bg-indigo-900/20 border border-indigo-500/30 rounded-lg p-3 space-y-2 text-xs",children:[t.jsxs("div",{className:"flex gap-2",children:[t.jsx(o,{className:"w-4 h-4 text-indigo-400 shrink-0"}),t.jsxs("p",{children:[t.jsx("span",{className:"font-bold text-indigo-300 mr-1",children:v({en:"Scoop (S·∫≠p 3 chi):",vi:"S·∫≠p 3 chi:"})}),v({en:"Win all 3 hands against an opponent to get +3 bonus.",vi:"Th·∫Øng c·∫£ 3 chi tr∆∞·ªõc 1 ƒë·ªëi th·ªß ƒë∆∞·ª£c th∆∞·ªüng th√™m +3."})]})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(b,{className:"w-4 h-4 text-indigo-400 shrink-0"}),t.jsxs("p",{children:[t.jsx("span",{className:"font-bold text-indigo-300 mr-1",children:v({en:"Manual Bonus:",vi:"Th∆∞·ªüng th·ªß c√¥ng:"})}),v({en:"Win without using auto-arrange to get +1 extra bonus.",vi:"Th·∫Øng m√† kh√¥ng d√πng g·ª£i √Ω ƒë∆∞·ª£c th∆∞·ªüng th√™m +1."})]})]})]})]})]})]})]})}),document.body)]})}function z({timerEndsAt:e,isReady:s}){const[l,i]=r.useState(Date.now());r.useEffect(()=>{const e=setInterval(()=>{i(Date.now())},1e3);return()=>clearInterval(e)},[]);const d=Math.max(0,Math.floor((e-l)/1e3));return r.useEffect(()=>{d<=10&&d>0&&!s&&a.play(n.tick)},[d,s]),t.jsxs("div",{className:"bg-black/60 px-4 py-2 rounded-xl border flex items-center gap-2 transition-all duration-300 "+(d<=5?"border-red-500 scale-110 shadow-[0_0_15px_rgba(239,68,68,0.5)] animate-pulse":d<=10?"border-red-500 animate-pulse":"border-yellow-500/30"),children:[t.jsx(v,{className:"w-4 h-4 "+(d<=10?"text-red-500":"text-yellow-500")}),t.jsxs("span",{className:"font-bold text-xl font-mono "+(d<=10?"text-red-400":"text-yellow-400"),children:[d,"s"]})]})}function L({player:e,isSelf:s,isHost:a,gamePhase:l,ti:n,onAddBot:r,onRemove:i,onShowAnalytics:d,game:c}){if(null===e.id)return t.jsxs("div",{className:"flex flex-col items-center gap-2 opacity-50 hover:opacity-100 transition-opacity",children:[t.jsx("div",{className:"w-14 h-14 rounded-full border-2 border-dashed border-slate-500 flex items-center justify-center bg-black/20 text-slate-400",children:t.jsx(f,{className:"w-6 h-6"})}),"waiting"===l&&a&&t.jsxs("button",{onClick:r,className:"px-3 py-1 bg-slate-700 hover:bg-slate-600 rounded text-xs flex items-center gap-1",children:[t.jsx(j,{className:"w-3 h-3"})," Bot"]})]});const x="comparing"===l||"ended"===l;return t.jsxs("div",{className:"relative flex flex-col items-center p-2 rounded-xl transition-all duration-300 min-w-[100px] @md:min-w-[150px] "+(e.isReady&&"arranging"===l?"ring-2 ring-green-400 bg-green-900/20":e.isFouled?"ring-2 ring-red-500 bg-red-900/20":e.instantWin!==k.NONE&&x?"ring-2 ring-amber-400 bg-amber-900/20 animate-pulse":"bg-slate-900/60 ring-1 ring-slate-700"),children:[e.instantWin!==k.NONE&&x&&t.jsxs("div",{className:"absolute -top-5 bg-linear-to-r from-amber-600 to-yellow-500 px-2 py-0.5 rounded-full text-[10px] font-bold text-white flex items-center gap-1 shadow-lg z-30 whitespace-nowrap",children:[t.jsx(o,{className:"w-3 h-3"}),n(S[e.instantWin])]}),e.isFouled&&x&&t.jsxs("div",{className:"absolute -top-5 bg-red-600 px-2 py-0.5 rounded-full text-[10px] font-bold text-white flex items-center gap-1 shadow-lg z-30",children:[t.jsx(h,{className:"w-3 h-3"}),n({en:"Fouled!",vi:"Binh L·ªßng!"})]}),t.jsxs("div",{className:"flex items-center gap-1 mb-1 max-w-[150px]",children:[e.isBot&&t.jsx(j,{className:"w-3 h-3 text-blue-400"}),t.jsx("span",{className:"text-xs font-bold",children:e.username})]}),e.isReady&&"arranging"===l&&t.jsx(m,{className:"w-4 h-4 text-green-500"}),"arranging"!==l&&t.jsxs("div",{className:"text-xs font-mono px-2 py-0.5 rounded-full mb-1 "+(e.score>0?"bg-green-900/50 text-green-400":e.score<0?"bg-red-900/50 text-red-400":"bg-slate-800/50 text-slate-400"),children:[e.score>0?"+":"",e.score]}),x&&!e.usedAuto&&!e.isBot&&!e.isFouled&&e.score>0&&t.jsxs("div",{className:"mb-1 bg-emerald-900/50 border border-emerald-500/40 text-emerald-300 px-1.5 py-0.5 rounded-full text-xs font-bold flex items-center gap-0.5",children:["üß† ",n({en:"Manual +1",vi:"Th·ªß c√¥ng +1"})]}),x&&e.back.length>0&&t.jsx("div",{className:"flex flex-col gap-0.5 items-center mt-1",children:[e.back,e.middle,e.front].map(e=>{const s=c.evaluate5CardHand(e).rank;return t.jsxs("div",{className:"flex flex-col items-center gap-0.5",children:[t.jsx("div",{className:`flex items-center gap-2 px-2 py-0.5 rounded-full border ${U(s)}`,children:t.jsx("span",{className:"text-xs font-bold",children:n(C[s])})}),t.jsx("div",{className:"flex -space-x-1",children:e.map((e,s)=>t.jsx(W,{card:e},s))})]},e+"")})}),"arranging"===l&&!s&&e.hand.length>0&&t.jsx("div",{className:"flex flex-wrap justify-center -space-x-1 max-w-[60px] mt-1",children:Array(3).fill(null).map((e,s)=>t.jsx("div",{className:"w-3.5 h-5 bg-blue-900 rounded-sm border border-white/20"},s))}),"ended"===l&&(d?t.jsxs("button",{onClick:e=>{e.stopPropagation(),d()},className:"mt-3 w-full px-3 py-1.5 bg-linear-to-r from-indigo-600 to-violet-600 hover:from-indigo-500 hover:to-violet-500 rounded-lg text-[10px] font-bold flex items-center justify-center gap-1.5 transition-all shadow-lg shadow-indigo-900/40 ring-1 ring-indigo-400/50 hover:ring-indigo-300 animate-pulse-slow group",children:[t.jsx(o,{className:"w-3 h-3 text-yellow-300 group-hover:scale-125 transition-transform"}),t.jsx("span",{className:"text-white drop-shadow-sm",children:n({en:"Better way?",vi:"C√°ch x·∫øp t·ªët h∆°n?"})})]}):null),a&&"waiting"===l&&e.isBot&&t.jsx("button",{onClick:i,className:"absolute top-0 right-0 w-5 h-5 bg-red-600/80 rounded-full flex items-center justify-center text-white hover:bg-red-500 z-30",children:t.jsx(g,{className:"w-3 h-3"})})]})}function G({card:e,size:s="md",className:a="",onClick:l}){const{rank:n,suit:r}=H(e),i=r===_.HEART||r===_.DIAMOND;return t.jsxs("div",{onClick:l,className:`${{sm:"w-9 h-13 text-[11px]",md:"w-12 h-17 text-sm",lg:"w-14 h-20 text-base"}[s]} bg-white rounded-md shadow-lg border border-slate-300 flex flex-col items-center justify-between p-0.5 select-none animate-[cardPlay_0.3s_ease-out_forwards] ${a}`,children:[t.jsx("div",{className:"self-start font-bold leading-none "+(i?"text-red-600":"text-slate-900"),children:M[n]}),t.jsx("div",{className:(i?"text-red-500":"text-slate-800")+" text-lg",children:F[r]}),t.jsx("div",{className:"h-2"})]})}function $({card:e,onClick:s,highlight:a}){const{rank:l,suit:n}=H(e),r=n===_.HEART||n===_.DIAMOND;return t.jsxs("div",{onClick:s,className:`w-8 h-11 bg-white rounded-sm shadow border flex flex-col items-center justify-center select-none text-xs font-bold leading-tight animate-[cardPlay_0.3s_ease-out_forwards] ${a?"ring-1 ring-yellow-400 cursor-pointer hover:scale-110 transition-transform":""} ${s?"cursor-pointer":""}`,children:[t.jsx("span",{className:r?"text-red-600":"text-slate-900",children:M[l]}),t.jsx("span",{className:"text-xs "+(r?"text-red-500":"text-slate-800"),children:F[n]})]})}function W({card:e}){const{rank:s,suit:a}=H(e),l=a===_.HEART||a===_.DIAMOND;return t.jsxs("div",{className:"w-6 h-10 bg-white rounded-sm border border-slate-300 flex flex-col items-center justify-center select-none leading-none animate-[cardPlay_0.3s_ease-out_forwards]",children:[t.jsx("span",{className:"text-xs font-bold "+(l?"text-red-600":"text-slate-900"),children:M[s]}),t.jsx("span",{className:"text-xs "+(l?"text-red-500":"text-slate-800"),children:F[a]})]})}const U=e=>{if(void 0===e)return"bg-slate-900/90 border-slate-500/50 text-slate-200";switch(e){case A.STRAIGHT_FLUSH:return"bg-purple-900/90 border-purple-500/50 text-purple-200 shadow-purple-900/50";case A.FOUR_OF_A_KIND:case A.FULL_HOUSE:return"bg-red-900/90 border-red-500/50 text-red-100 shadow-red-900/50";case A.FLUSH:case A.STRAIGHT:return"bg-blue-900/90 border-blue-500/50 text-blue-100 shadow-blue-900/50";case A.THREE_OF_A_KIND:case A.TWO_PAIR:return"bg-green-900/90 border-green-500/50 text-green-100 shadow-green-900/50";default:return"bg-slate-800/90 border-slate-500/50 text-slate-300 shadow-slate-900/50"}},q=e=>{if(void 0===e)return"text-slate-400";switch(e){case A.STRAIGHT_FLUSH:return"text-purple-400";case A.FOUR_OF_A_KIND:case A.FULL_HOUSE:return"text-red-400";case A.FLUSH:case A.STRAIGHT:return"text-blue-400";case A.THREE_OF_A_KIND:case A.TWO_PAIR:return"text-green-400";default:return"text-slate-400"}};function K({analysis:e,player:s,ti:a,ts:l}){const n=Math.round(e.actualScore/e.optimalScore*100);return t.jsxs("div",{className:"bg-slate-900/60 rounded-xl p-3 w-full @md:max-w-sm",children:[t.jsxs("div",{className:"flex justify-between items-center mb-2",children:[t.jsx("div",{className:"text-md text-white font-bold flex items-center gap-1.5",children:s.username}),t.jsxs("div",{className:"flex items-center gap-1 flex-wrap justify-end",children:[t.jsxs("div",{className:"text-xs px-2 py-0.5 rounded-full bg-orange-500/20 text-orange-300 font-bold border border-orange-500/30",children:[a({en:"Better than",vi:"T·ªët h∆°n"})," ",100-n,"%"]}),e.optimalPoints>e.actualPoints&&t.jsxs("div",{className:"text-xs px-2 py-0.5 rounded-full bg-green-500/20 text-green-400 font-bold border border-green-500/30 flex items-center gap-1",children:[t.jsx(y,{className:"w-3 h-3"}),"+",e.optimalPoints-e.actualPoints,t.jsx("span",{className:"text-[8px] opacity-70 ml-0.5",children:"pts"})]})]})]}),t.jsxs("div",{className:"mt-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-2",children:[t.jsxs("div",{className:"flex flex-col gap-1",children:[t.jsxs("div",{className:"text-xs font-bold text-slate-400 uppercase flex items-center gap-1",children:[t.jsx(w,{className:"w-3 h-3"}),a({en:"Current",vi:"Hi·ªán t·∫°i"})]}),t.jsxs("div",{className:"text-xs font-mono font-bold "+(e.actualPoints>=0?"text-green-400":"text-red-400"),children:[e.actualPoints>0?"+":"",e.actualPoints," pts"]})]}),t.jsxs("div",{className:"flex flex-col items-end",children:[t.jsxs("div",{className:"text-xs font-bold text-indigo-400 uppercase flex items-center gap-1",children:[t.jsx(o,{className:"w-3 h-3"}),a({en:"Optimal",vi:"T·ªëi ∆∞u"})]}),t.jsxs("div",{className:"text-xs font-mono font-bold text-indigo-300",children:[e.optimalPoints>0?"+":"",e.optimalPoints," pts"]})]})]}),t.jsx("div",{className:"space-y-1",children:[{label:l({en:"Back",vi:"ƒê·∫ßu"}),actual:e.actual.back,actualRank:e.actualBackRank,optimal:e.optimal.back,optimalRank:e.optimalBackRank},{label:l({en:"Middle",vi:"Gi·ªØa"}),actual:e.actual.middle,actualRank:e.actualMiddleRank,optimal:e.optimal.middle,optimalRank:e.optimalMiddleRank},{label:l({en:"Front",vi:"Cu·ªëi"}),actual:e.actual.front,actualRank:e.actualFrontRank,optimal:e.optimal.front,optimalRank:e.optimalFrontRank}].map((e,s)=>t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsxs("div",{className:"bg-slate-800/40 p-1 rounded-lg border border-slate-700/30 relative",children:[t.jsx("span",{className:"absolute -top-1 -left-1 px-1 bg-slate-700 text-[8px] rounded font-bold text-slate-400 z-10 border border-slate-600/50",children:e.label}),t.jsxs("div",{className:"flex flex-col items-center gap-1",children:[t.jsx("div",{className:`px-1.5 py-0.5 rounded-full border text-[10px] font-bold leading-none ${U(e.actualRank)}`,children:a(C[e.actualRank])}),t.jsx("div",{className:"flex -space-x-1.5",children:e.actual.map((e,s)=>t.jsx(W,{card:e},s))})]})]}),t.jsxs("div",{className:"bg-indigo-900/20 p-1 rounded-lg border border-indigo-500/20 relative",children:[t.jsx("span",{className:"absolute -top-1 -right-1 px-1 bg-indigo-800 text-[8px] rounded font-bold text-indigo-300 z-10 border border-indigo-500/30",children:e.label}),t.jsxs("div",{className:"flex flex-col items-center gap-1",children:[t.jsxs("div",{className:`px-1.5 py-0.5 rounded-full border text-[10px] font-bold leading-none ${U(e.optimalRank)}`,children:[a(C[e.optimalRank]),e.optimalRank>e.actualRank&&t.jsx("span",{className:"ml-0.5 text-green-400",children:"‚Üë"})]}),t.jsx("div",{className:"flex -space-x-1.5",children:e.optimal.map((e,s)=>t.jsx(W,{card:e},s))})]})]})]},s))})]})]})}function X({analysis:e,player:s,ti:a,ts:l,onClose:n}){return t.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-in fade-in duration-200",children:t.jsxs("div",{className:"relative bg-slate-900 border border-slate-700 rounded-2xl shadow-2xl w-full max-w-lg overflow-hidden flex flex-col max-h-[90vh] animate-in zoom-in-95 duration-200",children:[t.jsxs("div",{className:"px-6 py-4 border-b border-slate-800 flex items-center justify-between bg-slate-900/50",children:[t.jsxs("h3",{className:"text-xl font-bold flex items-center gap-2 text-indigo-400",children:[t.jsx(N,{className:"w-6 h-6"}),a({en:"Cards Analytics",vi:"Ph√¢n t√≠ch x·∫øp b√†i"})]}),t.jsx("button",{onClick:n,className:"p-2 hover:bg-slate-800 rounded-full transition-colors text-slate-400 hover:text-white",children:t.jsx(g,{className:"w-6 h-6"})})]}),t.jsx("div",{className:"p-2 overflow-y-auto custom-scrollbar",children:t.jsx(K,{analysis:e,player:s,ti:a,ts:l})})]})})}export{D as default};
