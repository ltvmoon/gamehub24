import{B as t}from"./BaseGame-Di8Z51TE.js";import"./socket-DRbsQkF5.js";import"./index-CZ7EuLwr.js";import"./react-vendor-B6_iA-Ai.js";import"./zustand-DzQBgWHa.js";class s extends t{getInitState(){return{strokes:[]}}onSocketGameAction(t){const s=t.action;"DRAW"===s.type?this.handleDraw(s.payload):"CLEAR"===s.type?this.handleClear():"UNDO"===s.type&&this.handleUndo(s.payload)}makeAction(t){if(this.isHost)"DRAW"===t.type&&this.handleDraw(t.payload),"CLEAR"===t.type&&this.handleClear(),"UNDO"===t.type&&this.handleUndo(t.payload);else{if("DRAW"===t.type)this.state.strokes=[...this.state.strokes,t.payload],this.syncState();else if("CLEAR"===t.type)this.state.strokes=[],this.syncState();else if("UNDO"===t.type){const s=t.payload;let e=-1;for(let t=this.state.strokes.length-1;t>=0;t--)if(this.state.strokes[t].playerId===s){e=t;break}-1!==e&&(this.state.strokes=this.state.strokes.filter((t,s)=>s!==e),this.syncState())}this.players.find(t=>t.id===this.userId)&&this.sendSocketGameAction(t)}}handleDraw(t){this.isHost&&(this.state.strokes=[...this.state.strokes,t],this.syncState())}handleClear(){this.isHost&&(this.state.strokes=[],this.syncState())}handleUndo(t){if(!this.isHost)return;let s=-1;for(let e=this.state.strokes.length-1;e>=0;e--)if(this.state.strokes[e].playerId===t){s=e;break}-1!==s&&(this.state.strokes=this.state.strokes.filter((t,e)=>e!==s),this.syncState())}draw(t){const s={type:"DRAW",payload:t};this.makeAction(s)}clear(){this.makeAction({type:"CLEAR"})}undo(){const t={type:"UNDO",payload:this.userId};this.makeAction(t)}}export{s as default};
