import{u as e,j as s,i as t,S as l,b as n,e as a,k as r}from"./index-lqVnuPzo.js";import{b as i,c,X as o,$ as d,a5 as x,as as h,J as m,ao as u,x as g,u as b,aW as p,aU as j,ag as v}from"./react-vendor-Do69iInB.js";import{S as f,e as N,M as y,G as w,A as B,P as R,J as k,c as P,R as T,d as C,a as S,B as I}from"./types-8lSJioTM.js";import{u as E}from"./useGameState-DkmzPUgx.js";import{u as G}from"./usePrevious-C4yIiP9X.js";import"./socket-DRbsQkF5.js";import"./zustand-CCNgd6Y3.js";function H({isOpen:l,onClose:n,onConfirm:a,onClear:r,symbol:x,currentBalance:h,currentBet:m,currentBets:u}){const{ti:g}=e(),[b,p]=i.useState(m);if(i.useEffect(()=>{l&&p(m)},[l,m]),!l||!x)return null;const j=h;return c.createPortal(s.jsx("div",{className:"fixed inset-0 z-100 flex items-center justify-center bg-black/80 glass-blur p-4",children:s.jsxs("div",{className:"w-full max-w-md bg-slate-900 border border-slate-700 rounded-xl shadow-2xl overflow-hidden animate-in fade-in zoom-in duration-200",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-800 bg-slate-800/50",children:[s.jsxs("h3",{className:"text-lg font-bold text-white flex items-center gap-2",children:[s.jsx("span",{children:f[x].emoji}),s.jsx("span",{children:g({vi:`C∆∞·ª£c v√†o ${f[x].vi}`,en:`Bet on ${f[x].en}`})})]}),s.jsx("button",{onClick:n,className:"p-2 text-slate-400 hover:text-white hover:bg-slate-700 rounded-lg transition-colors",children:s.jsx(o,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"relative",children:[u.length>=N&&!u.find(e=>e[0]===x)&&s.jsx("div",{className:"absolute inset-0 bg-black/50 z-10 flex items-center justify-center text-red-500",children:g({en:`Can only have max ${N} bets`,vi:`Ch·ªâ c√≥ th·ªÉ c∆∞·ª£c nhi·ªÅu nh·∫•t ${N} linh v·∫≠t`})}),s.jsxs("div",{className:" p-6 space-y-6",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex justify-between text-sm text-slate-400",children:[s.jsx("label",{children:g({vi:"S·ªë ti·ªÅn c∆∞·ª£c",en:"Bet Amount"})}),s.jsxs("span",{children:[g({vi:"S·ªë d∆∞:",en:"Balance:"})," ",s.jsx("span",{className:"text-green-400 font-bold",children:t(h)})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"number",value:b,onChange:e=>{let s=Number(e.target.value);s>h&&(s=h),p(s)},min:0,max:j,className:"flex-1 bg-slate-800 border border-slate-700 rounded-lg px-4 py-3 text-xl font-bold text-white focus:outline-hidden focus:ring-2 focus:ring-blue-500"}),s.jsx("button",{onClick:()=>p(j),className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white font-bold rounded-lg transition-colors text-sm",children:g({vi:"X·∫¢ L√ÅNG",en:"MAX"})})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("input",{type:"range",min:0,max:j,step:10,value:b,onChange:e=>{p(Number(e.target.value))},className:"w-full h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer accent-blue-500"}),s.jsxs("div",{className:"flex justify-between text-xs text-slate-500 font-mono",children:[s.jsx("span",{children:t(0)}),s.jsx("span",{children:t(j/2)}),s.jsx("span",{children:t(j)})]})]}),s.jsx("div",{className:"grid grid-cols-4 gap-2",children:[100,500,1e3,5e3].map(e=>s.jsxs("button",{onClick:()=>p(s=>Math.min(s+e,j)),disabled:b+e>j,className:"px-2 py-2 bg-slate-800 hover:bg-slate-700 disabled:opacity-50 disabled:cursor-not-allowed text-slate-300 text-xs font-semibold rounded-lg transition-colors border border-slate-700",children:["+",t(e)]},e))})]}),s.jsxs("div",{className:"p-4 border-t border-slate-800 bg-slate-800/50 flex gap-3",children:[s.jsx("button",{onClick:r,className:"flex-1 px-4 py-3 bg-slate-700 hover:bg-slate-600 text-white font-bold rounded-lg transition-colors",children:g({vi:"Xo√° c∆∞·ª£c",en:"Clear bet"})}),s.jsxs("button",{onClick:()=>{b>=y&&b<=h&&(a(b),n())},disabled:b<y||b>j,className:"flex-1 px-4 py-3 bg-blue-600 hover:bg-blue-500 disabled:bg-slate-700 disabled:text-slate-500 text-white font-bold rounded-lg transition-colors flex items-center justify-center gap-2",children:[s.jsx(d,{className:"w-5 h-5"}),g({vi:"X√°c nh·∫≠n",en:"Confirm"})]})]})]})]})}),document.body)}function U({game:t,currentUserId:d=""}){const U=t,[M]=E(U),$=`${M.gamePhase}-${M.currentRound}`,O=M.gamePhase===w.BETTING&&!M.playersReady[d];G($,(e,s)=>{M.gamePhase!==w.WAITING&&null!==e&&l.playTurnSwitch(O)});const{confirm:A,show:L}=n(),{ti:W,ts:q}=e(),{currentRoom:D}=a(),[z,K]=i.useState(!0),[J,V]=i.useState([]),[_,F]=i.useState(null),[Y,X]=i.useState(null),Q=Y?M.playerPowerUps[d||""]?.[Y]:void 0,[Z,ee]=i.useState(!1),[se,te]=i.useState([[],[],[]]),[le,ne]=i.useState([0,0,0]),[ae,re]=i.useState(!1),[ie,ce]=i.useState(null),[oe,de]=i.useState(null),[xe,he]=i.useState(null),me=null!==oe?oe:d&&M.playersReady[d]||!1,ue=d?M.playerBalances[d]:void 0,ge=(d?me?M.currentBets[d]||[]:J:[]).filter(e=>e[1]>0),be=ie?ge.filter(e=>e[0]===ie).reduce((e,s)=>e+s[1],0):0,pe=ge.reduce((e,s)=>e+s[1],0),je=ue?ue.currentBalance-ue.balanceHistory[ue.balanceHistory.length-2]:0,ve=ue?ue.currentBalance-pe:0;i.useEffect(()=>U.onUpdate(e=>{if(e.gamePhase===w.ROLLING&&M.gamePhase===w.BETTING){ee(!0);const s=e=>{const s=[];for(let t=0;t<20;t++)s.push(B[Math.floor(Math.random()*B.length)]);return s.push(e),s},t=e.diceRoll;te([s(t[0]),s(t[1]),s(t[2])]),ne([0,0,0]),[0,1,2].forEach(e=>{const s=1500+500*e,t=setInterval(()=>{ne(s=>{const t=[...s];return t[e]=(t[e]+1)%21,t})},100);setTimeout(()=>{clearInterval(t),ne(s=>{const t=[...s];return t[e]=20,t})},s)}),setTimeout(()=>{ee(!1)},3e3)}e.gamePhase===w.BETTING&&e.currentRound!==M.currentRound&&(V([]),X(null)),e.gamePhase!==w.BETTING&&M.gamePhase===w.BETTING&&X(null),d&&null!==oe&&e.playersReady[d]===oe&&de(null),d&&null!==xe&&e.activePowerUps[d]===xe&&he(null)}),[U,M.currentRound,M.gamePhase]);const fe=e=>{const s=[];return Object.entries(M.currentBets).forEach(([t,l])=>{const n=l.find(s=>s[0]===e);if(n){const e=M.playerBalances[t];e&&s.push({playerId:t,username:e.username,amount:n[1],isBot:e.isBot})}}),s.sort((e,s)=>s.amount-e.amount)},Ne=async()=>{if(!U.isHost)return;J.length>0&&!me&&U.requestSyncBets(J);const e=Object.values(M.playerBalances).filter(e=>!e.isBot).filter(e=>(e.playerId!==d||!(J.length>0||me))&&(!(e.currentBalance<y)&&(0===(M.currentBets[e.playerId]||[]).length||!M.playersReady[e.playerId])));if(e.length>0){if(!(await A(q({vi:`C√≥ ${e.length} ng∆∞·ªùi ch∆∞a s·∫µn s√†ng (${e.map(e=>e.username).join(", ")}). B·∫°n c√≥ mu·ªën l·∫Øc x√∫c x·∫Øc lu√¥n kh√¥ng? `,en:`${e.length} player(s) haven't ready yet (${e.map(e=>e.username).join(", ")}). Roll dice anyway? `}),q({vi:"L·∫Øc x√∫c x·∫Øc",en:"Roll Dice"}))))return}U.requestRollDice()},ye=e=>{if(e.length<2)return s.jsx("div",{className:"w-16 h-8"});const t=Math.max(...e),l=Math.min(...e),n=t-l||1,a=e.map((s,l)=>`${2+l/(e.length-1)*60},${2+(t-s)/n*28}`).join(" "),r=e[e.length-1],i=e[e.length-2],c=r===i?"#6b7280":r>i?"#10b981":"#ef4444";return s.jsx("svg",{width:64,height:32,className:"inline-block",children:s.jsx("polyline",{points:a,fill:"none",stroke:c,strokeWidth:"2",strokeLinejoin:"round"})})},we=()=>s.jsxs("div",{className:"bg-slate-800/50 glass-blur rounded-xl p-6 border border-slate-700",children:[s.jsx("h3",{className:"text-lg font-semibold mb-4 text-center",children:W({vi:"K·∫øt qu·∫£ x√∫c x·∫Øc",en:"Dice Roll"})}),s.jsx("div",{className:"flex justify-center gap-2 mb-4",children:Z||M.diceRoll?se.map((e,t)=>{const l=le[t],n=M.diceRoll?M.diceRoll[t]:e[e.length-1],a=!Z&&M.diceRoll&&ge.some(e=>e[0]===n);return s.jsx("div",{className:"relative w-20 h-20 bg-white rounded-xl overflow-hidden shadow-lg "+(a?"bg-linear-to-t from-green-300 to-blue-200 border-3 border-green-500":""),children:Z&&e.length>0?s.jsx("div",{className:"absolute transition-transform duration-100 ease-linear",style:{transform:`translateY(-${80*l}px)`},children:e.map((e,t)=>s.jsx("div",{className:"w-20 h-20 flex items-center justify-center text-5xl border-b border-slate-200",children:f[e].emoji},t))}):s.jsx("div",{className:"w-20 h-20 flex items-center justify-center text-5xl "+(a?"animate-bounce":""),children:f[n].emoji})},t)}):s.jsx("div",{className:"text-slate-500 text-center",children:me?W({vi:"ƒêang ch·ªù ch·ªß ph√≤ng quay x√∫c x·∫Øc...",en:"Waiting for host roll..."}):ge.length?U.isHost?null:W({vi:"Vui l√≤ng b·∫•m S·∫µn s√†ng...",en:"Please press Ready..."}):W(ve<y?{vi:"B·∫°n ƒë√£ h·∫øt ti·ªÅn...",en:"You are out of money..."}:{vi:"Vui l√≤ng ƒë·∫∑t c∆∞·ª£c tr∆∞·ªõc...",en:"Please place bets first..."})})}),U.isHost&&M.gamePhase===w.BETTING&&s.jsxs("button",{onClick:Ne,className:"w-full px-6 py-3 bg-linear-to-r from-red-600 to-orange-600 hover:from-red-700 hover:to-orange-700 rounded-lg font-bold text-lg transition-all transform hover:scale-105",disabled:Z,children:["üé≤ ",W({vi:"L·∫Øc x√∫c x·∫Øc",en:"Roll Dice"})," üé≤"]}),U.isHost&&M.gamePhase===w.RESULTS&&s.jsx("button",{onClick:()=>U.requestStartNewRound(),className:"w-full px-6 py-3 bg-green-600 hover:bg-green-700 rounded-lg font-bold transition-colors",children:W({vi:"V√≤ng ti·∫øp theo",en:"Next Round"})})]}),Be=()=>s.jsxs("div",{className:"grid grid-cols-3 @md:gap-3 gap-1 relative",children:[me&&M.gamePhase===w.BETTING&&s.jsx("div",{className:"absolute inset-0 bg-black/50 z-10 flex items-center justify-center",children:s.jsx("p",{className:"text-md text-orange-500 pt-2 animate-bounce",children:W({vi:"ƒêang ch·ªù ch·ªß ph√≤ng quay x√∫c x·∫Øc..",en:"Waiting for host to roll dice.."})})}),B.map(e=>{const t=(e=>{const s=ge.find(s=>s[0]===e);return s?s[1]:0})(e),l=fe(e),n=(e=>fe(e).reduce((e,s)=>e+s.amount,0))(e),a=M.diceRoll?.includes(e)&&M.gamePhase===w.RESULTS,i=(()=>{const e=Object.values(M.recentRolls||{});if(0===e.length)return[];const s={[I.GOURD]:0,[I.CRAB]:0,[I.SHRIMP]:0,[I.FISH]:0,[I.CHICKEN]:0,[I.DEER]:0};return e.forEach(e=>{e.forEach(e=>{s[e]++})}),B.map(e=>({symbol:e,count:s[e]})).sort((e,s)=>s.count-e.count)})(),c=i.find(s=>s.symbol===e),o=c?.count||0,d=3*Object.keys(M.recentRolls||{}).length,x=i.findIndex(s=>s.symbol===e),h=x<2&&Object.keys(M.recentRolls||{}).length>=3,m=x>=4&&Object.keys(M.recentRolls||{}).length>=3,u=(me||U.isHost)&&ue?.currentBalance&&t>=(ue?.currentBalance||0)||l.filter(e=>{const s=M.playerBalances[e.playerId],t=M.currentBets[e.playerId];return s&&s.totalBet>=s.currentBalance&&1===t.length}).length>0;return s.jsxs("button",{onClick:()=>(e=>{if(M.gamePhase!==w.BETTING)return;if(!ue)return;ue.currentBalance-pe<y&&!ge.find(s=>s[0]===e)?L(q({vi:"B·∫°n kh√¥ng ƒë·ªß ti·ªÅn ƒë·ªÉ ƒë·∫∑t c∆∞·ª£c (t·ªëi thi·ªÉu "+r(y)+")",en:"Insufficient funds (minimum "+r(y)+")"}),{type:"error",title:q({vi:"H·∫øt ti·ªÅn!",en:"Out of money!"})}):ce(e)})(e),disabled:M.gamePhase!==w.BETTING,className:`relative p-4 rounded-xl border-2 transition-all transform active:scale-95 ${a?"bg-linear-to-br from-yellow-500 to-orange-500 border-yellow-400 animate-pulse":t>0?"bg-linear-to-br from-blue-600 to-purple-600 border-blue-400":"bg-slate-800/50 border-slate-700 hover:border-slate-500"} ${M.gamePhase===w.BETTING?"cursor-pointer":"cursor-not-allowed opacity-75"} ${u&&M.gamePhase===w.BETTING?"ring-4 ring-red-500 ring-opacity-75 shadow-lg shadow-red-500/50 animate-pulse":""}`,children:[s.jsx("div",{className:"text-4xl mb-2",children:f[e].emoji}),Object.keys(M.recentRolls||{}).length>=3&&s.jsxs("div",{className:"absolute @md:top-2 @md:left-2 top-1 left-1 flex items-center gap-1 bg-black/60 px-2 py-1 rounded-full text-xs font-bold",children:[h&&"üî•",m&&"‚ùÑÔ∏è",s.jsxs("span",{className:h?"text-orange-400":m?"text-cyan-400":"text-slate-300",children:[o,"/",d]})]}),u&&M.gamePhase===w.BETTING&&s.jsx("div",{className:"absolute @md:top-2 @md:left-2 top-1 left-1 bg-red-600 text-white px-2 py-1 rounded-full text-xs font-bold animate-bounce flex items-center gap-1",children:"üî• ALL-IN"}),s.jsx("div",{className:"text-sm font-semibold mb-2",children:W(f[e])}),t>0&&s.jsx("div",{className:"absolute @md:top-2 @md:right-2 top-1 right-1 bg-white text-black px-2 py-1 rounded-full text-xs font-bold",children:r(t)}),l.length>0&&s.jsxs("div",{className:"mt-2 space-y-1",children:[s.jsxs("div",{className:"text-xs font-bold text-yellow-400 border-t border-slate-600 pt-2",children:[W({vi:"T·ªïng: ",en:"Total: "}),r(n)]}),s.jsx("div",{className:"max-h-20 overflow-y-auto space-y-0.5",children:l.map(e=>s.jsxs("div",{className:"text-xs flex justify-between items-center gap-1",children:[s.jsxs("span",{className:"truncate flex-1 text-left",children:[e.username,e.isBot&&" ü§ñ"]}),s.jsx("span",{className:"font-semibold text-green-400",children:r(e.amount)})]},e.playerId))})]})]},e)})]});return s.jsxs(s.Fragment,{children:[s.jsx(H,{isOpen:!!ie,onClose:()=>ce(null),onConfirm:e=>{if(!ie)return;const s=ie;if(M.gamePhase!==w.BETTING)return;if(!ue)return;const t=Math.min(e,ue.currentBalance-pe);if(t<y)F(q({en:"Minimum bet is ",vi:"C∆∞·ª£c t·ªëi thi·ªÉu "})+r(y));else if(me)F(q({en:"Cancel your bet to change the symbol",vi:"B·∫•m Hu·ª∑ c∆∞·ª£c ƒë·ªÉ thay ƒë·ªïi linh v·∫≠t"}));else{if(console.log(J),J.length>=N)return void F(q({en:"Maximum 3 bets only",vi:"Ch·ªâ ƒë∆∞·ª£c ƒë·∫∑t t·ªëi ƒëa 3 linh v·∫≠t "}));const e=J.findIndex(e=>e[0]===s),l=[...J];e>=0?l[e][1]=t:l.push([s,t]),V(l),F(null)}},onClear:()=>{V(e=>e.filter(e=>e[0]!==ie)),ce(null)},currentBets:J,symbol:ie,currentBalance:ue?ue.currentBalance-pe:0,currentBet:be}),s.jsxs("div",{className:"relative w-full h-full flex flex-col @md:gap-4 gap-2 @md:p-2 pb-20! overflow-y-auto",children:[!M.isMegaRound||M.gamePhase!==w.BETTING&&M.gamePhase!==w.ROLLING&&M.gamePhase!==w.RESULTS?s.jsxs("div",{className:"bg-linear-to-r from-slate-600 to-slate-800 rounded-xl p-2 text-white",children:[s.jsxs("h2",{className:"text-2xl font-bold text-center",children:["üé≤ ",W({vi:"B·∫ßu Cua",en:"Bau Cua"})," üé≤"]}),s.jsxs("p",{className:"text-center text-sm opacity-90",children:[W({vi:`V√≤ng ${M.currentRound}`,en:`Round ${M.currentRound}`}),M.jackpotPool>0&&` ‚Ä¢ ${W({vi:"H≈©",en:"Jackpot"})}: ${r(M.jackpotPool)} üíé`]}),s.jsx("div",{className:"text-center text-xs mt-1 text-yellow-300 font-semibold bg-black/20 py-1 rounded-lg",children:0===M.minBalanceToWin?s.jsxs("span",{children:["‚ò†Ô∏è ",W({vi:"Ch·∫ø ƒë·ªô: Sinh t·ªìn",en:"Mode: Survival"})]}):s.jsxs("span",{children:["üèÜ ",W({vi:"Ch·∫ø ƒë·ªô: ƒêua top",en:"Mode: Rich"})," (",W({vi:"M·ª•c ti√™u: ",en:"Goal: "}),r(M.minBalanceToWin),")"]})})]}):s.jsxs("div",{className:"bg-linear-to-r from-yellow-600 via-orange-500 to-yellow-600 rounded-xl p-4 text-white border-4 border-yellow-400 shadow-lg shadow-yellow-500/50 animate-pulse",children:[s.jsxs("h2",{className:"text-3xl font-bold text-center flex items-center justify-center gap-2",children:[s.jsx("span",{className:"animate-bounce",children:"üåü"}),W({vi:"V√íNG N·ªî H≈®",en:"MEGA ROUND"}),s.jsx("span",{className:"animate-bounce",children:"üåü"})]}),s.jsxs("p",{className:"text-center text-lg font-bold mt-2",children:[W({vi:"H≈©: ",en:"Jackpot: "}),r(M.jackpotPool)," üíé"]}),s.jsx("p",{className:"text-center text-sm opacity-90",children:W({vi:"Ra 3 con gi·ªëng nhau = ƒÇn h·∫øt H≈©!",en:"Triple match = Win the Jackpot!"})})]}),M.gamePhase===w.WAITING&&s.jsx("div",{className:"space-y-4",children:s.jsxs("div",{className:"bg-slate-800/50 glass-blur rounded-xl @md:p-6 p-2 py-6 border border-slate-700",children:[s.jsx("p",{className:"text-xl mb-4 text-center",children:W({vi:"ƒêang ch·ªù b·∫Øt ƒë·∫ßu game...",en:"Waiting to start game..."})}),U.isHost&&s.jsxs("div",{className:"mb-6 p-4 bg-slate-700/50 rounded-xl border border-slate-600",children:[s.jsx("h3",{className:"text-lg font-semibold mb-3 text-white text-center",children:W({vi:"C√†i ƒë·∫∑t ph√≤ng",en:"Room Settings"})}),s.jsxs("div",{className:"flex flex-col gap-3",children:[s.jsxs("div",{className:"flex items-center justify-center gap-4",children:[s.jsxs("button",{onClick:()=>U.requestSetGameMode(0),className:"px-4 py-2 rounded-lg font-bold transition-all "+(0===M.minBalanceToWin?"bg-red-600 text-white ring-2 ring-red-400":"bg-slate-600 text-slate-300 hover:bg-slate-500"),children:["‚ò†Ô∏è ",W({vi:"Sinh t·ªìn",en:"Survival"})]}),s.jsxs("button",{onClick:()=>U.requestSetGameMode(1e8),className:"px-4 py-2 rounded-lg font-bold transition-all "+(M.minBalanceToWin>0?"bg-yellow-600 text-white ring-2 ring-yellow-400":"bg-slate-600 text-slate-300 hover:bg-slate-500"),children:["üèÜ ",W({vi:"Gi√†u c√≥",en:"Rich"})]})]}),M.minBalanceToWin>0&&s.jsxs("div",{className:"animate-in fade-in slide-in-from-top-2",children:[s.jsx("div",{className:"text-sm text-center text-slate-300 mb-2",children:W({vi:"M·ª•c ti√™u chi·∫øn th·∫Øng:",en:"Winning Goal:"})}),s.jsx("div",{className:"flex flex-wrap justify-center gap-1",children:T.map(e=>s.jsx("button",{onClick:()=>U.requestSetGameMode(e),className:"px-3 py-1 text-xs rounded-full border "+(M.minBalanceToWin===e?"bg-yellow-500/20 border-yellow-500 text-yellow-300":"bg-slate-800 border-slate-600 text-slate-400 hover:border-slate-400"),children:r(e)},e))})]}),s.jsx("div",{className:"text-xs text-center text-slate-400 mt-2 italic",children:0===M.minBalanceToWin?W({vi:"Ng∆∞·ªùi s·ªëng s√≥t cu·ªëi c√πng s·∫Ω chi·∫øn th·∫Øng.",en:"The last player with money wins."}):W({vi:"Ng∆∞·ªùi ƒë·∫ßu ti√™n ƒë·∫°t m·ª©c ti·ªÅn n√†y s·∫Ω chi·∫øn th·∫Øng.",en:"First player to reach this balance wins."})})]})]}),!U.isHost&&s.jsx("div",{className:"mb-6 text-center",children:s.jsx("div",{className:"inline-block px-4 py-2 rounded-lg bg-black/30 border border-slate-600",children:0===M.minBalanceToWin?s.jsxs("div",{className:"text-red-400 font-bold flex items-center gap-2",children:[s.jsx("span",{children:"‚ò†Ô∏è"})," ",W({vi:"Ch·∫ø ƒë·ªô: Sinh t·ªìn",en:"Mode: Survival"})]}):s.jsxs("div",{className:"text-yellow-400 font-bold flex items-center gap-2",children:[s.jsx("span",{children:"üèÜ"})," ",W({vi:"Ch·∫ø ƒë·ªô: ƒêua top",en:"Rich Mode"}),s.jsxs("span",{className:"text-white",children:["(",r(M.minBalanceToWin),")"]})]})})}),s.jsxs("div",{className:"mb-6",children:[s.jsx("h3",{className:"text-lg font-semibold mb-3 text-slate-300",children:W({vi:`Ng∆∞·ªùi ch∆°i (${Object.keys(M.playerBalances).length}/${D?.maxPlayers})`,en:`Players (${Object.keys(M.playerBalances).length}/${D?.maxPlayers})`})}),s.jsx("div",{className:"flex flex-wrap gap-2 justify-center",children:Object.values(M.playerBalances).map(e=>s.jsxs("div",{className:"bg-slate-700/50 rounded-lg p-3 flex items-center justify-between w-[150px]",children:[s.jsxs("div",{className:"flex-1 text-left",children:[s.jsx("p",{className:"font-semibold text-sm truncate",children:e.username}),s.jsxs("p",{className:"text-xs text-slate-400",children:[r(e.currentBalance),"üí∞"]})]}),e.isBot&&s.jsx("span",{className:"text-lg ml-2",children:"ü§ñ"}),U.isHost&&e.isBot&&s.jsx("button",{onClick:()=>U.requestRemoveBot(e.playerId),className:"p-2 text-red-400 hover:bg-slate-600 rounded-lg hover:cursor-pointer",children:s.jsx(m,{className:"w-4 h-4"})})]},e.playerId))})]}),U.isHost&&s.jsxs("div",{className:"flex gap-2 justify-center flex-wrap",children:[s.jsxs("button",{onClick:()=>U.requestAddBot(),className:"flex items-center gap-1 px-4 py-2 bg-slate-600 hover:bg-slate-500 rounded-lg transition-colors disabled:bg-slate-800",disabled:Object.keys(M.playerBalances).length>=20,children:[W({vi:"Th√™m Bot",en:"Add Bot"}),s.jsx(u,{className:"w-4 h-4"})]}),s.jsxs("button",{onClick:()=>U.requestStartNewRound(),className:"flex items-center gap-1 px-4 py-2 bg-green-600 hover:bg-green-500 rounded-lg transition-colors disabled:bg-slate-800",disabled:0===Object.keys(M.playerBalances).length,children:[W({vi:"B·∫Øt ƒë·∫ßu",en:"Start Game"}),s.jsx(g,{className:"w-4 h-4"})]})]})]})}),M.gamePhase!==w.WAITING&&s.jsxs("div",{className:"flex flex-col @md:grid @md:grid-cols-[1fr_300px] gap-4",children:[s.jsxs("div",{className:"flex flex-col gap-4",children:[ue&&s.jsxs("div",{className:"bg-slate-800/50 glass-blur rounded-xl p-4 border border-slate-700",children:[s.jsxs("div",{className:"flex justify-between items-center mb-3",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-slate-400",children:W({vi:"S·ªë d∆∞",en:"Your Balance"})}),s.jsxs("p",{className:"text-2xl font-bold text-green-400 flex items-center gap-0",children:[r(ue.currentBalance),ue.balanceHistory.length>1&&s.jsxs("span",{className:"ml-2 text-sm font-bold animate-pulse "+(je>=0?"text-green-300":"text-red-400"),children:[je>=0?"+":"",r(je)]})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-sm text-slate-400",children:W({vi:"T·ªïng c∆∞·ª£c",en:"Total Bet"})}),s.jsx("p",{className:"text-xl font-semibold text-orange-400",children:r(pe)})]})]}),M.gamePhase===w.BETTING&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex gap-2",children:[!me&&s.jsxs("button",{onClick:()=>{F(null),me||V([]),U.requestClearBets()},className:"flex-1 px-4 py-2 bg-slate-700 hover:bg-slate-600 rounded-lg transition-colors disabled:bg-slate-800 disabled:cursor-not-allowed",disabled:0===ge.length,children:[W({vi:"X√≥a c∆∞·ª£c",en:"Clear Bets"})," ",ge.length||""]}),!U.isHost&&s.jsx("button",{onClick:()=>{!me&&J.length>0&&U.requestSyncBets(J),F(null),U.requestToggleReady(),de(!me)},className:"flex-1 px-4 py-2 rounded-lg transition-colors disabled:bg-slate-800 disabled:cursor-not-allowed "+(me?"bg-red-700 hover:bg-red-800":"bg-blue-700 hover:bg-blue-800"),disabled:0===ge.length,children:me?W({vi:"Hu·ª∑ s·∫µn s√†ng",en:"Cancel Ready"}):ve<y&&0===ge.length?W({vi:"H·∫øt ti·ªÅn",en:"Out of money"}):W({vi:"S·∫µn s√†ng",en:"Ready"})})]}),0===ge.length?ve<y?s.jsx("p",{className:"text-sm text-red-500 pt-2 animate-bounce",children:W({vi:"B·∫°n kh√¥ng ƒë·ªß ti·ªÅn c∆∞·ª£c",en:"Insufficient funds"})}):s.jsx("p",{className:"text-sm text-orange-500 pt-2 animate-bounce",children:W({vi:"Vui l√≤ng ch·ªçn linh v·∫≠t",en:"Please select a symbol"})}):me||U.isHost?null:s.jsx("p",{className:"text-sm text-orange-500 pt-2 animate-bounce",children:W({vi:"B·∫•m S·∫µn s√†ng khi ƒë·∫∑t c∆∞·ª£c xong",en:"Press Ready when you finish betting"})}),_&&s.jsx("p",{className:"text-sm text-red-500 pt-2 animate-bounce",children:_})]})]}),Be(),ue&&M.playerPowerUps[d]&&s.jsxs("div",{className:"flex flex-col gap-2 bg-slate-800/50 glass-blur rounded-xl @md:p-4 p-2 border border-slate-700",children:[s.jsx("h3",{className:"font-semibold mb-3 text-slate-300",children:W({vi:"K·ªπ nƒÉng",en:"Power-ups"})}),s.jsx("div",{className:"flex flex-wrap gap-2 justify-center",children:Object.keys(M.playerPowerUps[d]).map(e=>{const t=Number(e),l=M.playerPowerUps[d][t],n=Y===t,a=M.activePowerUps[d]===t,r=0===l.cooldown&&!a;return s.jsx("button",{onClick:()=>X(n?null:t),className:"relative p-3 rounded-lg border-2 transition-all cursor-pointer "+(a?"bg-linear-to-br from-green-600 to-emerald-600 border-green-400":n?"bg-linear-to-br from-blue-600 to-purple-600 border-blue-400 ring-2 ring-blue-300":r?"bg-slate-700 border-slate-600 hover:border-blue-400 hover:bg-slate-600":"bg-slate-800 border-slate-700 opacity-50"),children:s.jsxs("div",{className:"flex flex-col items-center gap-1",children:[(i=t,{[S.DOUBLE_DOWN]:s.jsx(v,{className:"w-5 h-5"}),[S.INSURANCE]:s.jsx(j,{className:"w-5 h-5"}),[S.REVEAL_ONE]:s.jsx(p,{className:"w-5 h-5"}),[S.LUCKY_STAR]:s.jsx(b,{className:"w-5 h-5"})}[i]),s.jsx("div",{className:"text-sm font-semibold truncate w-full text-center",children:W(R[t].name)}),!r&&!n&&!a&&s.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/70 rounded-lg",children:s.jsx("span",{className:"text-2xl font-bold text-white",children:l.cooldown})}),a&&s.jsxs("div",{className:"text-xs text-green-300 font-bold",children:["‚úì ",W({vi:"ƒêang d√πng",en:"Active"})]})]})},t);var i})}),Y&&s.jsxs("div",{className:"p-3 bg-purple-600/20 border border-purple-500 rounded-lg",children:[s.jsx("p",{className:"text-sm text-purple-300 font-semibold mb-1",children:W(R[Y].name)}),s.jsx("p",{className:"text-sm text-slate-300",children:W(R[Y].description)})]}),Y&&!M.activePowerUps[d]&&M.gamePhase===w.BETTING&&s.jsx("button",{onClick:()=>{U.requestActivatePowerUp(Y),he(Y),X(null)},disabled:Q&&Q.cooldown>0,className:"w-full px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-slate-800 disabled:cursor-not-allowed rounded-lg font-bold text-white transition-colors",children:Q&&Q.cooldown>0?q({en:`ü™´ Wait for cooldown (${Q.cooldown} rounds left)`,vi:`ü™´ ƒêang h·ªìi chi√™u (c√≤n ${Q.cooldown} v√≤ng)`}):q({en:"‚ö° Use Power-up",vi:"‚ö° S·ª≠ d·ª•ng k·ªπ nƒÉng"})}),M.activePowerUps[d]&&M.playerPowerUps[d]&&R[M.activePowerUps[d]]?.timing===C.POST_ROLL&&s.jsx("button",{onClick:()=>{U.requestDeactivatePowerUp(),he(null)},className:"w-full px-4 py-2 bg-red-600 hover:bg-red-700 rounded-lg transition-colors",children:W({vi:"Hu·ª∑ k·ªπ nƒÉng",en:"Cancel Power-up"})}),M.powerUpPredictions[d]&&s.jsxs("div",{className:"p-3 bg-green-600/20 border border-green-500 rounded-lg",children:[s.jsxs("p",{className:"text-xs text-green-300 font-semibold mb-2",children:["üîÆ"," ",W({vi:"D·ª± ƒëo√°n c·ªßa M·∫Øt Th·∫ßn",en:"Mystic Prediction"})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"text-3xl flex items-center",children:[s.jsx("span",{className:"mr-2 text-xl",children:W(f[M.powerUpPredictions[d]?.symbol])}),f[M.powerUpPredictions[d]?.symbol]?.emoji]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-xs text-slate-400",children:W({vi:"ƒê·ªô ch√≠nh x√°c",en:"Accuracy"})}),s.jsxs("p",{className:"text-lg font-bold text-purple-300",children:[Math.round(100*M.powerUpPredictions[d]?.accuracy),"%"]})]})]})]}),M.playerPowerUps[d]?.[S.LUCKY_STAR]?.lastMultiplier&&M.gamePhase===w.RESULTS&&M.playerPowerUps[d][S.LUCKY_STAR].lastUsedRound===M.currentRound&&s.jsxs("div",{className:"p-3 bg-yellow-600/20 border border-yellow-500 rounded-lg mt-2",children:[s.jsxs("p",{className:"text-xs text-yellow-300 font-semibold mb-2",children:["üåü"," ",W({vi:"K·∫øt qu·∫£ Sao May M·∫Øn",en:"Lucky Star Result"})]}),s.jsx("div",{className:"text-center",children:s.jsxs("p",{className:"text-2xl font-bold text-yellow-300",children:["x",M.playerPowerUps[d][S.LUCKY_STAR].lastMultiplier?.toFixed(1)]})})]})]})]}),s.jsxs("div",{className:"flex flex-col gap-4",children:[we(),c.createPortal(s.jsx("div",{className:`fixed top-0 left-0 right-0 bottom-0 bg-slate-900/90 glass-blur rounded-xl p-2 z-50 ${Z?"flex":"hidden"} md:hidden items-center justify-center`,children:s.jsx("div",{className:"flex items-center justify-between",children:we()})}),document.getElementById("root")),s.jsxs("div",{className:"bg-slate-800/50 glass-blur rounded-xl p-4 border border-slate-700",children:[s.jsx("h3",{className:"text-lg font-semibold mb-3",children:W({vi:"B·∫£ng x·∫øp h·∫°ng",en:"Leaderboard"})}),s.jsx("div",{className:"space-y-2 max-h-120 overflow-y-auto",children:Object.values(M.playerBalances).sort((e,s)=>s.currentBalance-e.currentBalance).map((e,t)=>{const l=e.balanceHistory.length>1?e.currentBalance-e.balanceHistory[e.balanceHistory.length-2]:0;return s.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg "+(e.playerId===d?"bg-blue-600/30 border border-blue-500":"bg-slate-700/50"),children:[s.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0 text-left",children:[s.jsxs("span",{className:"text-xl font-bold text-slate-400 shrink-0",children:["#",t+1]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("p",{className:"font-semibold wrap-break-word",children:[e.username,e.isBot&&" ü§ñ"]}),s.jsxs("p",{className:"text-xs text-slate-400 truncate",children:[W({vi:"C∆∞·ª£c: ",en:"Bet: "}),r(e.totalBet),M.playersReady[e.playerId]&&" ‚úì"]})]})]}),s.jsxs("div",{className:"flex items-center gap-3 ",children:[M.currentRound>0&&ye(e.balanceHistory),s.jsxs("div",{className:"flex flex-col items-end gap-0",children:[s.jsx("p",{className:"text-lg font-bold text-green-400",children:r(e.currentBalance)}),s.jsxs("span",{className:"text-xs "+(l>=0?"text-green-400":"text-red-400"),children:[l>0?"+":"",r(l)]})]})]})]},e.playerId)})})]})]})]}),M.gamePhase===w.ENDED&&(z?c.createPortal(s.jsx("div",{className:"fixed inset-0 bg-black/80 glass-blur z-50 flex items-center justify-center p-4 animate-in fade-in zoom-in duration-300",children:s.jsx("div",{className:"bg-slate-900 border-2 border-yellow-500 rounded-2xl max-w-lg w-full p-8 shadow-2xl relative overflow-hidden",children:s.jsxs("div",{className:"text-center space-y-6 relative z-10",children:[M.winners&&M.winners.length>0?s.jsxs(s.Fragment,{children:[s.jsx("h2",{className:"text-4xl font-bold text-yellow-500 animate-bounce",children:M.winners.length>1?W({vi:"CHI·∫æN TH·∫ÆNG",en:"WINNERS"}):W({vi:"CHI·∫æN TH·∫ÆNG",en:"WINNER"})}),s.jsx("div",{className:"flex flex-col gap-4 items-center justify-center py-4",children:M.winners.map(e=>{const t=M.playerBalances[e];return t?s.jsxs("div",{className:"bg-slate-800/80 p-4 rounded-xl border border-yellow-500/50 min-w-[200px] flex flex-col items-center gap-2 transform hover:scale-105 transition-transform",children:[s.jsx("div",{className:"text-4xl",children:"üëë"}),s.jsx("div",{className:"text-2xl font-bold text-white",children:t.username}),s.jsx("div",{className:"text-yellow-400 font-bold text-xl",children:r(t.currentBalance)})]},e):null})})]}):s.jsxs(s.Fragment,{children:[s.jsx("h2",{className:"text-4xl font-bold text-slate-400",children:W({vi:"K·∫æT TH√öC",en:"GAME OVER"})}),s.jsx("p",{className:"text-slate-300 text-lg",children:W({vi:"Kh√¥ng c√≥ ng∆∞·ªùi chi·∫øn th·∫Øng",en:"No winner this time"})}),s.jsx("p",{className:"text-slate-500 text-sm italic",children:W({vi:"T·∫•t c·∫£ ng∆∞·ªùi ch∆°i ƒë·ªÅu ƒë√£ h·∫øt ti·ªÅn",en:"All players ran out of money"})})]}),U.isHost&&s.jsx("div",{className:"flex justify-center pt-4",children:s.jsxs("button",{onClick:()=>U.requestResetGame(),className:"px-8 py-3 bg-green-600 hover:bg-green-500 text-white rounded-xl font-bold text-xl shadow-lg hover:shadow-green-500/50 transition-all transform hover:-translate-y-1",children:[W({vi:"Ch∆°i l·∫°i",en:"Play Again"})," üîÑ"]})}),!U.isHost&&s.jsx("p",{className:"text-slate-500 animate-pulse",children:W({vi:"ƒêang ch·ªù ch·ªß ph√≤ng ch∆°i l·∫°i...",en:"Waiting for host to reset..."})}),s.jsx("button",{onClick:()=>K(!1),className:"absolute top-4 right-4 p-2 hover:bg-white/10 rounded-full transition-colors text-slate-400 hover:text-white",children:s.jsx(o,{className:"w-6 h-6"})})]})})}),document.body):null),U.isHost&&M.gamePhase!==w.WAITING&&s.jsx("div",{className:"flex gap-2 w-full items-center justify-center",children:s.jsxs("button",{onClick:async()=>{await A(q({en:"Are you sure you want to reset the game?",vi:"B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën ch∆°i l·∫°i kh√¥ng?"}),q({en:"Reset Game",vi:"Ch∆°i l·∫°i"}))&&U.requestResetGame()},className:"rounded-lg text-xs bg-slate-700 hover:bg-slate-600 px-4 py-2 flex items-center gap-2",children:[s.jsx(x,{className:"w-4 h-4"}),W({en:"Reset Game",vi:"Ch∆°i l·∫°i"})]})}),s.jsx("button",{onClick:()=>re(!0),className:"fixed bottom-4 right-4 p-3 bg-slate-700 hover:bg-slate-600 rounded-full text-yellow-500 transition-colors z-50 shadow-lg border border-slate-500",title:q({en:"Rules",vi:"Lu·∫≠t ch∆°i"}),children:s.jsx(h,{size:24})}),ae&&c.createPortal(s.jsx("div",{className:"fixed inset-0 bg-black/80 glass-blur z-100 flex items-center justify-center p-4",children:s.jsxs("div",{className:"bg-slate-900 border border-slate-700 rounded-xl max-w-lg w-full shadow-2xl relative",children:[s.jsxs("div",{className:"flex justify-between p-4 pr-2",children:[s.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[s.jsx(h,{className:"w-6 h-6 text-yellow-500"}),W({en:"Game Rules",vi:"Lu·∫≠t Ch∆°i: B·∫ßu cua"})]}),s.jsx("button",{onClick:()=>re(!1),className:"p-2 hover:bg-white/10 rounded-full transition-colors text-slate-400 hover:text-white",children:s.jsx(o,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"p-4 space-y-4 text-slate-300 leading-relaxed max-h-[80vh] overflow-y-auto",children:[s.jsxs("section",{children:[s.jsx("h3",{className:"text-lg font-bold text-yellow-400",children:W({en:"Objective",vi:"M·ª•c ti√™u"})}),s.jsx("p",{children:W({en:"Place bets on the symbols you think will appear on the dice.",vi:"ƒê·∫∑t c∆∞·ª£c v√†o c√°c linh v·∫≠t b·∫°n nghƒ© s·∫Ω xu·∫•t hi·ªán tr√™n x√∫c x·∫Øc."})}),s.jsx("p",{children:W({vi:"2 ch·∫ø ƒë·ªô ch∆°i: ",en:"2 game modes: "})}),s.jsxs("ul",{className:"list-disc pl-4",children:[s.jsxs("li",{children:["üíÄ"," ",W({vi:"Sinh t·ªìn: Ai s·ªëng s√≥t (c√≤n ti·ªÅn) cu·ªëi c√πng s·∫Ω th·∫Øng.",en:"Survival: Last player standing (with money) wins."})]}),s.jsxs("li",{children:["üí∞"," ",W({vi:"Gi√†u c√≥: Ai ki·∫øm ƒë∆∞·ª£c ti·ªÅn ƒë·∫°t m·ª•c ti√™u tr∆∞·ªõc s·∫Ω th·∫Øng.",en:"Rich: The first player to reach the target amount wins."})]})]})]}),s.jsxs("section",{children:[s.jsx("h3",{className:"text-lg font-bold text-yellow-400 mt-4",children:W({en:"Rules",vi:"Quy T·∫Øc"})}),s.jsxs("ul",{className:"list-disc pl-4",children:[s.jsx("li",{children:W({en:"Max 3 bets each round.",vi:"ƒê·∫∑t c∆∞·ª£c nhi·ªÅu nh·∫•t 3 linh v·∫≠t m·ªói v√≤ng."})}),s.jsx("li",{children:W({en:"Press Ready and wait host to roll dices.",vi:"B·∫•m s·∫µn s√†ng v√† ƒë·ª£i ch·ªß ph√≤ng quay x√∫c x·∫Øc."})}),s.jsxs("li",{children:["‚úÖ"," ",W({en:"Each symbol matches: Win 2x your bet.",vi:"C∆∞·ª£c ƒë√∫ng linh v·∫≠t: Nh·∫≠n x2 ti·ªÅn c∆∞·ª£c c·ªßa linh v·∫≠t ƒë√≥."})]}),s.jsxs("li",{children:["‚ùå"," ",W({en:"Each symbol not matches: Lose bet on that symbol.",vi:"C∆∞·ª£c sai linh v·∫≠t: M·∫•t ti·ªÅn c∆∞·ª£c."})]})]})]}),s.jsxs("section",{children:[s.jsx("h3",{className:"text-lg font-bold text-yellow-400 mt-4",children:W({en:"Power-ups",vi:"K·ªπ NƒÉng"})}),s.jsx("p",{className:"mb-2",children:W({en:"Can use 1 power-up per round.",vi:"ƒê∆∞·ª£c d√πng 1 k·ªπ nƒÉng m·ªói v√≤ng."})}),s.jsx("ul",{className:"list-disc pl-4",children:Object.keys(R).map(e=>{const t=Number(e);return s.jsxs("li",{children:[s.jsxs("strong",{children:[W(R[t].emoji)," ",W(R[t].name),":"]})," ",W(R[t].description)]},e)})})]}),s.jsxs("section",{children:[s.jsxs("h3",{className:"text-lg font-bold text-yellow-400 mt-4",children:[W({en:"Jackpot",vi:"N·ªï H≈©"})," üíé"]}),s.jsxs("ul",{className:"list-disc pl-4",children:[s.jsx("li",{children:W({en:`Jackpot is accumulated from ${100*k}% of all bets each round.`,vi:`H≈© ƒë∆∞·ª£c t√≠ch l≈©y t·ª´ ${100*k}% t·ªïng ti·ªÅn c∆∞·ª£c m·ªói v√≤ng.`})}),s.jsx("li",{children:W({en:`After every ${P} rounds, there will be a Jackpot round.`,vi:`Sau m·ªói ${P} v√≤ng, c√≥ 1 v√≤ng N·ªï H≈©.`})}),s.jsx("li",{children:W({en:"When 3 same symbols appear, the jackpot is triggered, split equally among those who has correct bet.",vi:"Khi 3 linh v·∫≠t gi·ªëng nhau xu·∫•t hi·ªán, h≈© s·∫Ω n·ªï, chia ƒë·ªÅu cho ai c∆∞·ª£c ƒë√∫ng."})})]})]})]})]})}),document.body)]})]})}export{U as default};
