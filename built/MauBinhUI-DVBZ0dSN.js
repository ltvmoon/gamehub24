import{u as e,b as s,S as a,j as t,m as l,f as n}from"./index-7ewwbQld.js";import{b as r,c as i,aS as d,bu as o,aR as c,j as x,am as m,T as p,ab as h,aM as u,X as g,bC as b,U as f,aI as j,az as N,aA as v,aC as y,b6 as w}from"./react-vendor-BLBa7-IT.js";import"./BaseGame-D8z93T-B.js";import{I as k,G as R,b as C,c as S,d as A,H as I,e as P,f as T,a as B,S as M}from"./types-BcXWPzzM.js";import{b as O,c as E,d as F,S as _}from"./types-qIwhz3td.js";import{u as H}from"./useGameState-DJPJV8mx.js";import"./socket-DRbsQkF5.js";import"./zustand-BEg5S8SY.js";const L={BACK:"back",MIDDLE:"middle",FRONT:"front"};function D({game:n}){const f=n,[j]=H(f),{ti:N,ts:v}=e(),{confirm:y}=s(),[w,O]=r.useState(!1),[E,F]=r.useState(null),[_,D]=r.useState(L.BACK),[V,Y]=r.useState(!1),[J,Q]=r.useState([]),[Z,ee]=r.useState([]),[se,ae]=r.useState([]),te=f.getMyPlayerIndex(),le=te>=0?j.players[te]:null,ne=f.isHost,re=r.useMemo(()=>{if(!le)return[];const e=new Set([...J,...Z,...se]);return le.hand.filter(s=>!e.has(s))},[le,J,Z,se]),ie=r.useMemo(()=>le&&13===le.hand.length?f.checkInstantWinRaw(le.hand):k.NONE,[le,f]),de=r.useMemo(()=>3===J.length?f.evaluate3CardHand(J):null,[J,f]),oe=r.useMemo(()=>5===Z.length?f.evaluate5CardHand(Z):null,[Z,f]),ce=r.useMemo(()=>5===se.length?f.evaluate5CardHand(se):null,[se,f]),xe=3===J.length&&5===Z.length&&5===se.length,me=r.useMemo(()=>!!xe&&f.isValidArrangement(J,Z,se),[xe,J,Z,se,f]);"arranging"===r.useMemo(()=>j.gamePhase,[j.gamePhase])&&0===J.length&&0===Z.length&&0===se.length&&le&&le.isReady;const pe=r.useCallback(e=>{"arranging"===j.gamePhase&&le&&!le.isReady&&(J.includes(e)?Q(J.filter(s=>s!==e)):Z.includes(e)?ee(Z.filter(s=>s!==e)):se.includes(e)?ae(se.filter(s=>s!==e)):(_===L.BACK&&se.length<5?(ae([...se,e]),se.length+1===5&&D(L.MIDDLE)):_===L.MIDDLE&&Z.length<5?(ee([...Z,e]),Z.length+1===5&&D(L.FRONT)):_===L.FRONT&&J.length<3?Q([...J,e]):se.length<5?ae([...se,e]):Z.length<5?ee([...Z,e]):J.length<3&&Q([...J,e]),Y(!1),a.play("click")))},[j.gamePhase,le,_,J,Z,se]),[he,ue]=r.useState(!1),ge=r.useMemo(()=>le&&0!==le.hand.length?f.generateSuggestions(le.hand):[],[le?.hand,f]),be=r.useCallback(e=>{Q(e.front),ee(e.middle),ae(e.back),Y(!0),ue(!1),a.play("click")},[]),fe=r.useCallback(()=>{Q([]),ee([]),ae([]),D(L.BACK),Y(!1)},[]),je=r.useCallback(()=>{f.requestDeclareInstantWin(),a.play("click")},[f]),Ne=r.useCallback(()=>{if("arranging"!==j.gamePhase||!le||le.isReady)return;let e=J,s=Z,t=se,l=V;if(!xe&&ge.length>0){const a=ge[0];e=a.front,s=a.middle,t=a.back,l=!0}f.requestArrangeCards(e,s,t,l),a.play("click")},[j.gamePhase,le,J,Z,se,V,xe,ge,f]);r.useEffect(()=>{if("arranging"!==j.gamePhase||!le||le.isReady)return;const e=setInterval(()=>{j.timerEndsAt-Date.now()<=500&&(clearInterval(e),Ne())},500);return()=>clearInterval(e)},[j.gamePhase,j.timerEndsAt,le?.isReady,Ne]);const ve=r.useMemo(()=>{const e=[],s=j.players.length;for(let a=0;a<s;a++){const t=te>=0?(te+a)%s:a;e.push({player:j.players[t],index:t})}return e},[j.players,te]),ye=r.useMemo(()=>"ended"!==j.gamePhase?[]:f.computePostGameAnalysis(j.players,j.players.map((e,s)=>s)),[j.players,j.gamePhase,f]);return t.jsxs("div",{className:"flex flex-col w-full h-full bg-slate-900 text-white relative overflow-hidden select-none mb-16!",children:[t.jsxs("div",{className:"flex flex-col gap-2",children:[t.jsx("div",{className:"flex justify-center gap-2 px-2 py-2 pt-6",children:ve.slice(1).map(e=>t.jsx($,{player:e.player,isSelf:!1,isHost:ne,gamePhase:j.gamePhase,ti:N,onAddBot:()=>f.requestAddBot(e.index),onRemove:()=>f.requestRemovePlayer(e.index),onShowAnalytics:(()=>{const s=ye.find(s=>s.playerIndex===e.index);if(s&&s.optimalScore>s.actualScore)return()=>{const s=ye.findIndex(s=>s.playerIndex===e.index);-1!==s&&F(s)}})(),game:f},e.index))}),j.players.some(e=>null!==e.id&&0!==e.score)&&t.jsx("div",{className:"flex justify-center gap-3 px-2 py-1",children:j.players.filter(e=>null!==e.id).map((e,s)=>t.jsxs("div",{className:"flex items-center gap-1 text-xs",children:[t.jsxs("span",{className:"text-slate-400 truncate max-w-[60px]",children:[e.username,":"]}),t.jsxs("span",{className:e.score>0?"text-green-400 font-bold":e.score<0?"text-red-400 font-bold":"text-slate-500",children:[e.score>0?"+":"",e.score]})]},s))}),t.jsxs("div",{className:"flex flex-col items-center justify-center gap-2 p-2 border border-slate-700 rounded-xl bg-slate-800/50 min-h-40",children:["arranging"===j.gamePhase&&t.jsx(W,{timerEndsAt:j.timerEndsAt,isReady:!!le?.isReady}),t.jsxs("div",{className:"bg-black/40 px-3 py-1 rounded-full border border-slate-600 text-xs text-slate-300",children:[N(R[j.gamePhase]),j.roundNumber>0&&t.jsx("span",{className:"ml-1.5 text-slate-500",children:N({en:`Round ${j.roundNumber}`,vi:`V√°n ${j.roundNumber}`})})]}),"ended"===j.gamePhase&&(j.roundResults.length>0||j.roundEvents.length>0)&&t.jsxs("div",{className:"bg-slate-900/80 px-3 py-2 rounded-xl border border-yellow-500/30 w-full max-w-sm",children:[t.jsxs("h3",{className:"text-yellow-400 font-bold text-md mb-2 flex items-center justify-center gap-1 border-b border-yellow-500/20 pb-1",children:[t.jsx(d,{className:"w-4 h-4"}),N({en:"Results",vi:"K·∫øt qu·∫£"})]}),t.jsxs("div",{className:"space-y-1.5 overflow-y-auto custom-scrollbar pr-1",children:[j.roundResults.map((e,s)=>{const a=j.players[e.p1Index],l=j.players[e.p2Index];return t.jsxs("div",{className:"flex flex-col gap-1 bg-slate-800/40 p-2 rounded-lg border border-slate-700/50",children:[t.jsxs("div",{className:"flex items-center justify-between text-xs",children:[t.jsx("div",{className:"flex flex-col",children:t.jsxs("span",{className:(e.p1Total>0?"text-green-400 font-bold":e.p1Total<0?"text-red-400":"text-slate-400")+" flex items-center gap-1",children:[a.username,t.jsxs("span",{className:"text-[10px] opacity-70",children:["(",e.p1Total>0?"+":"",e.p1Total,")"]})]})}),t.jsx("span",{className:"text-slate-600 font-mono text-[10px]",children:"VS"}),t.jsx("div",{className:"flex flex-col items-end",children:t.jsxs("span",{className:(e.p2Total>0?"text-green-400 font-bold":e.p2Total<0?"text-red-400":"text-slate-400")+" flex items-center gap-1",children:[t.jsxs("span",{className:"text-[10px] opacity-70",children:["(",e.p2Total>0?"+":"",e.p2Total,")"]}),l.username]})})]}),t.jsxs("div",{className:"flex flex-wrap gap-1 justify-center",children:[e.p1InstantWin!==k.NONE&&t.jsx("div",{className:"bg-amber-500/20 text-amber-400 px-1.5 py-0.5 rounded text-[9px] font-bold border border-amber-500/30",children:N(C[e.p1InstantWin])}),e.p1SpecialBonuses.map(e=>t.jsx("div",{className:"bg-indigo-500/20 text-indigo-300 px-1.5 py-0.5 rounded text-[9px] font-bold border border-indigo-500/30",children:N(S[e])},e)),1===e.scoopResult&&t.jsxs("div",{className:"bg-red-500/20 text-red-400 px-1.5 py-0.5 rounded text-[9px] font-bold border border-red-500/30 flex items-center gap-0.5",children:["üî• ",N({en:"Scoop",vi:"S·∫≠p 3 chi"})]}),(e.p1SpecialBonuses.length>0||e.p1InstantWin!==k.NONE||1===e.scoopResult)&&(e.p2SpecialBonuses.length>0||e.p2InstantWin!==k.NONE||-1===e.scoopResult)&&t.jsx("div",{className:"w-px h-3 bg-slate-700 mx-0.5 self-center"}),e.p2InstantWin!==k.NONE&&t.jsx("div",{className:"bg-amber-500/20 text-amber-400 px-1.5 py-0.5 rounded text-[9px] font-bold border border-amber-500/30",children:N(C[e.p2InstantWin])}),e.p2SpecialBonuses.map(e=>t.jsx("div",{className:"bg-indigo-500/20 text-indigo-300 px-1.5 py-0.5 rounded text-[9px] font-bold border border-indigo-500/30",children:N(S[e])},e)),-1===e.scoopResult&&t.jsxs("div",{className:"bg-red-500/20 text-red-400 px-1.5 py-0.5 rounded text-[9px] font-bold border border-red-500/30 flex items-center gap-0.5",children:["üî• ",N({en:"Scoop",vi:"S·∫≠p 3 chi"})]})]})]},`res-${s}`)}),j.roundEvents.map((e,s)=>{const a=j.players[e.playerIndex];return t.jsxs("div",{className:"flex items-center justify-between text-[11px] bg-indigo-900/30 px-2 py-1.5 rounded-lg border border-indigo-500/30 text-indigo-200",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(o,{className:"w-3 h-3 text-yellow-400"}),t.jsx("span",{className:"font-bold",children:a.username}),t.jsx("span",{children:"SCOOP_ALL"===e.type?N({en:"Scooped All!",vi:"B·∫Øt s·∫≠p l√†ng!"}):N({en:"Manual Bonus",vi:"Th∆∞·ªüng th·ªß c√¥ng"})})]}),t.jsxs("span",{className:"font-bold text-green-400",children:["+",e.points]})]},`evt-${s}`)})]})]})]}),ve.length>0&&t.jsx("div",{className:"flex justify-center px-2 py-1",children:t.jsx($,{player:ve[0].player,isSelf:!0,isHost:ne,gamePhase:j.gamePhase,ti:N,onAddBot:()=>f.requestAddBot(ve[0].index),onRemove:()=>f.requestRemovePlayer(ve[0].index),onShowAnalytics:(()=>{const e=ye.find(e=>e.playerIndex===ve[0].index);if(e&&e.optimalScore>e.actualScore)return()=>{const e=ye.findIndex(e=>e.playerIndex===ve[0].index);-1!==e&&F(e)}})(),game:f})})]}),t.jsxs("div",{className:"w-full shrink-0 bg-slate-900/90 glass-blur z-20",children:["arranging"===j.gamePhase&&le&&!le.isReady&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"px-2 py-3 space-y-3",children:[t.jsx("div",{className:"grid grid-cols-3 gap-1",children:[{title:v({en:"BACK (5)",vi:"CHI ƒê·∫¶U (5)"}),key:L.BACK,cards:se,eval:ce,size:5},{title:v({en:"MIDDLE (5)",vi:"CHI GI·ªÆA (5)"}),key:L.MIDDLE,cards:Z,eval:oe,size:5},{title:v({en:"FRONT (3)",vi:"CHI CU·ªêI (3)"}),key:L.FRONT,cards:J,eval:de,size:3}].map(e=>t.jsxs("div",{onClick:()=>D(e.key),className:"p-2 px-0 rounded-lg border-2 cursor-pointer transition-all "+(_===e.key?"border-red-500 bg-red-500/10":"border-slate-700 bg-slate-800/50"),children:[t.jsxs("div",{className:"text-[10px] font-bold text-center mb-2",children:[t.jsx("span",{children:e.title}),t.jsx("br",{}),e.eval&&t.jsx("span",{className:`mt-2 px-1.5 py-0.5 rounded-full border ${q(e.eval.rank)}`,children:N(A[e.eval.rank])})]}),t.jsxs("div",{className:"flex justify-center gap-0.5 min-h-[40px] flex-wrap",children:[e.cards.map(e=>t.jsx(l.div,{layoutId:`card-${e}`,layout:!0,children:t.jsx(G,{card:e,onClick:()=>pe(e),highlight:!0})},e)),Array(e.size-e.cards.length).fill(null).map((e,s)=>t.jsx("div",{className:"w-8 h-11 border border-dashed border-slate-600 rounded bg-slate-800/30"},`e-${s}`))]})]},e.key))}),t.jsx("div",{className:"flex flex-wrap justify-center gap-1 px-1",children:re.map(e=>t.jsx(l.div,{layoutId:`card-${e}`,layout:!0,children:t.jsx(z,{card:e,size:"md",onClick:()=>pe(e),className:"cursor-pointer hover:scale-110 hover:-translate-y-1 transition-all"})},e))}),t.jsxs("div",{className:"flex items-center justify-center gap-2 flex-wrap",children:[ie!==k.NONE&&t.jsxs("button",{onClick:je,className:"px-4 py-2.5 bg-linear-to-r from-amber-600 to-yellow-500 hover:from-amber-500 hover:to-yellow-400 rounded-xl font-bold text-sm flex items-center gap-2 shadow-lg shadow-amber-900/30 animate-pulse",children:[t.jsx(o,{className:"w-4 h-4"}),N(C[ie])]}),t.jsxs("button",{onClick:()=>ue(!he),className:"px-4 py-2.5 rounded-xl font-bold text-sm flex items-center gap-2 transition-all "+(he?"bg-purple-500 ring-2 ring-purple-300":"bg-purple-700 hover:bg-purple-600"),children:[t.jsx(c,{className:"w-4 h-4"}),N({en:"Suggest",vi:"G·ª£i √Ω"})]}),t.jsxs("button",{onClick:fe,className:"px-4 py-2.5 bg-slate-700 hover:bg-slate-600 rounded-xl font-bold text-sm flex items-center gap-2",children:[t.jsx(x,{className:"w-4 h-4"}),N({en:"Clear",vi:"Xo√°"})]}),t.jsxs("button",{onClick:async()=>{if(xe){if(!me){if(!(await y(v({en:"Your arrangement is invalid (Fouled). You might lose many points. Submit anyway?",vi:"B√†i c·ªßa b·∫°n ƒëang b·ªã Binh L·ªßng. B·∫°n c√≥ th·ªÉ b·ªã tr·ª´ r·∫•t nhi·ªÅu ƒëi·ªÉm. V·∫´n mu·ªën n·ªôp?"}),v({en:"Submit Anyway?",vi:"V·∫´n n·ªôp?"}))))return}f.requestArrangeCards(J,Z,se,V),a.play("click")}},disabled:!xe,className:"px-6 py-2.5 rounded-xl font-bold text-sm flex items-center gap-2 shadow-lg "+(xe?me?"bg-green-600 hover:bg-green-500 shadow-green-900/30":"bg-orange-600 hover:bg-orange-500 shadow-orange-900/30":"bg-slate-600 cursor-not-allowed opacity-50"),children:[t.jsx(m,{className:"w-4 h-4"}),xe?me?N({en:"Submit",vi:"X√°c nh·∫≠n"}):t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx(p,{className:"w-3 h-3"}),N({en:"Submit (Fouled!)",vi:"X√°c nh·∫≠n (L·ªßng!)"})]}):N({en:"Place all cards",vi:"X·∫øp h·∫øt b√†i"})]})]})]}),he&&ge.length>0&&t.jsx("div",{className:"px-2 pb-2",children:t.jsx("div",{className:"flex gap-1 flex-wrap pb-1 justify-center",children:ge.map((e,s)=>t.jsxs("button",{onClick:()=>be(e),className:"shrink-0 bg-slate-800 border border-purple-500/40 hover:border-purple-400 rounded-xl p-2.5 text-left transition-all hover:bg-slate-700 min-w-[140px]",children:[t.jsx("div",{className:"text-xs font-bold text-purple-300 mb-1.5 text-center",children:N(e.label)}),t.jsxs("div",{className:"flex flex-col gap-1.5 ",children:[t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx("div",{className:`flex items-center gap-1 px-1.5 py-0.5 rounded-full border mb-0.5 ${q(e.backRank)}`,children:t.jsx("span",{className:"text-xs font-bold",children:N(A[e.backRank])})}),t.jsx("div",{className:"flex -space-x-1",children:e.back.map((e,s)=>t.jsx(U,{card:e},s))})]}),t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx("div",{className:`flex items-center gap-1 px-1.5 py-0.5 rounded-full border mb-0.5 ${q(e.middleRank)}`,children:t.jsx("span",{className:"text-xs font-bold",children:N(A[e.middleRank])})}),t.jsx("div",{className:"flex -space-x-1",children:e.middle.map((e,s)=>t.jsx(U,{card:e},s))})]}),t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx("div",{className:`flex items-center gap-1 px-1.5 py-0.5 rounded-full border mb-0.5 ${q(e.frontRank)}`,children:t.jsx("span",{className:"text-xs font-bold",children:N(A[e.frontRank])})}),t.jsx("div",{className:"flex -space-x-1",children:e.front.map((e,s)=>t.jsx(U,{card:e},s))})]})]})]},s))})})]}),"arranging"===j.gamePhase&&le?.isReady&&t.jsxs("div",{className:"flex items-center justify-center p-4 text-slate-400",children:[t.jsx(m,{className:"w-5 h-5 mr-2 text-green-500"}),N({en:"Waiting for others...",vi:"ƒêang ch·ªù ng∆∞·ªùi kh√°c..."})]}),"waiting"===j.gamePhase&&ne&&t.jsx("div",{className:"w-full flex justify-center p-3",children:j.players.filter(e=>null!==e.id).length>=2?t.jsx("button",{onClick:()=>f.requestStartGame(),className:"px-8 py-3 bg-green-600 hover:bg-green-500 rounded-xl font-bold text-lg shadow-lg shadow-green-900/20 w-full @md:w-auto",children:N({en:"Start Game",vi:"B·∫Øt ƒë·∫ßu"})}):t.jsx("div",{className:"px-8 py-3 bg-slate-700/50 rounded-xl font-bold text-lg text-slate-400 border border-slate-600 w-full @md:w-auto text-center cursor-not-allowed",children:N({en:"Waiting for players (min 2)...",vi:"ƒêang ch·ªù ng∆∞·ªùi ch∆°i (t·ªëi thi·ªÉu 2)..."})})}),"ended"===j.gamePhase&&ne&&t.jsxs("div",{className:"w-full flex justify-center items-center gap-4 p-3",children:[t.jsxs("button",{onClick:()=>{fe(),f.requestStartGame()},className:"px-6 py-3 bg-green-600 hover:bg-green-500 rounded-xl font-bold text-lg shadow-lg shadow-green-900/40 flex items-center gap-2 transition-all transform hover:scale-105",children:[t.jsx(h,{className:"w-5 h-5"}),N({en:"Next Round",vi:"V√°n ti·∫øp"})]}),t.jsxs("button",{onClick:async()=>{await y(v({en:"Reset all scores?",vi:"Reset ƒëi·ªÉm v√† ch∆°i l·∫°i?"}),v({en:"Reset",vi:"Reset"}))&&(fe(),f.requestResetGame())},className:"px-6 py-3 bg-slate-700 hover:bg-slate-600 rounded-xl font-bold text-lg border border-slate-600 flex items-center gap-2 text-slate-300 hover:text-white transition-all",children:[t.jsx(x,{className:"w-5 h-5"}),N({en:"Reset",vi:"Reset"})]})]})]}),null!==E&&ye&&ye[E]&&i.createPortal(t.jsx(X,{analysis:ye[E],player:j.players[ye[E].playerIndex],ti:N,ts:v,onClose:()=>F(null)}),document.body),t.jsx("button",{onClick:()=>O(!0),className:"fixed bottom-4 right-4 p-3 bg-slate-700 hover:bg-slate-600 rounded-full text-yellow-500 transition-colors z-40 shadow-lg border border-slate-500",title:v({en:"Rules",vi:"Lu·∫≠t ch∆°i"}),children:t.jsx(u,{size:24})}),w&&i.createPortal(t.jsx("div",{className:"fixed inset-0 z-100 flex items-center justify-center bg-black/80 p-4 animate-in fade-in duration-200",onClick:()=>O(!1),children:t.jsxs("div",{className:"bg-slate-900 border border-slate-700 rounded-xl max-w-lg w-full max-h-[85vh] flex flex-col shadow-2xl relative overflow-hidden",onClick:e=>e.stopPropagation(),children:[t.jsxs("div",{className:"flex justify-between items-center p-4 bg-slate-800 border-b border-slate-700 shrink-0",children:[t.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[t.jsx(u,{className:"w-6 h-6 text-yellow-500"}),N({en:"How to Play M·∫≠u Binh",vi:"Lu·∫≠t Ch∆°i M·∫≠u Binh"})]}),t.jsx("button",{onClick:()=>O(!1),className:"p-2 hover:bg-slate-700 rounded-lg transition-colors text-slate-400 hover:text-white",children:t.jsx(g,{className:"w-5 h-5"})})]}),t.jsxs("div",{className:"md:p-6 p-4 overflow-y-auto space-y-8 text-slate-300",children:[t.jsx("section",{children:t.jsx("p",{className:"text-base text-slate-100 italic border-l-4 border-yellow-500 pl-4 py-1 bg-yellow-500/10 rounded-r",children:N({en:"Arrange 13 cards into 3 hands (Back ‚â• Middle ‚â• Front) and compare with opponents.",vi:"X·∫øp 13 l√° b√†i th√†nh 3 chi (ƒê·∫ßu ‚â• Gi·ªØa ‚â• Cu·ªëi) r·ªìi so b√†i v·ªõi ƒë·ªëi th·ªß."})})}),t.jsxs("section",{children:[t.jsxs("h3",{className:"text-lg font-bold text-yellow-400 mb-3 flex items-center gap-2",children:[t.jsx(d,{className:"w-5 h-5"}),N({en:"Card Arrangement",vi:"C√°ch X·∫øp B√†i"})]}),t.jsxs("ul",{className:"space-y-2 text-sm text-slate-300",children:[t.jsxs("li",{className:"flex justify-between border-b border-slate-800 pb-1",children:[t.jsx("span",{children:N({en:"Back (Chi ƒë·∫ßu)",vi:"Chi ƒë·∫ßu"})}),t.jsx("span",{className:"font-bold text-red-400",children:N({en:"5 cards ‚Äî Strongest",vi:"5 l√° ‚Äî M·∫°nh nh·∫•t"})})]}),t.jsxs("li",{className:"flex justify-between border-b border-slate-800 pb-1",children:[t.jsx("span",{children:N({en:"Middle (Chi gi·ªØa)",vi:"Chi gi·ªØa"})}),t.jsx("span",{className:"font-bold text-blue-400",children:N({en:"5 cards",vi:"5 l√°"})})]}),t.jsxs("li",{className:"flex justify-between border-b border-slate-800 pb-1",children:[t.jsx("span",{children:N({en:"Front (Chi cu·ªëi)",vi:"Chi cu·ªëi"})}),t.jsx("span",{className:"font-bold text-green-400",children:N({en:"3 cards ‚Äî Weakest",vi:"3 l√° ‚Äî Y·∫øu nh·∫•t"})})]}),t.jsx("li",{className:"text-xs text-red-400 italic mt-2",children:N({en:"‚ö† Back ‚â• Middle ‚â• Front required, or you get Fouled (auto-lose)!",vi:"‚ö† Chi ƒë·∫ßu ‚â• Chi gi·ªØa ‚â• Chi cu·ªëi b·∫Øt bu·ªôc, n·∫øu kh√¥ng s·∫Ω b·ªã Binh L·ªßng (thua)!"})})]})]}),t.jsxs("section",{children:[t.jsxs("h3",{className:"text-lg font-bold text-yellow-400 mb-3 flex items-center gap-2",children:[t.jsx(d,{className:"w-5 h-5"}),N({en:"Hand Rankings",vi:"Th·ª© T·ª± Tay B√†i"}),t.jsx("span",{className:"text-xs font-normal text-slate-400 bg-slate-800 px-2 py-0.5 rounded ml-auto",children:N({en:"Strongest to Weakest",vi:"T·ª´ m·∫°nh ƒë·∫øn y·∫øu"})})]}),t.jsx("div",{className:"space-y-0 text-sm",children:Object.values(I).reverse().map((e,s)=>t.jsxs("div",{className:"flex justify-between items-center p-2 rounded "+(s%2==0?"bg-slate-800/50":""),children:[t.jsxs("div",{className:`flex items-center gap-2 px-2 py-0.5 rounded-full border ${q(e)}`,children:[t.jsx(d,{className:`w-3 h-3 ${K(e)}`}),t.jsx("span",{className:"font-bold",children:N(A[e])})]}),t.jsx("span",{className:"text-slate-400 text-sm",children:N(P[e])})]},s))})]}),t.jsxs("section",{children:[t.jsxs("h3",{className:"text-lg font-bold text-yellow-400 mb-3 flex items-center gap-2",children:[t.jsx(o,{className:"w-5 h-5"}),N({en:"Instant Wins",vi:"M·∫≠u Binh T·ªõi Tr·∫Øng"})]}),t.jsx("p",{className:"text-base text-slate-100 italic border-l-4 border-yellow-500 pl-4 py-1 mb-2 bg-yellow-500/10 rounded-r",children:N({en:"Win immediately if you have one of these hands",vi:"Th·∫Øng ngay l·∫≠p t·ª©c n·∫øu c√≥ 1 trong c√°c tay b√†i sau"})}),t.jsx("div",{className:"space-y-0 text-sm",children:Object.values(k).filter(e=>e!==k.NONE).map((e,s)=>t.jsxs("div",{className:"flex justify-between items-center p-2 rounded "+(s%2==0?"bg-amber-900/20":""),children:[t.jsxs("div",{className:"flex items-center gap-2 px-2 py-0.5 rounded-full border bg-amber-900/50 border-amber-500/30 text-amber-200",children:[t.jsx(o,{className:"w-3 h-3 text-amber-400"}),t.jsx("span",{className:"font-bold",children:N(C[e])})]}),t.jsx("span",{className:"text-slate-400 text-sm",children:N(T[e])})]},s))})]}),t.jsxs("section",{children:[t.jsxs("h3",{className:"text-lg font-bold text-yellow-400 mb-3 flex items-center gap-2",children:[t.jsx(x,{className:"w-5 h-5"}),N({en:"Comparison",vi:"C√°ch So B√†i"})]}),t.jsxs("ul",{className:"space-y-2 text-sm text-slate-300",children:[t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"text-yellow-500 font-bold",children:"‚Ä¢"}),t.jsx("span",{children:N({en:"Hands are compared one by one: Back vs Back, Middle vs Middle, Front vs Front.",vi:"So s√°nh t·ª´ng chi t∆∞∆°ng ·ª©ng: Chi ƒë·∫ßu vs Chi ƒë·∫ßu, Gi·ªØa vs Gi·ªØa, Cu·ªëi vs Cu·ªëi."})})]}),t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"text-yellow-500 font-bold",children:"‚Ä¢"}),t.jsx("span",{children:N({en:"Winning a chi grants +1 point, losing a chi takes -1 point.",vi:"Th·∫Øng m·ªói chi ƒë∆∞·ª£c +1 ƒëi·ªÉm, thua m·ªói chi b·ªã -1 ƒëi·ªÉm."})})]})]})]}),t.jsxs("section",{children:[t.jsxs("h3",{className:"text-lg font-bold text-yellow-400 mb-3 flex items-center gap-2",children:[t.jsx(d,{className:"w-5 h-5"}),N({en:"Scoring & Bonuses",vi:"T√≠nh ƒêi·ªÉm & Th∆∞·ªüng"})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:"space-y-0 text-sm",children:Object.values(B).filter(e=>e!==B.SCOOP&&e!==B.SCOOP_ALL).map((e,s)=>t.jsxs("div",{className:"flex justify-between items-center p-2 rounded "+(s%2==0?"bg-slate-800/50":""),children:[t.jsx("span",{className:"text-slate-200",children:N(S[e])}),t.jsxs("span",{className:"font-bold text-green-400",children:["+",M[e]]})]},s))}),t.jsxs("div",{className:"bg-indigo-900/20 border border-indigo-500/30 rounded-lg p-3 space-y-2 text-xs",children:[t.jsxs("div",{className:"flex gap-2",children:[t.jsx(o,{className:"w-4 h-4 text-indigo-400 shrink-0"}),t.jsxs("p",{children:[t.jsx("span",{className:"font-bold text-indigo-300 mr-1",children:N({en:"Scoop (S·∫≠p 3 chi):",vi:"S·∫≠p 3 chi:"})}),N({en:"Win all 3 hands against an opponent to get +3 bonus.",vi:"Th·∫Øng c·∫£ 3 chi tr∆∞·ªõc 1 ƒë·ªëi th·ªß ƒë∆∞·ª£c th∆∞·ªüng th√™m +3."})]})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(d,{className:"w-4 h-4 text-indigo-400 shrink-0"}),t.jsxs("p",{children:[t.jsx("span",{className:"font-bold text-indigo-300 mr-1",children:N({en:"Scoop All (B·∫Øt s·∫≠p l√†ng):",vi:"B·∫Øt s·∫≠p l√†ng:"})}),N({en:"Win all 3 hands against ALL opponents to get +6 bonus.",vi:"Th·∫Øng c·∫£ 3 chi tr∆∞·ªõc T·∫§T C·∫¢ ƒë·ªëi th·ªß ƒë∆∞·ª£c th∆∞·ªüng th√™m +6."})]})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(b,{className:"w-4 h-4 text-indigo-400 shrink-0"}),t.jsxs("p",{children:[t.jsx("span",{className:"font-bold text-indigo-300 mr-1",children:N({en:"Manual Bonus:",vi:"Th∆∞·ªüng th·ªß c√¥ng:"})}),N({en:"Win without using auto-arrange to get +1 extra bonus.",vi:"Th·∫Øng m√† kh√¥ng d√πng g·ª£i √Ω ƒë∆∞·ª£c th∆∞·ªüng th√™m +1."})]})]})]})]})]})]})]})}),document.body)]})}function W({timerEndsAt:e,isReady:s}){const[l,i]=r.useState(Date.now());r.useEffect(()=>{const e=setInterval(()=>{i(Date.now())},1e3);return()=>clearInterval(e)},[]);const d=Math.max(0,Math.floor((e-l)/1e3));return r.useEffect(()=>{d<=10&&d>0&&!s&&a.play(n.tick)},[d,s]),t.jsxs("div",{className:"bg-black/60 px-4 py-2 rounded-xl border flex items-center gap-2 transition-all duration-300 "+(d<=5?"border-red-500 scale-110 shadow-[0_0_15px_rgba(239,68,68,0.5)] animate-pulse":d<=10?"border-red-500 animate-pulse":"border-yellow-500/30"),children:[t.jsx(N,{className:"w-4 h-4 "+(d<=10?"text-red-500":"text-yellow-500")}),t.jsxs("span",{className:"font-bold text-xl font-mono "+(d<=10?"text-red-400":"text-yellow-400"),children:[d,"s"]})]})}function $({player:e,isSelf:s,isHost:a,gamePhase:l,ti:n,onAddBot:r,onRemove:i,onShowAnalytics:d,game:c}){if(null===e.id)return t.jsxs("div",{className:"flex flex-col items-center gap-2 opacity-50 hover:opacity-100 transition-opacity",children:[t.jsx("div",{className:"w-14 h-14 rounded-full border-2 border-dashed border-slate-500 flex items-center justify-center bg-black/20 text-slate-400",children:t.jsx(f,{className:"w-6 h-6"})}),"waiting"===l&&a&&t.jsxs("button",{onClick:r,className:"px-3 py-1 bg-slate-700 hover:bg-slate-600 rounded text-xs flex items-center gap-1",children:[t.jsx(j,{className:"w-3 h-3"})," Bot"]})]});const x="comparing"===l||"ended"===l;return t.jsxs("div",{className:"relative flex flex-col items-center p-2 rounded-xl transition-all duration-300 min-w-[100px] @md:min-w-[150px] "+(e.isReady&&"arranging"===l?"ring-2 ring-green-400 bg-green-900/20":e.isFouled?"ring-2 ring-red-500 bg-red-900/20":e.instantWin!==k.NONE&&x?"ring-2 ring-amber-400 bg-amber-900/20 animate-pulse":"bg-slate-900/60 ring-1 ring-slate-700"),children:[e.instantWin!==k.NONE&&x&&t.jsxs("div",{className:"absolute -top-5 bg-linear-to-r from-amber-600 to-yellow-500 px-2 py-0.5 rounded-full text-[10px] font-bold text-white flex items-center gap-1 shadow-lg z-30 whitespace-nowrap",children:[t.jsx(o,{className:"w-3 h-3"}),n(C[e.instantWin])]}),e.isFouled&&x&&t.jsxs("div",{className:"absolute -top-5 bg-red-600 px-2 py-0.5 rounded-full text-[10px] font-bold text-white flex items-center gap-1 shadow-lg z-30",children:[t.jsx(p,{className:"w-3 h-3"}),n({en:"Fouled!",vi:"Binh L·ªßng!"})]}),t.jsxs("div",{className:"flex items-center gap-1 mb-1 max-w-[150px]",children:[e.isBot&&t.jsx(j,{className:"w-3 h-3 text-blue-400"}),t.jsx("span",{className:"text-xs font-bold",children:e.username})]}),e.isReady&&"arranging"===l&&t.jsx(m,{className:"w-4 h-4 text-green-500"}),"arranging"!==l&&t.jsxs("div",{className:"text-xs font-mono px-2 py-0.5 rounded-full mb-1 "+(e.score>0?"bg-green-900/50 text-green-400":e.score<0?"bg-red-900/50 text-red-400":"bg-slate-800/50 text-slate-400"),children:[e.score>0?"+":"",e.score]}),x&&!e.usedAuto&&!e.isBot&&!e.isFouled&&e.score>0&&t.jsxs("div",{className:"mb-1 bg-emerald-900/50 border border-emerald-500/40 text-emerald-300 px-1.5 py-0.5 rounded-full text-xs font-bold flex items-center gap-0.5",children:["üß† ",n({en:"Manual +1",vi:"Th·ªß c√¥ng +1"})]}),x&&e.back.length>0&&t.jsx("div",{className:"flex flex-col gap-0.5 items-center mt-1",children:[e.back,e.middle,e.front].map(e=>{const s=c.evaluate5CardHand(e).rank;return t.jsxs("div",{className:"flex flex-col items-center gap-0.5",children:[t.jsx("div",{className:`flex items-center gap-2 px-2 py-0.5 rounded-full border ${q(s)}`,children:t.jsx("span",{className:"text-xs font-bold",children:n(A[s])})}),t.jsx("div",{className:"flex -space-x-1",children:e.map((e,s)=>t.jsx(U,{card:e},s))})]},e+"")})}),"arranging"===l&&!s&&e.hand.length>0&&t.jsx("div",{className:"flex flex-wrap justify-center -space-x-1 max-w-[60px] mt-1",children:Array(3).fill(null).map((e,s)=>t.jsx("div",{className:"w-3.5 h-5 bg-blue-900 rounded-sm border border-white/20"},s))}),"ended"===l&&(d?t.jsxs("button",{onClick:e=>{e.stopPropagation(),d()},className:"mt-3 w-full px-3 py-1.5 bg-linear-to-r from-indigo-600 to-violet-600 hover:from-indigo-500 hover:to-violet-500 rounded-lg text-[10px] font-bold flex items-center justify-center gap-1.5 transition-all shadow-lg shadow-indigo-900/40 ring-1 ring-indigo-400/50 hover:ring-indigo-300 animate-pulse-slow group",children:[t.jsx(o,{className:"w-3 h-3 text-yellow-300 group-hover:scale-125 transition-transform"}),t.jsx("span",{className:"text-white drop-shadow-sm",children:n({en:"Better way?",vi:"C√°ch x·∫øp t·ªët h∆°n?"})})]}):null),a&&"waiting"===l&&e.isBot&&t.jsx("button",{onClick:i,className:"absolute top-0 right-0 w-5 h-5 bg-red-600/80 rounded-full flex items-center justify-center text-white hover:bg-red-500 z-30",children:t.jsx(g,{className:"w-3 h-3"})})]})}function z({card:e,size:s="md",className:a="",onClick:l}){const{rank:n,suit:r}=F(e),i=r===_.HEART||r===_.DIAMOND;return t.jsxs("div",{onClick:l,className:`${{sm:"w-9 h-13 text-[11px]",md:"w-12 h-17 text-sm",lg:"w-14 h-20 text-base"}[s]} bg-white rounded-md shadow-lg border border-slate-300 flex flex-col items-center justify-between p-0.5 select-none animate-[cardPlay_0.3s_ease-out_forwards] ${a}`,children:[t.jsx("div",{className:"self-start font-bold leading-none "+(i?"text-red-600":"text-slate-900"),children:O[n]}),t.jsx("div",{className:(i?"text-red-500":"text-slate-800")+" text-lg",children:E[r]}),t.jsx("div",{className:"h-2"})]})}function G({card:e,onClick:s,highlight:a}){const{rank:l,suit:n}=F(e),r=n===_.HEART||n===_.DIAMOND;return t.jsxs("div",{onClick:s,className:`w-8 h-11 bg-white rounded-sm shadow border flex flex-col items-center justify-center select-none text-xs font-bold leading-tight animate-[cardPlay_0.3s_ease-out_forwards] ${a?"ring-1 ring-yellow-400 cursor-pointer hover:scale-110 transition-transform":""} ${s?"cursor-pointer":""}`,children:[t.jsx("span",{className:r?"text-red-600":"text-slate-900",children:O[l]}),t.jsx("span",{className:"text-xs "+(r?"text-red-500":"text-slate-800"),children:E[n]})]})}function U({card:e}){const{rank:s,suit:a}=F(e),l=a===_.HEART||a===_.DIAMOND;return t.jsxs("div",{className:"w-6 h-10 bg-white rounded-sm border border-slate-300 flex flex-col items-center justify-center select-none leading-none animate-[cardPlay_0.3s_ease-out_forwards]",children:[t.jsx("span",{className:"text-xs font-bold "+(l?"text-red-600":"text-slate-900"),children:O[s]}),t.jsx("span",{className:"text-xs "+(l?"text-red-500":"text-slate-800"),children:E[a]})]})}const q=e=>{if(void 0===e)return"bg-slate-900/90 border-slate-500/50 text-slate-200";switch(e){case I.STRAIGHT_FLUSH:return"bg-purple-900/90 border-purple-500/50 text-purple-200 shadow-purple-900/50";case I.FOUR_OF_A_KIND:case I.FULL_HOUSE:return"bg-red-900/90 border-red-500/50 text-red-100 shadow-red-900/50";case I.FLUSH:case I.STRAIGHT:return"bg-blue-900/90 border-blue-500/50 text-blue-100 shadow-blue-900/50";case I.THREE_OF_A_KIND:case I.TWO_PAIR:return"bg-green-900/90 border-green-500/50 text-green-100 shadow-green-900/50";default:return"bg-slate-800/90 border-slate-500/50 text-slate-300 shadow-slate-900/50"}},K=e=>{if(void 0===e)return"text-slate-400";switch(e){case I.STRAIGHT_FLUSH:return"text-purple-400";case I.FOUR_OF_A_KIND:case I.FULL_HOUSE:return"text-red-400";case I.FLUSH:case I.STRAIGHT:return"text-blue-400";case I.THREE_OF_A_KIND:case I.TWO_PAIR:return"text-green-400";default:return"text-slate-400"}};function V({analysis:e,player:s,ti:a,ts:l}){const n=Math.round(e.actualScore/e.optimalScore*100);return t.jsxs("div",{className:"bg-slate-900/60 rounded-xl p-3 w-full @md:max-w-sm",children:[t.jsxs("div",{className:"flex justify-between items-center mb-2",children:[t.jsx("div",{className:"text-md text-white font-bold flex items-center gap-1.5",children:s.username}),t.jsxs("div",{className:"flex items-center gap-1 flex-wrap justify-end",children:[t.jsxs("div",{className:"text-xs px-2 py-0.5 rounded-full bg-orange-500/20 text-orange-300 font-bold border border-orange-500/30",children:[a({en:"Better than",vi:"T·ªët h∆°n"})," ",100-n,"%"]}),e.optimalPoints>e.actualPoints&&t.jsxs("div",{className:"text-xs px-2 py-0.5 rounded-full bg-green-500/20 text-green-400 font-bold border border-green-500/30 flex items-center gap-1",children:[t.jsx(y,{className:"w-3 h-3"}),"+",e.optimalPoints-e.actualPoints,t.jsx("span",{className:"text-[8px] opacity-70 ml-0.5",children:"pts"})]})]})]}),t.jsxs("div",{className:"mt-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-2",children:[t.jsxs("div",{className:"flex flex-col gap-1",children:[t.jsxs("div",{className:"text-xs font-bold text-slate-400 uppercase flex items-center gap-1",children:[t.jsx(w,{className:"w-3 h-3"}),a({en:"Current",vi:"Hi·ªán t·∫°i"})]}),t.jsxs("div",{className:"text-xs font-mono font-bold "+(e.actualPoints>=0?"text-green-400":"text-red-400"),children:[e.actualPoints>0?"+":"",e.actualPoints," pts"]})]}),t.jsxs("div",{className:"flex flex-col items-end",children:[t.jsxs("div",{className:"text-xs font-bold text-indigo-400 uppercase flex items-center gap-1",children:[t.jsx(o,{className:"w-3 h-3"}),a({en:"Optimal",vi:"T·ªëi ∆∞u"})]}),t.jsxs("div",{className:"text-xs font-mono font-bold text-indigo-300",children:[e.optimalPoints>0?"+":"",e.optimalPoints," pts"]})]})]}),t.jsx("div",{className:"space-y-1",children:[{label:l({en:"Back",vi:"ƒê·∫ßu"}),actual:e.actual.back,actualRank:e.actualBackRank,optimal:e.optimal.back,optimalRank:e.optimalBackRank},{label:l({en:"Middle",vi:"Gi·ªØa"}),actual:e.actual.middle,actualRank:e.actualMiddleRank,optimal:e.optimal.middle,optimalRank:e.optimalMiddleRank},{label:l({en:"Front",vi:"Cu·ªëi"}),actual:e.actual.front,actualRank:e.actualFrontRank,optimal:e.optimal.front,optimalRank:e.optimalFrontRank}].map((e,s)=>t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsxs("div",{className:"bg-slate-800/40 p-1 rounded-lg border border-slate-700/30 relative",children:[t.jsx("span",{className:"absolute -top-1 -left-1 px-1 bg-slate-700 text-[8px] rounded font-bold text-slate-400 z-10 border border-slate-600/50",children:e.label}),t.jsxs("div",{className:"flex flex-col items-center gap-1",children:[t.jsx("div",{className:`px-1.5 py-0.5 rounded-full border text-[10px] font-bold leading-none ${q(e.actualRank)}`,children:a(A[e.actualRank])}),t.jsx("div",{className:"flex -space-x-1.5",children:e.actual.map((e,s)=>t.jsx(U,{card:e},s))})]})]}),t.jsxs("div",{className:"bg-indigo-900/20 p-1 rounded-lg border border-indigo-500/20 relative",children:[t.jsx("span",{className:"absolute -top-1 -right-1 px-1 bg-indigo-800 text-[8px] rounded font-bold text-indigo-300 z-10 border border-indigo-500/30",children:e.label}),t.jsxs("div",{className:"flex flex-col items-center gap-1",children:[t.jsxs("div",{className:`px-1.5 py-0.5 rounded-full border text-[10px] font-bold leading-none ${q(e.optimalRank)}`,children:[a(A[e.optimalRank]),e.optimalRank>e.actualRank&&t.jsx("span",{className:"ml-0.5 text-green-400",children:"‚Üë"})]}),t.jsx("div",{className:"flex -space-x-1.5",children:e.optimal.map((e,s)=>t.jsx(U,{card:e},s))})]})]})]},s))})]})]})}function X({analysis:e,player:s,ti:a,ts:l,onClose:n}){return t.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-in fade-in duration-200",children:t.jsxs("div",{className:"relative bg-slate-900 border border-slate-700 rounded-2xl shadow-2xl w-full max-w-lg overflow-hidden flex flex-col max-h-[90vh] animate-in zoom-in-95 duration-200",children:[t.jsxs("div",{className:"px-6 py-4 border-b border-slate-800 flex items-center justify-between bg-slate-900/50",children:[t.jsxs("h3",{className:"text-xl font-bold flex items-center gap-2 text-indigo-400",children:[t.jsx(v,{className:"w-6 h-6"}),a({en:"Cards Analytics",vi:"Ph√¢n t√≠ch x·∫øp b√†i"})]}),t.jsx("button",{onClick:n,className:"p-2 hover:bg-slate-800 rounded-full transition-colors text-slate-400 hover:text-white",children:t.jsx(g,{className:"w-6 h-6"})})]}),t.jsx("div",{className:"p-2 overflow-y-auto custom-scrollbar",children:t.jsx(V,{analysis:e,player:s,ti:a,ts:l})})]})})}export{D as default};
