import{u as e,b as s,S as t,j as n,h as a}from"./index-DeW22Zn2.js";import{b as l,c as i,aF as r,a9 as o,i as c,t as d,ak as m,X as h,aJ as x}from"./react-vendor-BeKtp5AY.js";import"./BaseGame-DNUNIW8N.js";import{C as u,b as g,R as p,a as b}from"./types-BR_cD1-k.js";import{u as f}from"./useGameState-BSMNmzbB.js";import{u as w}from"./usePrevious-CWyMgkdp.js";import"./socket-DRbsQkF5.js";import"./zustand-C88HNARu.js";function v({game:v,currentUserId:j}){const y=v,[N]=f(y),[k,C]=l.useState(!1),{ti:P,ts:q}=e(),{confirm:G}=s(),I=y.getMyPlayerIndex(),R=y.isHost,T=N?.currentPlayerIndex===I;if(w(N?.currentPlayerIndex,(e,s)=>{N&&N.gamePhase===u.PLAYING&&null!==e&&t.playTurnSwitch(T)}),!N)return null;return n.jsxs("div",{className:"flex flex-col items-center gap-4 p-4 w-full max-w-2xl mx-auto pb-16!",children:[n.jsx("style",{dangerouslySetInnerHTML:{__html:"\n        @keyframes drop {\n          0% { transform: translateY(-500%); opacity: 0.5; }\n          100% { transform: translateY(0); opacity: 1; }\n        }\n        @keyframes winner-pulse {\n          0%, 100% { transform: scale(1); opacity: 1; box-shadow: 0 0 20px rgba(255, 255, 255, 0.8); }\n          50% { transform: scale(1.05); opacity: 0.8; box-shadow: 0 0 40px rgba(255, 255, 255, 1); }\n        }\n        @keyframes winner-glow {\n          0%, 100% { filter: brightness(1); }\n          50% { filter: brightness(1.3); }\n        }\n        .animate-drop {\n          animation-name: drop;\n          animation-fill-mode: forwards;\n        }\n        .animate-winner-pulse {\n          animation: winner-pulse 1s ease-in-out infinite;\n        }\n        .animate-winner-glow {\n          animation: winner-glow 1s ease-in-out infinite;\n        }\n      "}}),n.jsxs("div",{className:"flex flex-col gap-2 p-4 bg-slate-800 rounded-lg w-full max-w-md border border-slate-700",children:[n.jsx("h3",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest mb-1",children:P({en:"Players",vi:"Ng∆∞·ªùi ch∆°i"})}),N.players.map((e,s)=>{const t=N.currentPlayerIndex===s;return n.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg transition-all "+(t?"bg-slate-700 ring-2 ring-blue-500 shadow-lg":"bg-slate-900"),children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-6 h-6 rounded-full shadow-inner "+(0===s?"bg-red-500":"bg-yellow-400")}),n.jsxs("span",{className:"font-medium "+(t?"text-white":"text-gray-400"),children:[e.username,a(e.flags,b.BOT)&&" ü§ñ"]})]}),a(e.flags,b.BOT)&&R&&n.jsx("button",{onClick:()=>y.requestRemoveBot(),className:"text-xs px-2 py-1 bg-red-600 hover:bg-red-500 text-white rounded transition-colors",children:P({en:"Remove",vi:"X√≥a"})}),R&&!e.id&&n.jsxs("button",{onClick:()=>y.requestAddBot(),className:"flex items-center gap-2 p-2 bg-blue-600 hover:bg-blue-500 text-white rounded-lg transition-colors text-sm",children:[n.jsx(r,{className:"w-4 h-4"}),P({en:"Add Bot",vi:"Th√™m Bot"})]})]},s)})]}),n.jsxs("div",{className:"flex gap-3",children:[N.gamePhase===u.WAITING&&n.jsxs(n.Fragment,{children:[R&&y.canStartGame()&&n.jsxs("button",{onClick:()=>y.requestStartGame(),className:"flex items-center gap-2 px-6 py-3 bg-green-600 hover:bg-green-500 text-white rounded-xl font-bold transition-all shadow-lg shadow-green-600/20 active:scale-95",children:[n.jsx(o,{className:"w-5 h-5 text-white"})," ",P({en:"Start Game",vi:"B·∫Øt ƒë·∫ßu"})]}),!R&&n.jsx("div",{className:"text-gray-500 font-medium italic",children:P({en:"Waiting for host to start...",vi:"ƒêang ch·ªù ch·ªß ph√≤ng b·∫Øt ƒë·∫ßu..."})})]}),N.gamePhase===u.PLAYING&&n.jsxs(n.Fragment,{children:[!N.undoRequest&&n.jsxs("button",{onClick:()=>y.requestUndo(),className:"flex items-center gap-2 px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg transition-colors font-medium text-sm border border-slate-600",children:[n.jsx(c,{className:"w-4 h-4 text-gray-400"})," ",P({en:"Undo",vi:"Ho√†n t√°c"})]}),R&&n.jsxs("button",{onClick:async()=>{await G(q({en:"Reset the game?",vi:"Ch∆°i l·∫°i t·ª´ ƒë·∫ßu?"}),q({en:"Reset",vi:"Reset"}))&&y.requestNewGame()},className:"flex items-center gap-2 px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg transition-colors font-medium text-sm border border-slate-600",children:[n.jsx(d,{className:"w-4 h-4 text-gray-400"})," ",P({en:"New Game",vi:"V√°n m·ªõi"})]})]})]}),N.gamePhase===u.PLAYING&&n.jsx("div",{className:"text-lg font-semibold tracking-tight",children:T?n.jsx("span",{className:"text-blue-400 animate-pulse",children:P({en:"Your Turn!",vi:"L∆∞·ª£t c·ªßa b·∫°n!"})}):n.jsxs("span",{className:"text-gray-500",children:[P({en:"Waiting for",vi:"ƒêang ch·ªù"})," ",N.players[N.currentPlayerIndex].username,"..."]})}),N.undoRequest&&N.undoRequest.fromId!==j&&n.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50 backdrop-blur-sm",children:n.jsxs("div",{className:"bg-slate-800 rounded-xl p-6 shadow-2xl max-w-sm mx-4 border border-slate-700",children:[n.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:P({en:"Undo Request",vi:"Y√™u c·∫ßu ho√†n t√°c"})}),n.jsxs("p",{className:"text-gray-400 mb-6 leading-relaxed",children:[n.jsx("span",{className:"text-blue-400 font-semibold",children:N.undoRequest.fromName})," ",P({en:"wants to undo their last move.",vi:"mu·ªën ho√†n t√°c n∆∞·ªõc ƒëi v·ª´a r·ªìi."})]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsxs("button",{onClick:()=>y.acceptUndo(),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-500 text-white rounded-lg transition-colors font-semibold",children:[n.jsx(m,{className:"w-4 h-4"})," ",P({en:"Accept",vi:"ƒê·ªìng √Ω"})]}),n.jsxs("button",{onClick:()=>y.declineUndo(),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-red-600 hover:bg-red-500 text-white rounded-lg transition-colors font-semibold",children:[n.jsx(h,{className:"w-4 h-4"})," ",P({en:"Decline",vi:"T·ª´ ch·ªëi"})]})]})]})}),N.undoRequest&&N.undoRequest.fromId===j&&n.jsx("div",{className:"text-yellow-400 text-sm font-medium bg-yellow-400/10 px-3 py-1 rounded-full border border-yellow-400/20",children:P({en:"Waiting for opponent to accept undo...",vi:"ƒêang ch·ªù ƒë·ªëi th·ªß ch·∫•p nh·∫≠n ho√†n t√°c..."})}),N.gamePhase===u.ENDED&&n.jsxs("div",{className:"text-center p-6 bg-slate-800 rounded-xl border-2 border-slate-700 shadow-2xl mb-4",children:[n.jsx("h3",{className:"text-2xl font-black text-white mb-2 uppercase tracking-tighter",children:P({en:"Game Over!",vi:"K·∫øt th√∫c!"})}),n.jsx("p",{className:"text-gray-300 text-lg mb-4 font-medium",children:"draw"===N.winner?P({en:"It's a draw!",vi:"H√≤a!"}):N.winner===j?P({en:"üèÜ You Won!",vi:"üèÜ B·∫°n ƒë√£ th·∫Øng!"}):`${N.players.find(e=>e.id===N.winner)?.username} ${P({en:"wins!",vi:"th·∫Øng!"})}`}),n.jsxs("button",{onClick:()=>y.requestNewGame(),className:"flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-500 text-white rounded-xl transition-all font-bold shadow-lg shadow-blue-600/20 active:scale-95 mx-auto",children:[n.jsx(d,{className:"w-5 h-5"})," ",P({en:"Play Again",vi:"Ch∆°i l·∫°i"})]})]}),n.jsx("div",{className:"w-full max-w-md bg-blue-700 p-3 rounded-4xl shadow-2xl mx-auto",children:n.jsx("div",{className:"grid grid-cols-7 gap-1",children:Array.from({length:g}).map((e,s)=>n.jsxs("div",{onClick:()=>(e=>{N.gamePhase===u.PLAYING&&T&&(y.isColumnFull(e)||y.requestMove(e))})(s),className:"flex flex-col gap-1 rounded-2xl transition-all duration-200 group/col relative overflow-hidden "+(T&&!y.isColumnFull(s)?"cursor-pointer hover:bg-white/5":"cursor-default"),children:[T&&!y.isColumnFull(s)&&n.jsx("div",{className:"absolute inset-0 bg-white/0 group-hover/col:bg-white/5 rounded-2xl transition-colors pointer-events-none"}),Array.from({length:p}).map((e,t)=>((e,s)=>{const t=e*g+s,a=N.board[t],l=N.winningCells.includes(t),i=N.lastMove===t,r=N.winningCells.length>0&&!l;return n.jsx("div",{className:"w-full relative pb-[100%] h-0",children:n.jsxs("div",{className:"absolute inset-0 bg-blue-900/40 rounded-full flex items-center justify-center shadow-inner border border-blue-400/20 transition-opacity duration-500 "+(r?"opacity-40":"opacity-100"),children:[l&&n.jsx("div",{className:"absolute inset-0 rounded-full ring-4 ring-white animate-winner-pulse shadow-[0_0_20px_rgba(255,255,255,0.8)] z-10"}),"0"!==a&&n.jsx("div",{className:`\n                w-[85%] h-[85%] rounded-full shadow-lg transform transition-all duration-300\n                ${"1"===a?"bg-red-500":"bg-yellow-500"}\n                ${i?"border-4 border-white":""}\n                ${l?"animate-winner-glow":"animate-drop"}\n                ${r?"opacity-40 grayscale-[0.5]":"opacity-100"}\n              `,style:l?{}:{animationDuration:.4+.1*e+"s",animationTimingFunction:"cubic-bezier(0.4, 0, 0.2, 1)"}})]})},`${e}-${s}`)})(t,s))]},s))})}),n.jsx("button",{onClick:()=>C(!0),className:"fixed bottom-4 right-4 p-3 bg-slate-700 hover:bg-slate-600 rounded-full text-yellow-500 transition-colors z-40 shadow-lg border border-slate-500",title:q({en:"Rules",vi:"Lu·∫≠t ch∆°i"}),children:n.jsx(x,{size:24})}),k&&i.createPortal(n.jsx("div",{className:"fixed inset-0 z-60 flex items-center justify-center bg-black/80 p-4",children:n.jsxs("div",{className:"bg-slate-900 border border-slate-700 rounded-xl max-w-lg w-full shadow-2xl relative",children:[n.jsxs("div",{className:"flex justify-between p-4 pr-2",children:[n.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[n.jsx(x,{className:"w-6 h-6 text-yellow-500"}),P({en:"Game Rules: Connect 4",vi:"Lu·∫≠t Ch∆°i: N·ªëi 4"})]}),n.jsx("button",{onClick:()=>C(!1),className:"p-2 hover:bg-white/10 rounded-full transition-colors text-slate-400 hover:text-white",children:n.jsx(h,{className:"w-5 h-5"})})]}),n.jsx("div",{className:"p-4 pt-0 space-y-4 text-slate-300 leading-relaxed max-h-[80vh] overflow-y-auto",children:n.jsxs("div",{className:"space-y-4",children:[n.jsx("p",{children:P({en:"Connect 4 is a two-player connection board game, in which the players choose a color and then take turns dropping colored discs into a seven-column, six-row vertically suspended grid.",vi:"Connect 4 (C·ªù ca-r√¥ x·∫øp ƒë·ª©ng) l√† tr√≤ ch∆°i d√†nh cho 2 ng∆∞·ªùi, l·∫ßn l∆∞·ª£t th·∫£ c√°c qu√¢n c·ªù m√†u v√†o l∆∞·ªõi x·∫øp ƒë·ª©ng 7 c·ªôt 6 h√†ng."})}),n.jsx("h3",{className:"text-lg font-bold text-yellow-400 mt-4",children:P({en:"Objective",vi:"M·ª•c ti√™u"})}),n.jsx("ul",{className:"list-disc pl-5 space-y-1",children:n.jsx("li",{children:P({en:"Be the first to form a horizontal, vertical, or diagonal line of four of one's own discs.",vi:"L√† ng∆∞·ªùi ƒë·∫ßu ti√™n x·∫øp ƒë∆∞·ª£c 4 qu√¢n li√™n ti·∫øp theo h√†ng ngang, d·ªçc ho·∫∑c ch√©o."})})}),n.jsx("h3",{className:"text-lg font-bold text-yellow-400 mt-4",children:P({en:"Gameplay",vi:"Lu·∫≠t ch∆°i"})}),n.jsxs("ul",{className:"list-disc pl-5 space-y-1",children:[n.jsx("li",{children:P({en:"Players take turns dropping one of their discs into an unfilled column.",vi:"Ng∆∞·ªùi ch∆°i l·∫ßn l∆∞·ª£t th·∫£ qu√¢n c·ªßa m√¨nh v√†o m·ªôt c·ªôt ch∆∞a ƒë·∫ßy."})}),n.jsx("li",{children:P({en:"The disc occupies the lowest available space within the column.",vi:"Qu√¢n c·ªù s·∫Ω r∆°i xu·ªëng v·ªã tr√≠ th·∫•p nh·∫•t c√≥ th·ªÉ trong c·ªôt."})})]}),n.jsx("h3",{className:"text-lg font-bold text-yellow-400 mt-4",children:P({en:"Winning",vi:"Chi·∫øn th·∫Øng"})}),n.jsx("ul",{className:"list-disc pl-5 space-y-1",children:n.jsx("li",{children:P({en:"The game ends when a player connects 4 discs or the board is full (draw).",vi:"Tr√≤ ch∆°i k·∫øt th√∫c khi c√≥ ng∆∞·ªùi x·∫øp ƒë∆∞·ª£c 4 qu√¢n ho·∫∑c b√†n c·ªù ƒë·∫ßy (h√≤a)."})})})]})})]})}),document.body)]})}export{v as default};
