import{a as e,j as s}from"./index-Dgl20RHv.js";import{l as n,A as t,X as a,a3 as l,a4 as r,a6 as i,p as o}from"./react-vendor-DqvDgvkG.js";import"./socket-DRbsQkF5.js";import{C as c,R as d}from"./types-zc5glPn-.js";import"./zustand-DHxpPrWm.js";function m({game:m,currentUserId:u}){const x=m,[g,h]=n.useState(x.getState()),[p,f]=n.useState(null),{ti:j}=e();n.useEffect(()=>{x.onUpdate(h),h(x.getState()),x.requestSync()},[x]);const v=x.getMyPlayerIndex(),b=v>=0?g.players[v].color:null,y=g.players[g.currentPlayerIndex],w=y?.id===u,N=x.isHostUser,C=e=>{"playing"===g.gamePhase&&w&&(x.isColumnFull(e)||x.requestMove(e))},q=(e,n)=>{const t=g.board[e][n],a=((e,s)=>g.winningCells?.some(n=>n.row===e&&n.col===s))(e,n),l=((e,s)=>g.lastMove?.row===e&&g.lastMove?.col===s)(e,n);return s.jsx("div",{className:"aspect-square flex items-center justify-center bg-blue-700 p-1",children:s.jsx("div",{className:`\n            w-full h-full rounded-full transition-all duration-200\n            ${t?"":"bg-blue-900"}\n            ${"red"===t?"bg-red-500":""}\n            ${"yellow"===t?"bg-yellow-400":""}\n            ${a?"ring-4 ring-white animate-pulse":""}\n            ${l&&!a?"ring-2 ring-white/50":""}\n          `,style:l&&t?{animation:"drop 0.5s ease-out"}:void 0})},`${e}-${n}`)};return s.jsxs("div",{className:"flex flex-col items-center gap-4 p-4 w-full max-w-lg mx-auto",children:[s.jsx("style",{dangerouslySetInnerHTML:{__html:"\n@keyframes drop {\n  0% { transform: translateY(-400px); }\n  60% { transform: translateY(10px); }\n  80% { transform: translateY(-5px); }\n  100% { transform: translateY(0); }\n}\n"}}),s.jsxs("div",{className:"flex flex-col gap-2 p-4 bg-slate-800 rounded-lg w-full",children:[s.jsx("h3",{className:"text-sm font-medium text-gray-400 mb-1",children:"Players"}),g.players.map((e,n)=>s.jsxs("div",{className:`\n              flex items-center justify-between p-2 rounded-lg\n              ${g.currentPlayerIndex===n&&"playing"===g.gamePhase?"bg-slate-600 ring-2 ring-blue-400":"bg-slate-700"}\n            `,children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:`\n                  w-6 h-6 rounded-full\n                  ${"red"===e.color?"bg-red-500":"bg-yellow-400"}\n                `}),s.jsxs("span",{className:"text-white",children:[e.id?e.username:j({en:"(waiting...)",vi:"(Ä‘ang chá»...)"}),e.isBot&&" ðŸ¤–",e.id===u&&j({en:" (You)",vi:" (Báº¡n)"})]})]}),e.isBot&&N&&"waiting"===g.gamePhase&&s.jsx("button",{onClick:()=>x.requestRemoveBot(),className:"text-xs px-2 py-1 bg-red-600 hover:bg-red-500 text-white rounded transition-colors",children:j({en:"Remove",vi:"XÃ³a"})})]},n))]}),"playing"===g.gamePhase&&s.jsx("div",{className:"text-lg text-gray-400",children:w?s.jsx("span",{className:"text-green-400",children:j({en:"Your turn! Click a column.",vi:"LÆ°á»£t cá»§a báº¡n! Chá»n má»™t cá»™t."})}):s.jsxs("span",{children:[j({en:"Waiting for",vi:"Äang chá»"})," ",y?.username,"..."]})}),g.undoRequest&&g.undoRequest.fromId!==u&&s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-slate-800 rounded-xl p-6 shadow-xl max-w-sm mx-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:j({en:"Undo Request",vi:"YÃªu cáº§u hoÃ n tÃ¡c"})}),s.jsxs("p",{className:"text-gray-400 mb-4",children:[g.undoRequest.fromName," ",j({en:"wants to undo their last move.",vi:"muá»‘n hoÃ n tÃ¡c nÆ°á»›c Ä‘i cuá»‘i."})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsxs("button",{onClick:()=>x.acceptUndo(),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-500 text-white rounded-lg transition-colors",children:[s.jsx(t,{className:"w-4 h-4"})," ",j({en:"Accept",vi:"Äá»“ng Ã½"})]}),s.jsxs("button",{onClick:()=>x.declineUndo(),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-red-600 hover:bg-red-500 text-white rounded-lg transition-colors",children:[s.jsx(a,{className:"w-4 h-4"})," ",j({en:"Decline",vi:"Tá»« chá»‘i"})]})]})]})}),g.undoRequest&&g.undoRequest.fromId===u&&s.jsx("div",{className:"text-yellow-400 text-sm",children:j({en:"Waiting for opponent to accept undo...",vi:"Äang chá» Ä‘á»‘i thá»§ cháº¥p nháº­n hoÃ n tÃ¡c..."})}),"ended"===g.gamePhase&&s.jsxs("div",{className:"text-center p-4 bg-slate-800 rounded-lg",children:[s.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:j({en:"Game Over!",vi:"Káº¿t thÃºc!"})}),s.jsx("p",{className:"text-gray-300",children:"draw"===g.winner?j({en:"It's a draw!",vi:"HÃ²a!"}):g.winner===u?j({en:"ðŸŽ‰ You won!",vi:"ðŸŽ‰ Báº¡n tháº¯ng!"}):`${g.players.find(e=>e.id===g.winner)?.username} ${j({en:"wins!",vi:"tháº¯ng!"})}`})]}),s.jsxs("div",{className:"flex gap-3 flex-wrap justify-center",children:["waiting"===g.gamePhase&&s.jsxs(s.Fragment,{children:[N&&!g.players[1].id&&s.jsxs("button",{onClick:()=>x.requestAddBot(),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white rounded-lg transition-colors",children:[s.jsx(l,{className:"w-4 h-4"})," ",j({en:"Add Bot",vi:"ThÃªm Bot"})]}),N&&x.canStartGame()&&s.jsxs("button",{onClick:()=>x.requestStartGame(),className:"flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-500 text-white rounded-lg transition-colors",children:[s.jsx(r,{className:"w-4 h-4"})," ",j({en:"Start Game",vi:"Báº¯t Ä‘áº§u"})]})]}),"playing"===g.gamePhase&&s.jsx(s.Fragment,{children:v>=0&&g.moveHistory.length>0&&!g.undoRequest&&s.jsxs("button",{onClick:()=>x.requestUndo(),className:"flex items-center gap-2 px-4 py-2 bg-slate-600 hover:bg-slate-500 text-white rounded-lg transition-colors",children:[s.jsx(i,{className:"w-4 h-4"})," ",j({en:"Undo",vi:"HoÃ n tÃ¡c"})]})}),"ended"===g.gamePhase&&s.jsxs("button",{onClick:()=>x.requestNewGame(),className:"flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-500 text-white rounded-lg transition-colors",children:[s.jsx(o,{className:"w-4 h-4"})," ",j({en:"Play Again",vi:"ChÆ¡i láº¡i"})]})]}),s.jsxs("div",{className:"w-full max-w-[400px]",children:["playing"===g.gamePhase&&s.jsx("div",{className:"grid grid-cols-7 gap-1 mb-1",children:Array(c).fill(null).map((e,n)=>{const t="playing"===g.gamePhase&&w&&!x.isColumnFull(n),a=p===n&&t;return s.jsx("div",{className:`\n                  aspect-square flex items-center justify-center\n                  rounded-full transition-all duration-200\n                  ${t?"cursor-pointer":"cursor-default"}\n                `,onMouseEnter:()=>f(n),onMouseLeave:()=>f(null),onClick:()=>C(n),children:a&&s.jsx("div",{className:`\n                      w-[80%] h-[80%] rounded-full opacity-60\n                      ${"red"===b?"bg-red-500":"bg-yellow-400"}\n                    `})},n)})}),s.jsx("div",{className:"grid gap-1 p-2 bg-blue-800 rounded-lg shadow-xl",style:{gridTemplateColumns:`repeat(${c}, 1fr)`},onMouseLeave:()=>f(null),children:Array(d).fill(null).map((e,n)=>Array(c).fill(null).map((e,t)=>s.jsx("div",{className:"cursor-pointer",onMouseEnter:()=>f(t),onClick:()=>C(t),children:q(n,t)},`${n}-${t}`)))})]})]})}export{m as default};
