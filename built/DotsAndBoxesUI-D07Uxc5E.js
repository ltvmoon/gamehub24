import{j as e}from"./index-DvVjFfh0.js";import{i as s,Y as t,l as a}from"./react-vendor-DdoU0YZ6.js";import"./socket-DRbsQkF5.js";import"./zustand-BHVQ_asN.js";import"./chess-DTd62Tay.js";const l={red:"bg-red-500/30",blue:"bg-blue-500/30"},r={red:"text-red-500",blue:"text-blue-500"};function n({game:n,currentUserId:o}){const[i,d]=s.useState(n.getState());s.useEffect(()=>{n.onUpdate(d),d(n.getState()),n.requestSync()},[n]);const c=i.players[i.currentPlayerIndex],x=c?.id===o,m=i.isGameEnded,u=(e,s,t)=>{x&&!m&&"playing"===i.gamePhase&&("horizontal"===e&&i.horizontalLines[s][t]||"vertical"===e&&i.verticalLines[s][t]||n.requestPlaceLine(e,s,t))},g=i.gridSize,h=100/(g-1);return e.jsxs("div",{className:"flex flex-col items-center gap-6 p-4 w-full max-w-2xl mx-auto",children:[e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("h2",{className:"text-3xl font-bold text-white",children:"Dots & Boxes"}),m?e.jsxs("div",{className:"text-2xl font-bold text-white mb-2",children:["Game Over!"," ","draw"===i.winner?"It's a Draw!":`${i.players.find(e=>e.id===i.winner)?.username} Wins!`]}):e.jsx("div",{className:"text-lg",children:x?e.jsx("span",{className:"text-green-400 font-bold animate-pulse",children:"Your Turn!"}):e.jsxs("span",{className:"text-gray-300",children:["Waiting for"," ",e.jsx("span",{className:`${r[c.color]} font-bold`,children:c.username}),"..."]})}),e.jsx("div",{className:"flex gap-4 md:gap-8 bg-slate-800 p-4 rounded-xl shadow-lg border border-slate-700 w-full justify-center",children:i.players.map((s,t)=>e.jsxs("div",{className:`flex flex-col items-center gap-2 p-2 rounded-lg transition-all ${i.currentPlayerIndex!==t||m?"border-2 border-transparent":"bg-slate-700 scale-105 shadow-md border-2 "+("red"===s.color?"border-red-500":"border-blue-500")} ${s.id?"":"opacity-60"}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full "+("red"===s.color?"bg-red-500":"bg-blue-500")}),e.jsx("div",{className:"text-sm font-bold "+("red"===s.color?"text-red-500":"text-blue-500"),children:s.id?s.username:"Empty"})]}),s.id?e.jsx("div",{className:"flex flex-col items-center",children:e.jsx("div",{className:"text-3xl font-black "+("red"===s.color?"text-red-500":"text-blue-500"),children:s.score})}):e.jsx("div",{className:"h-9 flex items-center",children:e.jsx("span",{className:"text-gray-500 text-xs italic",children:"Waiting..."})}),n.isHostUser&&!m&&i.boxes.every(e=>e.every(e=>null===e))&&e.jsx("div",{className:"mt-1",children:s.isBot?e.jsx("button",{onClick:()=>n.requestRemoveBot(t),className:"text-xs bg-red-900 hover:bg-red-800 text-red-100 px-2 py-1 rounded",children:"Remove Bot"}):!s.id&&e.jsx("button",{onClick:()=>n.requestAddBot(t),className:"text-xs bg-cyan-900 hover:bg-cyan-800 text-cyan-100 px-2 py-1 rounded",children:"+ Add Bot"})})]},`player-${t}`))})]}),e.jsx("div",{className:"relative aspect-square w-full max-w-[400px] bg-slate-900 p-6 rounded-lg shadow-2xl select-none touch-none border-2 border-slate-700",children:e.jsxs("div",{className:"relative w-full h-full",children:[i.boxes.map((s,t)=>s.map((s,a)=>{const n=i.players.find(e=>e.id===s);return n?e.jsx("div",{className:`absolute flex items-center justify-center rounded-sm transition-all duration-500 scale-90 ${l[n.color]}`,style:{top:t*h+"%",left:a*h+"%",width:`${h}%`,height:`${h}%`},children:e.jsx("div",{className:`text-2xl font-bold opacity-50 ${r[n.color]}`,children:n.username[0].toUpperCase()})},`box-${t}-${a}`):null})),i.horizontalLines.map((s,t)=>s.map((s,a)=>{const l="horizontal"===i.lastLine?.type&&i.lastLine.row===t&&i.lastLine.col===a;return e.jsxs("div",{onClick:()=>u("horizontal",t,a),className:`absolute h-2 -translate-y-1/2 cursor-pointer transition-colors duration-200\n                            ${s?l?"bg-yellow-400 shadow-[0_0_15px_rgba(250,204,21,0.8)] animate-pulse":"bg-cyan-400 shadow-[0_0_10px_rgba(34,211,238,0.5)]":"playing"===i.gamePhase?"bg-slate-700 hover:bg-slate-500":"bg-slate-800 cursor-default"}\n                             z-10`,style:{top:t*h+"%",left:a*h+"%",width:`${h}%`},children:[!s&&"playing"===i.gamePhase&&e.jsx("div",{className:"absolute inset-0 -top-2 -bottom-2"}),s&&e.jsx("div",{className:"absolute inset-0 rounded-full "+(l?"bg-yellow-400":"bg-cyan-400")})]},`h-${t}-${a}`)})),i.verticalLines.map((s,t)=>s.map((s,a)=>{const l="vertical"===i.lastLine?.type&&i.lastLine.row===t&&i.lastLine.col===a;return e.jsxs("div",{onClick:()=>u("vertical",t,a),className:`absolute w-2 -translate-x-1/2 cursor-pointer transition-colors duration-200\n                            ${s?l?"bg-yellow-400 shadow-[0_0_15px_rgba(250,204,21,0.8)] animate-pulse":"bg-cyan-400 shadow-[0_0_10px_rgba(34,211,238,0.5)]":"playing"===i.gamePhase?"bg-slate-700 hover:bg-slate-500":"bg-slate-800 cursor-default"}\n                             z-10`,style:{top:t*h+"%",left:a*h+"%",height:`${h}%`},children:[!s&&"playing"===i.gamePhase&&e.jsx("div",{className:"absolute inset-0 -left-2 -right-2"}),s&&e.jsx("div",{className:"absolute inset-0 rounded-full "+(l?"bg-yellow-400":"bg-cyan-400")})]},`v-${t}-${a}`)})),Array(g).fill(0).map((s,t)=>Array(g).fill(0).map((s,a)=>e.jsx("div",{className:"absolute w-4 h-4 bg-slate-400 rounded-full -translate-x-1/2 -translate-y-1/2 z-20 shadow-sm",style:{top:t*h+"%",left:a*h+"%"}},`dot-${t}-${a}`)))]})}),i.undoRequest&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:e.jsxs("div",{className:"bg-slate-800 p-4 rounded-lg shadow-xl border border-slate-600 flex flex-col gap-3",children:[e.jsxs("p",{className:"text-white",children:[i.players.find(e=>e.id===i.undoRequest?.requesterId)?.username," ","requested to undo the last move."]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>n.rejectUndo(),className:"px-3 py-1 bg-red-600 hover:bg-red-500 text-white rounded",children:"Reject"}),e.jsx("button",{onClick:()=>n.approveUndo(),className:"px-3 py-1 bg-green-600 hover:bg-green-500 text-white rounded",children:"Approve"})]})]})}),e.jsxs("div",{className:"flex flex-wrap gap-3 justify-center",children:[!m&&"waiting"===i.gamePhase&&n.isHostUser&&e.jsxs("button",{onClick:()=>n.requestStartGame(),disabled:!n.canStartGame(),className:"flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-500 text-white rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(t,{className:"w-4 h-4"})," Start Game"]}),n.isHostUser&&"waiting"!==i.gamePhase&&e.jsxs("button",{onClick:()=>n.requestNewGame(),className:"flex items-center gap-2 px-4 py-2 bg-yellow-700 hover:bg-yellow-600 text-white rounded-lg transition-colors",children:[e.jsx(a,{className:"w-4 h-4"})," ",m?"Play Again":"Reset Game"]}),"playing"===i.gamePhase&&!m&&e.jsx("button",{onClick:()=>n.requestUndo(),className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg",children:"Undo"})]})]})}export{n as default};
