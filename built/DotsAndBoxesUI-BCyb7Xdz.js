import{u as e,j as t}from"./index-DlLMIGP-.js";import{c as s,Y as l,z as a,u as n,ak as i,X as r}from"./react-vendor-CFBbA8Qg.js";import"./BaseGame-Dl0OcroL.js";import{u as o}from"./useGameState-Dq_coqf5.js";import"./socket-DRbsQkF5.js";import"./zustand-0-40VJZq.js";const d={red:"bg-red-500/60",blue:"bg-blue-500/60"},c={red:"text-red-500",blue:"text-blue-500"};function x({game:x,currentUserId:h}){const m=x,[u]=o(m),[g,p]=s.useState(!1),{ti:b,ts:v}=e(),j=u.players[u.currentPlayerIndex],f=j?.id===h,y=u.isGameEnded,w=100/(u.gridSize-1);return t.jsxs("div",{className:"flex flex-col items-center gap-6 p-4 w-full max-w-2xl mx-auto pb-16!",children:[t.jsxs("div",{className:"flex flex-col items-center gap-2",children:[t.jsx("h2",{className:"text-3xl font-bold text-white",children:"Dots & Boxes"}),t.jsx("div",{className:"flex gap-4 @md:gap-8 bg-slate-800 p-4 rounded-xl shadow-lg border border-slate-700 w-full justify-center",children:u.players.map((e,s)=>t.jsxs("div",{className:`flex flex-col items-center gap-2 p-2 rounded-lg transition-all ${u.currentPlayerIndex!==s||y?"border-2 border-transparent":"bg-slate-700 scale-105 shadow-md border-2 "+("red"===e?.color?"border-red-500":"border-blue-500")} ${e?.id?"":"opacity-60"}`,children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-3 h-3 rounded-full "+("red"===e?.color?"bg-red-500":"bg-blue-500")}),t.jsx("div",{className:"text-sm font-bold "+("red"===e?.color?"text-red-500":"text-blue-500"),children:e?.id?e.username:b({en:"Empty",vi:"Trống"})})]}),e?.id?t.jsx("div",{className:"flex flex-col items-center",children:t.jsx("div",{className:"text-3xl font-black "+("red"===e?.color?"text-red-500":"text-blue-500"),children:e.score})}):t.jsx("div",{className:"h-9 flex items-center",children:t.jsx("span",{className:"text-gray-500 text-xs italic",children:b({en:"Waiting...",vi:"Đang chờ..."})})}),m.isHost&&!y&&u.boxes.every(e=>e.every(e=>null===e))&&t.jsx("div",{className:"mt-1",children:e?.isBot?t.jsx("button",{onClick:()=>m.requestRemoveBot(s),className:"text-xs bg-red-900 hover:bg-red-800 text-red-100 px-2 py-1 rounded",children:b({en:"Remove Bot",vi:"Xóa Bot"})}):!e?.id&&t.jsx("button",{onClick:()=>m.requestAddBot(s),className:"text-xs bg-cyan-900 hover:bg-cyan-800 text-cyan-100 px-2 py-1 rounded",children:b({en:"+ Add Bot",vi:"+ Thêm Bot"})})})]},`player-${s}`))}),y||"playing"!==u.gamePhase?y?t.jsxs("div",{className:"text-2xl font-bold text-white mb-2",children:["Game Over!"," ","draw"===u.winner?b({en:"It's a Draw!",vi:"Hòa!"}):`${u.players.find(e=>e?.id===u.winner)?.username} ${b({en:"Wins!",vi:"Thắng!"})}`]}):null:t.jsx("div",{className:"text-lg",children:f?t.jsx("span",{className:"text-green-400 font-bold animate-pulse",children:b({en:"Your Turn!",vi:"Lượt của bạn!"})}):t.jsxs("span",{className:"text-gray-300",children:[b({en:"Waiting for",vi:"Đang chờ"})," ",t.jsx("span",{className:`${c[j?.color||"red"]} font-bold`,children:j?.username}),"..."]})})]}),t.jsxs("div",{className:"flex flex-wrap gap-3 justify-center",children:[!y&&"waiting"===u.gamePhase&&m.isHost&&t.jsxs("button",{onClick:()=>m.requestStartGame(),disabled:!m.canStartGame(),className:"flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-500 text-white rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[t.jsx(a,{className:"w-4 h-4"})," ",b({en:"Start Game",vi:"Bắt đầu"})]}),m.isHost&&"waiting"!==u.gamePhase&&t.jsxs("button",{onClick:()=>m.requestNewGame(),className:"flex items-center gap-2 px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg transition-colors",children:[t.jsx(n,{className:"w-4 h-4"})," ",b(y?{en:"Play Again",vi:"Chơi lại"}:{en:"New Game",vi:"Ván mới"})]}),"playing"===u.gamePhase&&!y&&t.jsx("button",{onClick:()=>m.requestUndo(),className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg",children:b({en:"Undo",vi:"Hoàn tác"})})]}),u.undoRequest&&(()=>{const e=u.players.find(e=>e?.id===u.undoRequest?.requesterId);return t.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:t.jsxs("div",{className:"bg-slate-800 p-4 rounded-lg shadow-xl border border-slate-600 flex flex-col gap-3",children:[t.jsxs("p",{className:"text-white",children:[e?.username," ",b({en:"requested to undo the last move.",vi:"muốn hoàn tác nước đi vừa rồi."})]}),e?.id!=m.userId?t.jsxs("div",{className:"flex justify-end gap-2",children:[t.jsx("button",{onClick:()=>m.rejectUndo(),className:"px-3 py-1 bg-red-600 hover:bg-red-500 text-white rounded",children:b({en:"Reject",vi:"Từ chối"})}),t.jsx("button",{onClick:()=>m.approveUndo(),className:"px-3 py-1 bg-green-600 hover:bg-green-500 text-white rounded",children:b({en:"Approve",vi:"Đồng ý"})})]}):t.jsxs("div",{className:"text-white",children:[b({en:"Waiting for approval...",vi:"Đang chờ phê duyệt..."}),t.jsx("button",{onClick:()=>m.rejectUndo(),className:"px-3 py-1 bg-red-600 hover:bg-red-500 text-white rounded",children:b({en:"Cancel",vi:"Hủy"})})]})]})})})(),t.jsx("div",{className:"relative aspect-square w-full max-w-[400px] bg-slate-900 p-6 rounded-lg shadow-2xl select-none touch-none border-2 border-slate-700",children:t.jsxs("div",{className:"relative w-full h-full",children:[u.boxes.map((e,s)=>e.map((e,l)=>{const a=u.players.find(t=>t?.id===e);return a?t.jsx("div",{className:`absolute flex items-center justify-center rounded-sm transition-all duration-500 scale-90 ${d[a.color]}`,style:{top:s*w+"%",left:l*w+"%",width:`${w}%`,height:`${w}%`},children:t.jsx("div",{className:`text-2xl font-bold ${c[a.color]}`,children:a.username[0].toUpperCase()})},`box-${s}-${l}`):null})),["horizontal","vertical"].map(e=>("horizontal"===e?u.horizontalLines:u.verticalLines).map((s,l)=>s.map((s,a)=>{const n=u.lastLine?.type===e&&u.lastLine.row===l&&u.lastLine.col===a,i="horizontal"===e;return t.jsx("div",{onClick:()=>{return t=e,s=l,n=a,void(f&&!y&&"playing"===u.gamePhase&&("horizontal"===t&&u.horizontalLines[s][n]||"vertical"===t&&u.verticalLines[s][n]||m.requestPlaceLine(t,s,n)));var t,s,n},className:`absolute cursor-pointer transition-all duration-200 rounded-full z-10\n                      ${i?"h-2 -translate-y-1/2":"w-2 -translate-x-1/2"}\n                      ${s?n?"bg-yellow-400 shadow-[0_0_12px_4px_rgba(250,204,21,0.7)] animate-pulse":"bg-white shadow-[0_0_8px_2px_rgba(255,255,255,0.4)]":"playing"===u.gamePhase?"bg-slate-800 hover:bg-slate-400":"bg-slate-800 cursor-default"}`,style:{top:l*w+"%",left:a*w+"%",...i?{width:`${w}%`}:{height:`${w}%`}},children:!s&&"playing"===u.gamePhase&&t.jsx("div",{className:"absolute inset-0 "+(i?"-top-2 -bottom-2":"-left-2 -right-2")})},`${e[0]}-${l}-${a}`)})))]})}),t.jsx("button",{onClick:()=>p(!0),className:"fixed bottom-4 right-4 p-3 bg-slate-700 hover:bg-slate-600 rounded-full text-yellow-500 transition-colors z-40 shadow-lg border border-slate-500",title:v({en:"Rules",vi:"Luật chơi"}),children:t.jsx(i,{size:24})}),g&&l.createPortal(t.jsx("div",{className:"fixed inset-0 z-60 flex items-center justify-center bg-black/80 p-4",children:t.jsxs("div",{className:"bg-slate-900 border border-slate-700 rounded-xl max-w-lg w-full max-h-[85vh] overflow-y-auto shadow-2xl relative",children:[t.jsxs("div",{className:"flex justify-between sticky top-0 p-4 pr-2 bg-slate-900",children:[t.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[t.jsx(i,{className:"w-6 h-6 text-yellow-500"}),b({en:"Game Rules: Dots And Boxes",vi:"Luật Chơi: Nối Điểm"})]}),t.jsx("button",{onClick:()=>p(!1),className:"p-2 hover:bg-white/10 rounded-full transition-colors text-slate-400 hover:text-white",children:t.jsx(r,{className:"w-5 h-5"})})]}),t.jsx("div",{className:"p-4 pt-0 space-y-4 text-slate-300 leading-relaxed",children:t.jsxs("div",{className:"space-y-4",children:[t.jsx("p",{children:b({en:"Dots and Boxes is a pencil-and-paper game for two players. The game starts with an empty grid of dots.",vi:"Dots and Boxes (Nối điểm) là trò chơi dành cho 2 người. Trò chơi bắt đầu với một lưới các điểm."})}),t.jsx("h3",{className:"text-lg font-bold text-yellow-400 mt-4",children:b({en:"Objective",vi:"Mục tiêu"})}),t.jsx("ul",{className:"list-disc pl-5 space-y-1",children:t.jsx("li",{children:b({en:"Complete more boxes (squares) than your opponent.",vi:"Hoàn thành (đóng) được nhiều ô vuông hơn đối thủ."})})}),t.jsx("h3",{className:"text-lg font-bold text-yellow-400 mt-4",children:b({en:"Gameplay",vi:"Luật chơi"})}),t.jsxs("ul",{className:"list-disc pl-5 space-y-1",children:[t.jsx("li",{children:b({en:"Players take turns adding a single horizontal or vertical line between two unjoined adjacent dots.",vi:"Người chơi lần lượt thêm một đoạn thẳng ngang hoặc dọc giữa 2 điểm chưa được nối."})}),t.jsx("li",{children:b({en:"A player who completes the fourth side of a 1x1 box earns one point and MUST take another turn.",vi:"Người vẽ cạnh thứ 4 của một ô vuông 1x1 sẽ được điểm và PHẢI đi thêm lượt nữa."})}),t.jsx("li",{children:b({en:"If you complete multiple boxes in one move, you keep playing until you fail to complete a box.",vi:"Nếu bạn đóng được nhiều ô trong một lượt, bạn tiếp tục đi cho đến khi không đóng được ô nào nữa."})})]}),t.jsx("h3",{className:"text-lg font-bold text-yellow-400 mt-4",children:b({en:"Winning",vi:"Chiến thắng"})}),t.jsxs("ul",{className:"list-disc pl-5 space-y-1",children:[t.jsx("li",{children:b({en:"The game ends when no more lines can be placed.",vi:"Trò chơi kết thúc khi không còn đường nào để vẽ."})}),t.jsx("li",{children:b({en:"The player with the most boxes wins.",vi:"Người có nhiều ô nhất sẽ thắng."})})]})]})})]})}),document.body)]})}export{x as default};
