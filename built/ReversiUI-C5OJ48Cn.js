import{u as e,b as s,S as t,j as n,h as a}from"./index-BkzCa3Vk.js";import{b as l,c as i,ao as r,$ as o,X as c,x as h,a5 as d,aj as m,as as x}from"./react-vendor-BLrGWV4Q.js";import"./BaseGame-bmSYX9GV.js";import{R as g,a as u,b as p}from"./types-BukwI6ND.js";import{u as b}from"./useGameState-C567eRPc.js";import{u as v}from"./usePrevious-DMw_GTo_.js";import"./socket-DRbsQkF5.js";import"./zustand-02WYhwzk.js";function j({game:j,currentUserId:f}){const w=j,[y]=b(w),[N,k]=l.useState(!1),{ti:C,ts:q}=e(),{confirm:B}=s(),P=w.getMyColor(),A=y.turn,I=A===P,G=y.gamePhase===g.PLAYING&&null!==P&&I?w.getValidMoves(P):[],L=w.getPieceCount();v(y.turn,(e,s)=>{y.gamePhase===g.PLAYING&&null!==e&&t.playTurnSwitch(I)});const R=(e,s)=>G.some(([t,n])=>t===e&&n===s),T=(e,s,t)=>{const a=R(s,t),l=8*s+t,i=y.lastMove===l,r=y.flippedCells?.includes(l),o=1===e?"black":2===e?"white":null;return n.jsxs("button",{onClick:()=>((e,s)=>{y.gamePhase===g.PLAYING&&I&&R(e,s)&&w.requestMove(e,s)})(s,t),className:`\n          aspect-square flex items-center justify-center\n          bg-green-700 border border-green-800\n          ${a?"cursor-pointer hover:bg-green-600":"cursor-default"}\n          ${i?"ring-2 ring-yellow-400 ring-inset":""}\n        `,disabled:!a,children:[o&&n.jsx("div",{className:`\n              w-[80%] h-[80%] rounded-full shadow-lg\n              ${"black"===o?"bg-gray-900":"bg-white"}\n              ${i?"scale-110":""}\n              ${r?"animate-flip":""}\n            `,style:r?{animation:"flip 0.4s ease-in-out"}:void 0}),!o&&a&&n.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500/50"})]},`${s}-${t}`)},$=[y.players.black,y.players.white],H=A===u.BLACK?y.players.black:y.players.white;return n.jsxs("div",{className:"flex flex-col items-center gap-4 p-4 w-full max-w-2xl mx-auto pb-16!",children:[n.jsx("style",{dangerouslySetInnerHTML:{__html:"\n@keyframes flip {\n  0% { transform: rotateY(0deg) scale(1); }\n  50% { transform: rotateY(90deg) scale(1.1); }\n  100% { transform: rotateY(180deg) scale(1); }\n}\n"}}),n.jsxs("div",{className:"flex flex-col gap-2 p-4 bg-slate-800 rounded-lg w-full max-w-md",children:[n.jsx("h3",{className:"text-sm font-medium text-gray-400 mb-1",children:C({en:"Players",vi:"Ng∆∞·ªùi ch∆°i"})}),$.map((e,s)=>{const t=0===s?u.BLACK:u.WHITE,l=y.turn===t;return n.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg "+(l?"bg-slate-600 ring-2 ring-yellow-400":"bg-slate-700"),children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:`w-6 h-6 rounded-full text-center ${t===u.BLACK?"bg-gray-900":"bg-white"} ${t===u.BLACK?"text-white":"text-black"}`,children:t===u.BLACK?L.black:L.white}),n.jsxs("span",{className:"text-white",children:[e?e.username:"(waiting...)",e&&a(e.flags,p.BOT)&&" ü§ñ"]})]}),e&&a(e.flags,p.BOT)&&w.isHost&&n.jsx("button",{onClick:()=>w.requestRemoveBot(),className:"text-xs px-2 py-1 bg-red-600 hover:bg-red-500 text-white rounded transition-colors",children:C({en:"Remove",vi:"X√≥a"})}),w.isHost&&!e&&n.jsxs("button",{onClick:()=>w.requestAddBot(),className:"flex items-center gap-2 p-2 bg-blue-600 hover:bg-blue-500 text-white rounded-lg transition-colors",children:[n.jsx(r,{className:"w-4 h-4"}),C({en:"Add Bot",vi:"Th√™m Bot"})]})]},s)})]}),y.gamePhase===g.PLAYING&&n.jsxs("div",{className:"text-lg text-gray-400",children:[I?n.jsx("span",{className:"text-green-400",children:C({en:"Your turn!",vi:"L∆∞·ª£t c·ªßa b·∫°n!"})}):n.jsxs("span",{children:[C({en:"Waiting for",vi:"ƒêang ch·ªù"})," ",H?.username," ",C({en:"...",vi:"..."})]}),0===G.length&&I&&n.jsx("span",{className:"ml-2 text-yellow-400",children:C({en:"No valid moves - must pass",vi:"Kh√¥ng c√≥ n∆∞·ªõc ƒëi h·ª£p l·ªá - ph·∫£i b·ªè l∆∞·ª£t"})})]}),y.undoRequest&&y.undoRequest.fromId!==f&&n.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-slate-800 rounded-xl p-6 shadow-xl max-w-sm mx-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:C({en:"Undo Request",vi:"Y√™u c·∫ßu ho√†n t√°c"})}),n.jsxs("p",{className:"text-gray-400 mb-4",children:[y.undoRequest.fromName," ",C({en:"wants to undo their last move",vi:"mu·ªën ho√†n t√°c n∆∞·ªõc ƒëi v·ª´a r·ªìi"})]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsxs("button",{onClick:()=>w.acceptUndo(),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-500 text-white rounded-lg transition-colors",children:[n.jsx(o,{className:"w-4 h-4"})," ",C({en:"Accept",vi:"ƒê·ªìng √Ω"})]}),n.jsxs("button",{onClick:()=>w.declineUndo(),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-red-600 hover:bg-red-500 text-white rounded-lg transition-colors",children:[n.jsx(c,{className:"w-4 h-4"})," ",C({en:"Decline",vi:"T·ª´ ch·ªëi"})]})]})]})}),y.undoRequest&&y.undoRequest.fromId===f&&n.jsx("div",{className:"text-yellow-400 text-sm",children:C({en:"Waiting for opponent to accept undo...",vi:"ƒêang ch·ªù ƒë·ªëi th·ªß ch·∫•p nh·∫≠n ho√†n t√°c..."})}),y.gamePhase===g.ENDED&&n.jsxs("div",{className:"text-center p-4 bg-slate-800 rounded-lg",children:[n.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:C({en:"Game Over!",vi:"Tr√≤ ch∆°i k·∫øt th√∫c!"})}),n.jsx("p",{className:"text-gray-300 mb-4",children:"draw"===y.winner?C({en:"It's a draw!",vi:"H√≤a!"}):y.winner===f?C({en:"üéâ You won!",vi:"üéâ B·∫°n ƒë√£ th·∫Øng!"}):`${$.find(e=>e?.id===y.winner)?.username||C({en:"Opponent",vi:"ƒê·ªëi th·ªß"})}{" "}\n                  ${C({en:"wins!",vi:"th·∫Øng!"})}`}),n.jsxs("p",{className:"text-gray-400",children:[C({en:"Black",vi:"ƒêen"}),": ",L.black," |"," ",C({en:"White",vi:"Tr·∫Øng"}),": ",L.white]})]}),n.jsxs("div",{className:"flex gap-3",children:[y.gamePhase===g.WAITING&&n.jsxs(n.Fragment,{children:[w.isHost&&w.canStartGame()&&n.jsxs("button",{onClick:()=>w.requestStartGame(),className:"flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-500 text-white rounded-lg transition-colors",children:[n.jsx(h,{className:"w-4 h-4"})," ",C({en:"Start Game",vi:"B·∫Øt ƒë·∫ßu"})]}),!w.isHost&&n.jsx("div",{className:"text-gray-400",children:C({en:"Waiting for host to start game...",vi:"ƒêang ch·ªù ch·ªß ph√≤ng b·∫Øt ƒë·∫ßu tr√≤ ch∆°i..."})})]}),y.gamePhase===g.PLAYING&&n.jsxs(n.Fragment,{children:[I&&0===G.length&&n.jsx("button",{onClick:()=>w.requestPass(),className:"px-4 py-2 bg-yellow-600 hover:bg-yellow-500 text-white rounded-lg transition-colors",children:C({en:"Pass Turn",vi:"B·ªè l∆∞·ª£t"})}),(y.moveHistory?.length||0)>0&&!y.undoRequest&&n.jsxs("button",{onClick:()=>w.requestUndo(),className:"flex items-center gap-2 px-4 py-2 bg-slate-600 hover:bg-slate-500 text-white rounded-lg transition-colors",children:[n.jsx(d,{className:"w-4 h-4"})," ",C({en:"Undo",vi:"Ho√†n t√°c"})]}),w.isHost&&n.jsxs("button",{onClick:async()=>{await B(q({en:"Are you sure you want to reset the game?",vi:"B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën reset tr√≤ ch∆°i?"}),q({en:"Reset Game",vi:"Ch∆°i l·∫°i"}))&&w.requestNewGame()},className:"flex items-center gap-2 px-4 py-2 bg-slate-600 hover:bg-slate-500 text-white rounded-lg transition-colors",children:[n.jsx(m,{className:"w-4 h-4"})," ",C({en:"Play Again",vi:"Ch∆°i l·∫°i"})]})]}),y.gamePhase===g.ENDED&&n.jsxs("button",{onClick:()=>w.requestNewGame(),className:"flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-500 text-white rounded-lg transition-colors",children:[n.jsx(m,{className:"w-4 h-4"})," ",C({en:"Play Again",vi:"Ch∆°i l·∫°i"})]})]}),n.jsx("div",{className:"grid grid-cols-8 gap-0 rounded-lg overflow-hidden shadow-xl border-4 border-green-900 w-full max-w-[500px]",children:(()=>{const e=BigInt("0x"+(y.blackBoard||"0")),s=BigInt("0x"+(y.whiteBoard||"0"));return Array.from({length:64}).map((t,n)=>{const a=Math.floor(n/8),l=n%8,i=e>>BigInt(n)&1n,r=s>>BigInt(n)&1n;return T(i?1:r?2:0,a,l)})})()}),n.jsx("button",{onClick:()=>k(!0),className:"fixed bottom-4 right-4 p-3 bg-slate-700 hover:bg-slate-600 rounded-full text-yellow-500 transition-colors z-40 shadow-lg border border-slate-500",title:q({en:"Rules",vi:"Lu·∫≠t ch∆°i"}),children:n.jsx(x,{size:24})}),N&&i.createPortal(n.jsx("div",{className:"fixed inset-0 z-60 flex items-center justify-center bg-black/80 p-4",children:n.jsxs("div",{className:"bg-slate-900 border border-slate-700 rounded-xl max-w-lg w-full shadow-2xl relative",children:[n.jsxs("div",{className:"flex justify-between p-4 pr-2",children:[n.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[n.jsx(x,{className:"w-6 h-6 text-yellow-500"}),C({en:"Game Rules: Reversi",vi:"Lu·∫≠t Ch∆°i: C·ªù L·∫≠t"})]}),n.jsx("button",{onClick:()=>k(!1),className:"p-2 hover:bg-white/10 rounded-full transition-colors text-slate-400 hover:text-white",children:n.jsx(c,{className:"w-5 h-5"})})]}),n.jsx("div",{className:"p-4 pt-0 space-y-4 text-slate-300 leading-relaxed max-h-[80vh] overflow-y-auto",children:n.jsxs("div",{className:"space-y-4",children:[n.jsx("p",{children:C({en:"Reversi (Othello) is a strategy board game for two players, played on an 8√ó8 uncheckered board.",vi:"Reversi (Othello) l√† tr√≤ ch∆°i chi·∫øn thu·∫≠t cho 2 ng∆∞·ªùi, ch∆°i tr√™n b√†n c·ªù 8x8."})}),n.jsx("h3",{className:"text-lg font-bold text-yellow-400 mt-4",children:C({en:"Objective",vi:"M·ª•c ti√™u"})}),n.jsx("ul",{className:"list-disc pl-5 space-y-1",children:n.jsx("li",{children:C({en:"Have the majority of disks on the board turned to display your color when the last playable empty square is filled.",vi:"Chi·∫øm ƒë∆∞·ª£c nhi·ªÅu √¥ tr√™n b√†n c·ªù nh·∫•t b·∫±ng m√†u c·ªßa m√¨nh khi tr√≤ ch∆°i k·∫øt th√∫c."})})}),n.jsx("h3",{className:"text-lg font-bold text-yellow-400 mt-4",children:C({en:"Gameplay",vi:"Lu·∫≠t ch∆°i"})}),n.jsxs("ul",{className:"list-disc pl-5 space-y-1",children:[n.jsx("li",{children:C({en:"Players take turns placing disks on the board with their assigned color facing up.",vi:"Ng∆∞·ªùi ch∆°i l·∫ßn l∆∞·ª£t ƒë·∫∑t qu√¢n c·ªù c·ªßa m√¨nh l√™n b√†n."})}),n.jsx("li",{children:C({en:"During a play, any disks of the opponent's color that are in a straight line and bounded by the disk just placed and another disk of the current player's color are turned over to the current player's color.",vi:"N·∫øu b·∫°n ƒë·∫∑t qu√¢n c·ªù k·∫πp gi·ªØa qu√¢n ƒë·ªëi ph∆∞∆°ng (h√†ng ngang, d·ªçc, ch√©o), c√°c qu√¢n ƒë√≥ s·∫Ω b·ªã l·∫≠t sang m√†u c·ªßa b·∫°n."})}),n.jsx("li",{children:C({en:"If you cannot make a valid move (capture at least one opponent's disk), you must pass your turn.",vi:"N·∫øu kh√¥ng c√≥ n∆∞·ªõc ƒëi h·ª£p l·ªá (ƒÉn √≠t nh·∫•t 1 qu√¢n), b·∫°n ph·∫£i b·ªè l∆∞·ª£t."})})]}),n.jsx("h3",{className:"text-lg font-bold text-yellow-400 mt-4",children:C({en:"Winning",vi:"Chi·∫øn th·∫Øng"})}),n.jsxs("ul",{className:"list-disc pl-5 space-y-1",children:[n.jsx("li",{children:C({en:"The game ends when neither player can move.",vi:"Tr√≤ ch∆°i k·∫øt th√∫c khi c·∫£ 2 b√™n kh√¥ng c√≤n n∆∞·ªõc ƒëi."})}),n.jsx("li",{children:C({en:"The player with the most disks on the board wins.",vi:"Ng∆∞·ªùi c√≥ nhi·ªÅu qu√¢n c·ªù nh·∫•t tr√™n b√†n s·∫Ω th·∫Øng."})})]})]})})]})}),document.body)]})}export{j as default};
