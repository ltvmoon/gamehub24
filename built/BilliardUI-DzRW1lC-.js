import{a as e,u as t,b as n,S as s,j as l}from"./index-BuwAuyRH.js";import{b as r,c as a,ar as i,aK as c,aI as o,aL as u,at as h,as as d,y as m,av as x,X as f}from"./react-vendor-BPKxesl1.js";import"./BaseGame-Bn3OX2xB.js";import{G as g,T as b,a as v,P as p,b as y,B as w,f as j,h as N,d as k}from"./types-B48lfkkO.js";import{u as M}from"./useGameState-6Sg9cn7I.js";import{u as S}from"./usePrevious-CkimZINh.js";import"./socket-DRbsQkF5.js";import"./zustand-BVhu8Aq7.js";function P({game:P}){const T=P,[I]=M(T),{username:A}=e(),{ti:C,ts:B}=t(),{confirm:R}=n(),[L,E]=r.useState(!1),G=r.useRef(null),Y=r.useRef(null),F=r.useRef(I.balls),W=r.useRef(new Map),D=r.useRef([]),q=r.useRef(new Set),[H,O]=r.useState(!1),[X,z]=r.useState(0),[K,Q]=r.useState(0),[U,$]=r.useState(null),[J,V]=r.useState(1),[Z,_]=r.useState(!1),[ee,te]=r.useState("drag"),[ne,se]=r.useState(!1),le=T.getMySlot()===I.currentTurn&&I.gamePhase===g.PLAYING;S(I.currentTurn,(e,t)=>{I.gamePhase===g.PLAYING&&null!==e&&s.playTurnSwitch(le)});const re=r.useRef(()=>{}),ae=r.useRef(!1);ae.current=H;const ie=r.useRef(0);ie.current=X;const ce=r.useRef(0);ce.current=K,r.useEffect(()=>{const e=()=>{if(Y.current){const e=Y.current.clientWidth-16,t=.8*window.innerHeight,n=window.innerWidth*(Z?.6:.8),s=Z?v:b,l=Z?b:v,r=Math.min(e,n)/s,a=t/l,i=Math.min(1,r,a);V(i)}};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[Z]);const oe=r.useRef({isAiming:H,aimAngle:X,aimPower:K,mousePos:U});oe.current={isAiming:H,aimAngle:X,aimPower:K,mousePos:U};const ue=r.useRef(J);ue.current=J;const he=r.useRef(Z);he.current=Z;const de=r.useRef(ee);de.current=ee;const me=r.useRef(ne);me.current=ne;const xe=r.useRef(null),fe=r.useRef(new Map);r.useEffect(()=>{const e=new Map,t=e=>{const t=document.createElement("canvas"),n=2*w;t.width=n,t.height=n;const s=t.getContext("2d");if(!s)return t;const l=w,r=j[e]||"#FFF";return s.fillStyle=r,s.beginPath(),s.arc(l,l,w,0,2*Math.PI),s.fill(),e>=9&&e<=15&&(s.fillStyle="white",s.beginPath(),s.arc(l,l,.7*w,0,2*Math.PI),s.fill()),0!==e&&(s.fillStyle=e>=9&&e<=15?"black":"white",s.font=`bold ${w}px Arial`,s.textAlign="center",s.textBaseline="middle",s.save(),s.translate(l,l),Z&&s.rotate(Math.PI/2),s.fillText(e.toString(),0,0),s.restore()),s.fillStyle="rgba(255, 255, 255, 0.3)",s.beginPath(),s.arc(l-.3*w,l-.3*w,.3*w,0,2*Math.PI),s.fill(),t};for(let n=0;n<=15;n++)e.set(n,t(n));fe.current=e},[Z]),r.useEffect(()=>{xe.current||(xe.current=document.createElement("canvas"));const e=xe.current;e.width=b,e.height=v;const t=e.getContext("2d");if(t){t.fillStyle="#1a472a",t.fillRect(0,0,b,v),t.strokeStyle="#5d3a1a",t.lineWidth=20,t.strokeRect(10,10,b-20,v-20),t.fillStyle="#111";for(const e of p)t.beginPath(),t.arc(e.x,e.y,y,0,2*Math.PI),t.fill()}},[]);const ge=r.useCallback((e,t,n)=>{e.fillStyle="rgba(0, 0, 0, 0.3)",e.beginPath(),e.arc(t.x+2,t.y+2,w,0,2*Math.PI),e.fill(),n&&(e.save(),e.globalAlpha=.6,e.fillStyle=n,e.beginPath(),e.arc(t.x,t.y,w+7,0,2*Math.PI),e.fill(),e.restore());const s=fe.current.get(t.id);s&&e.drawImage(s,t.x-w,t.y-w)},[]),be=r.useCallback(()=>{const e=G.current;if(!e)return;const t=e.getContext("2d");if(!t)return;const n=ue.current,{isAiming:s,aimAngle:l,aimPower:r}=oe.current,a=he.current;e.width=(a?v:b)*n,e.height=(a?b:v)*n,t.save(),t.scale(n,n),a&&(t.translate(0,b),t.rotate(-Math.PI/2)),xe.current?t.drawImage(xe.current,0,0):(t.fillStyle="#1a472a",t.fillRect(0,0,b,v)),W.current.forEach((e,n)=>{if(e.length<2)return;const s=j[n]||"#FFF";for(let l=0;l<e.length;l++){const n=e[l],r=l/e.length*.4;t.beginPath(),t.arc(n.x,n.y,w,0,2*Math.PI),t.fillStyle=s,t.globalAlpha=r,t.fill(),t.fillStyle="rgba(255, 255, 255, 0.3)",t.beginPath(),t.arc(n.x-.3*w,n.y-.3*w,.3*w,0,2*Math.PI),t.globalAlpha=r,t.fill()}t.globalAlpha=1});const i=T.state,c=T.getMySlot(),o=c===i.currentTurn&&i.gamePhase===g.PLAYING&&!i.isSimulating,u=c?i.players[c].ballType:null,h=u&&0===F.current.filter(e=>!e.pocketed&&e.type===u).length;for(const f of F.current){if(f.pocketed)continue;let e;o&&(0===f.id?e="#00ff88":u&&(h&&8===f.id?e="#ffcc00":f.type===u&&(e="#00aaff"))),ge(t,f,e)}const d=F.current.find(e=>0===e.id&&!e.pocketed);if(s&&d&&(r>0||"slider"===de.current)){let e=d.x,n=d.y,s=l,i=2e3;const c=4;t.beginPath(),t.moveTo(e,n);for(let l=0;l<c;l++){let r=i,c={x:e+Math.cos(s)*r,y:n+Math.sin(s)*r},o=null,u=null,h={x:0,y:0};const d=Math.cos(s),m=Math.sin(s);if(d>0){const t=(b-w-e)/d;t<r&&(r=t,o="wall",h={x:-1,y:0},c={x:b-w,y:n+t*m})}else{const t=(w-e)/d;t<r&&(r=t,o="wall",h={x:1,y:0},c={x:w,y:n+t*m})}if(m>0){const t=(v-w-n)/m;t<r&&(r=t,o="wall",h={x:0,y:-1},c={x:e+t*d,y:v-w})}else{const t=(w-n)/m;t<r&&(r=t,o="wall",h={x:0,y:1},c={x:e+t*d,y:w})}for(const t of F.current){if(0===t.id||t.pocketed)continue;if(Math.abs(t.x-e)>r&&Math.abs(t.y-n)>r)continue;const s=e-t.x,l=n-t.y,a=2*(d*s+m*l),i=a*a-4*(s*s+l*l-4*w*w);if(i>=0){const s=(-a-Math.sqrt(i))/2,l=(-a+Math.sqrt(i))/2;let h=-1;s>.001?h=s:l>.001&&(h=l),h>0&&h<r&&(r=h,c={x:e+h*d,y:n+h*m},o="ball",u=t)}}if(t.strokeStyle="rgba(255, 255, 255, 0.3)",t.lineWidth=1,t.setLineDash([5,5]),t.lineTo(c.x,c.y),t.stroke(),t.beginPath(),t.moveTo(c.x,c.y),t.save(),t.beginPath(),t.arc(c.x,c.y,w,0,2*Math.PI),t.fillStyle="rgba(255, 255, 255, 0.2)",t.fill(),t.strokeStyle="rgba(255, 255, 255, 0.5)",t.lineWidth=1,t.setLineDash([]),t.stroke(),t.fillStyle="rgba(255, 255, 255, 0.8)",t.font="10px Arial",t.textAlign="center",t.textBaseline="middle",a?(t.save(),t.translate(c.x,c.y),t.rotate(Math.PI/2),t.fillText((l+1).toString(),0,0),t.restore()):t.fillText((l+1).toString(),c.x,c.y),t.restore(),"ball"===o&&u){const e=Math.atan2(u.y-c.y,u.x-c.x);t.strokeStyle="rgba(255, 255, 255, 0.8)",t.lineWidth=2,t.setLineDash([]),t.beginPath(),t.moveTo(u.x,u.y),t.lineTo(u.x+75*Math.cos(e),u.y+75*Math.sin(e)),t.stroke();break}if("wall"!==o)break;{const t=.7;let l=Math.cos(s),a=Math.sin(s);if(0!==h.x?l=-l*t:a=-a*t,s=Math.atan2(a,l),e=c.x+.1*h.x,n=c.y+.1*h.y,i-=r,i<=0)break}}const o=200,u=w+5+50*r,h=d.x-Math.cos(l)*u,m=d.y-Math.sin(l)*u,x=h-Math.cos(l)*o,f=m-Math.sin(l)*o;t.strokeStyle="#8B4513",t.lineWidth=6,t.lineCap="round",t.beginPath(),t.moveTo(h,m),t.lineTo(x,f),t.stroke(),t.fillStyle="#E6D5B8",t.beginPath(),t.arc(h,m,4,0,2*Math.PI),t.fill()}const m=performance.now(),x=[];for(const f of D.current){const e=(m-f.startTime)/f.duration;if(e<1){x.push(f);for(let n=0;n<5;n++){const s=Math.max(0,e-.15*n);if(s>0&&s<1){const e=y+40*s,n=.6*(1-s);t.strokeStyle="white",t.globalAlpha=n,t.lineWidth=3-2*s,t.beginPath(),t.arc(f.x,f.y,e,0,2*Math.PI),t.stroke()}}t.globalAlpha=1}}D.current=x,t.restore()},[ge]);re.current=be;const ve=r.useRef(null),pe=r.useCallback(()=>{if(ve.current)return;console.log("startAnimationLoop");const e=()=>{let t=!1;const n=F.current;for(const e of n){const n=W.current.get(e.id)||[];Math.sqrt(e.vx*e.vx+e.vy*e.vy)>.05&&!e.pocketed?(t=!0,n.push({x:e.x,y:e.y}),n.length>20&&n.shift(),W.current.set(e.id,n)):n.length>0&&(t=!0,n.shift(),0===n.length?W.current.delete(e.id):W.current.set(e.id,n))}if(D.current.length>0&&(t=!0),!t){n.some(e=>!e.pocketed&&(Math.abs(e.vx)>.05||Math.abs(e.vy)>.05))&&(t=!0)}re.current(),ve.current=t?requestAnimationFrame(e):null};ve.current=requestAnimationFrame(e)},[]);r.useEffect(()=>{const e=requestAnimationFrame(be);return()=>cancelAnimationFrame(e)},[be,H,X,K,J]),r.useEffect(()=>{const e=T.onUpdate(e=>{F.current=e.balls,(e.gamePhase===g.WAITING||1===e.currentTurn&&e.gamePhase===g.PLAYING&&!e.lastShot)&&W.current.clear(),e.isSimulating?I.isSimulating||pe():re.current()});return T.onFrame(e=>{let t=!1;const n=new Set(e.filter(e=>e.pocketed).map(e=>e.id));for(const s of e){if(s.pocketed&&!q.current.has(s.id))for(const e of p){const n=s.x-e.x,l=s.y-e.y;if(n*n+l*l<(2*y)**2){D.current.push({x:e.x,y:e.y,color:j[s.id]||"#FFF",startTime:performance.now(),duration:2e3}),t=!0;break}}!s.pocketed&&(Math.abs(s.vx)>.01||Math.abs(s.vy)>.01)&&(t=!0)}q.current=n,F.current=e,t?pe():ve.current||re.current()}),()=>{e()}},[T,pe]),r.useEffect(()=>()=>{ve.current&&cancelAnimationFrame(ve.current)},[]);const ye=r.useCallback((e,t)=>{const n=G.current;if(!n)return null;const s=n.getBoundingClientRect(),l=(e-s.left)/J,r=(t-s.top)/J;return Z?{x:b-r,y:l}:{x:l,y:r}},[J,Z]),we=r.useCallback((e,t)=>{const n=F.current.find(e=>0===e.id&&!e.pocketed);if(!n)return;const s=ye(e,t);if(s)if($(s),"slider"===de.current){const e=Math.atan2(s.y-n.y,s.x-n.x);z(e)}else{const e=Math.atan2(s.y-n.y,s.x-n.x)+Math.PI;z(e);const t=s.x-n.x,l=s.y-n.y,r=Math.sqrt(t*t+l*l),a=Math.min(1,r/200);Q(a)}},[ye]),je=r.useCallback(()=>{"drag"===de.current?ce.current>=N?(W.current.clear(),T.shoot(ie.current,ce.current),O(!1),Q(0),$(null)):(O(!1),$(null)):se(!1)},[T]);r.useEffect(()=>{const e=e=>{ae.current&&("slider"!==de.current||me.current)&&we(e.clientX,e.clientY)},t=()=>{ae.current&&je()},n=e=>{if(ae.current&&e.touches.length>0){if(!ae.current)return;if("slider"===de.current&&!me.current)return;we(e.touches[0].clientX,e.touches[0].clientY)}},s=()=>{ae.current&&je()};return document.addEventListener("mousemove",e,{passive:!1}),document.addEventListener("mouseup",t),document.addEventListener("touchmove",n,{passive:!1}),document.addEventListener("touchend",s),()=>{document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",t),document.removeEventListener("touchmove",n),document.removeEventListener("touchend",s)}},[we,je]),r.useEffect(()=>{const e=G.current;if(!e)return;const t=t=>{if(!le||T.state.isSimulating)return;const n=F.current.find(e=>0===e.id&&!e.pocketed);if(!n)return;if(0===t.touches.length)return;const s=t.touches[0].clientX,l=t.touches[0].clientY,r=e.getBoundingClientRect(),a=ue.current,i=he.current,c=de.current,o=(s-r.left)/a,u=(l-r.top)/a;let h=o,d=u;i&&(h=b-u,d=o);let m=!1;if("slider"===c)m=!0;else{const e=h-n.x,t=d-n.y;Math.sqrt(e*e+t*t)<3*w&&(m=!0)}m&&(t.preventDefault(),O(!0),"slider"===c&&se(!0),$({x:h,y:d}),we(s,l))},n=e=>{ae.current&&("slider"!==de.current||me.current)&&e.preventDefault()};return e.addEventListener("touchstart",t,{passive:!1}),e.addEventListener("touchmove",n,{passive:!1}),()=>{e.removeEventListener("touchstart",t),e.removeEventListener("touchmove",n)}},[T,we]);const Ne=e=>{const t=I.players[e];return t.id?"BOT"===t.id?"Bot ü§ñ":t.id===T.userId?A||C({en:"You",vi:"B·∫°n"}):t.username||C({en:"Player",vi:"Ng∆∞·ªùi ch∆°i"})+" "+e:C({en:"(waiting...)",vi:"(ƒëang ch·ªù...)"})},ke=e=>{const t=I.players[e].ballType;return null===t?"":t===k.SOLID?C({en:"(Solids 1-7)",vi:"(Tr∆°n 1-7)"}):C({en:"(Stripes 9-15)",vi:"(S·ªçc 9-15)"})};return l.jsxs("div",{className:"flex flex-col items-center gap-4 p-4 w-full max-w-4xl mx-auto pb-12!",ref:Y,children:[l.jsxs("div",{className:"flex flex-col gap-2 p-4 bg-slate-800 rounded-lg w-full max-w-[500px]",children:[l.jsx("h3",{className:"text-sm font-medium text-gray-400 mb-1",children:"Players"}),[1,2].map(e=>{const t=I.players[e],n=I.currentTurn===e&&I.gamePhase===g.PLAYING,s=t.id===T.userId,r="BOT"===t.id;return l.jsxs("div",{className:`\n                flex items-center justify-between p-3 rounded-lg\n                ${n?"bg-slate-600 ring-2 ring-blue-400":"bg-slate-700"}\n              `,children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-6 h-6 rounded-full "+(1===e?"bg-blue-500":"bg-red-500")}),l.jsxs("div",{children:[l.jsxs("span",{className:"text-white font-medium",children:[Ne(e),s&&t.id&&C({en:" (You)",vi:" (B·∫°n)"})]}),l.jsx("span",{className:"text-gray-400 text-sm ml-2",children:ke(e)})]})]}),r&&T.isHost&&I.gamePhase===g.WAITING&&l.jsx("button",{onClick:()=>T.removeBot(),className:"text-xs px-2 py-1 bg-red-600 hover:bg-red-500 text-white rounded transition-colors",children:C({en:"Remove",vi:"X√≥a"})}),!t.id&&T.isHost&&2===e&&I.gamePhase===g.WAITING&&l.jsxs("button",{onClick:()=>T.addBot(),className:"text-xs px-2 py-1 bg-blue-600 hover:bg-blue-500 text-white rounded transition-colors flex items-center gap-1",children:[l.jsx(i,{className:"w-3 h-3"})," ",C({en:"Add Bot",vi:"Th√™m Bot"})]})]},e)})]}),l.jsxs("div",{className:"flex gap-4",children:[l.jsxs("button",{className:"flex items-center justify-center p-3 bg-slate-700 hover:bg-slate-600 rounded-full transition-colors",onClick:()=>_(!Z),children:[l.jsx(c,{className:"w-5 h-5 text-white"}),l.jsx("span",{className:"text-white text-sm ml-2",children:C({en:"Rotate table",vi:"Xoay b√†n"})})]}),l.jsxs("button",{className:"flex items-center justify-center p-3 bg-slate-700 hover:bg-slate-600 rounded-full transition-colors",onClick:()=>te("drag"===ee?"slider":"drag"),title:C({en:"Switch Control Mode",vi:"ƒê·ªïi ki·ªÉu hi·ªán khi·ªÉn"}),children:["drag"===ee?l.jsx(o,{className:"w-5 h-5 text-white"}):l.jsx(u,{className:"w-5 h-5 text-white"}),l.jsx("span",{className:"text-white text-sm ml-2",children:C("drag"===ee?{en:"Drag Mode",vi:"K√©o th·∫£"}:{en:"Slider Mode",vi:"Thanh l·ª±c"})})]})]}),I.gamePhase===g.PLAYING&&!I.winner&&l.jsx("div",{className:"text-lg text-gray-400",children:I.isSimulating?l.jsx("span",{className:"text-yellow-400",children:C({en:"Balls in motion...",vi:"B√≥ng ƒëang lƒÉn..."})}):le?l.jsxs("span",{className:"text-green-400 flex items-center gap-2",children:[l.jsx(h,{className:"w-5 h-5"}),C("drag"===ee?{en:"Your turn! Click near the cue ball and drag to aim.",vi:"L∆∞·ª£t c·ªßa b·∫°n! Nh·∫•p v√†o b√≥ng tr·∫Øng v√† k√©o ƒë·ªÉ ng·∫Øm."}:{en:"Your turn! Click to aim, set power, then Shoot.",vi:"L∆∞·ª£t c·ªßa b·∫°n! Ch·ªçn h∆∞·ªõng, ch·ªânh l·ª±c, r·ªìi b·∫•m B·∫ÆN."})]}):l.jsx("span",{children:C({en:"Waiting for opponent...",vi:"ƒêang ch·ªù ƒë·ªëi th·ªß..."})})}),I.turnMessage&&l.jsx("div",{className:"text-yellow-400 text-sm",children:I.turnMessage}),l.jsxs("div",{className:"relative bg-slate-800 p-2 rounded-xl shadow-2xl overflow-hidden",children:[l.jsx("canvas",{ref:G,width:b*J,height:v*J,className:"rounded-lg cursor-crosshair block",style:{touchAction:"none"},onMouseDown:e=>{if(!le||I.isSimulating)return;const t=F.current.find(e=>0===e.id&&!e.pocketed);if(!t)return;const n="touches"in e?e.touches[0].clientX:e.clientX,s="touches"in e?e.touches[0].clientY:e.clientY,l=ye(n,s);if(!l)return;let r=!1;if("slider"===ee)r=!0;else{const e=l.x-t.x,n=l.y-t.y;Math.sqrt(e*e+n*n)<5*w&&(r=!0)}r&&(e.preventDefault(),O(!0),"slider"===ee&&se(!0),we(n,s))},onMouseMove:e=>{if(!H)return;if("slider"===ee&&!ne)return;e.preventDefault();const t="touches"in e?e.touches[0].clientX:e.clientX,n="touches"in e?e.touches[0].clientY:e.clientY;we(t,n)}}),(I.winner||I.gamePhase===g.WAITING)&&l.jsxs("div",{className:"absolute inset-0 z-10 flex flex-col items-center justify-center bg-black/60 glass-blur rounded-lg animate-fade-in",children:[I.winner&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"text-3xl font-bold text-green-400 mb-6 drop-shadow-lg animate-bounce",children:["üèÜ ",Ne(I.winner)," ",C({en:"wins!",vi:"th·∫Øng!"})]}),T.isHost?l.jsxs("button",{onClick:()=>T.requestReset(),className:"px-8 py-4 bg-green-600 hover:bg-green-500 rounded-full text-white font-bold text-lg transition-transform hover:scale-105 flex items-center gap-2 shadow-lg",children:[l.jsx(d,{className:"w-6 h-6"}),C({en:"Play Again",vi:"Ch∆°i l·∫°i"})]}):l.jsx("div",{className:"text-slate-300 animate-pulse",children:C({en:"Waiting for host to restart...",vi:"ƒêang ch·ªù ch·ªß ph√≤ng ch∆°i l·∫°i..."})})]}),!I.winner&&I.gamePhase===g.WAITING&&l.jsx(l.Fragment,{children:T.isHost?T.canStartGame()?l.jsxs("button",{onClick:()=>T.startGame(),className:"px-8 py-4 bg-green-600 hover:bg-green-500 rounded-full text-white font-bold text-lg transition-transform hover:scale-105 flex items-center gap-2 shadow-lg",children:[l.jsx(m,{className:"w-6 h-6"}),C({en:"Start Game",vi:"B·∫Øt ƒë·∫ßu"})]}):l.jsx("div",{className:"flex flex-col items-center gap-3",children:l.jsx("div",{className:"text-lg text-slate-300 font-medium",children:C({en:"Waiting for opponent...",vi:"ƒêang ch·ªù ƒë·ªëi th·ªß..."})})}):l.jsxs("div",{className:"flex flex-col items-center gap-3",children:[l.jsx("div",{className:"w-12 h-12 border-4 border-slate-500 border-t-white rounded-full animate-spin"}),l.jsx("div",{className:"text-lg text-slate-300 font-medium",children:C({en:"Waiting for host to start...",vi:"ƒêang ch·ªù ch·ªß ph√≤ng b·∫Øt ƒë·∫ßu..."})})]})})]})]}),H&&"drag"===ee&&l.jsxs("div",{className:"w-full max-w-xs",children:[l.jsxs("div",{className:"text-sm text-gray-400 mb-1",children:[C({en:"Power",vi:"L·ª±c"}),": ",Math.round(100*K),"%"]}),l.jsx("div",{className:"h-3 bg-slate-700 rounded-full overflow-hidden",children:l.jsx("div",{className:"h-full transition-all duration-75",style:{width:100*K+"%",background:"linear-gradient(90deg, #22c55e, #eab308, #ef4444)"}})})]}),"slider"===ee&&l.jsxs("div",{className:"flex flex-col gap-3 w-full max-w-md p-4 bg-slate-800/80 rounded-xl glass-blur border border-slate-700",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-white font-medium",children:C({en:"Power",vi:"L·ª±c b·∫Øn"})}),l.jsxs("span",{className:"font-bold "+(K>.8?"text-red-500":K>.5?"text-yellow-500":"text-green-500"),children:[Math.round(100*K),"%"]})]}),l.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:K,disabled:!le||I.isSimulating,onChange:e=>{Q(parseFloat(e.target.value)),H||O(!0)},className:"w-full h-4 bg-slate-700 rounded-lg appearance-none cursor-pointer accent-blue-500"}),l.jsx("button",{onClick:()=>{K>=N&&(W.current.clear(),T.shoot(X,K),O(!1),Q(0),$(null))},disabled:K<N||!le||I.isSimulating,className:"\n                    w-full py-3 rounded-lg font-bold text-lg shadow-lg transition-all\n                    disabled:bg-slate-600 disabled:text-slate-400 disabled:cursor-not-allowed\n                    bg-red-600 hover:bg-red-500 text-white hover:scale-[1.02] active:scale-[0.98]\n                ",children:C({en:"SHOOT!",vi:"B·∫ÆN!"})})]}),T.isHost&&I.gamePhase!==g.WAITING&&l.jsxs("button",{onClick:async()=>{await R(B({en:"Are you sure you want to reset the game?",vi:"B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën ch∆°i l·∫°i kh√¥ng?"}),B({en:"Reset game",vi:"Ch∆°i l·∫°i"}))&&T.requestReset()},className:"flex items-center gap-2 px-4 py-2 bg-slate-600 hover:bg-slate-500 rounded-full ",children:[l.jsx(d,{className:"w-4 h-4"}),C({en:"New game",vi:"Ch∆°i l·∫°i"})]}),l.jsx("button",{onClick:()=>E(!0),className:"fixed bottom-4 right-4 p-3 bg-slate-700 hover:bg-slate-600 rounded-full text-yellow-500 transition-colors z-40 shadow-lg border border-slate-500",title:B({en:"Game Rules",vi:"Lu·∫≠t ch∆°i"}),children:l.jsx(x,{size:24})}),L&&a.createPortal(l.jsx("div",{className:"fixed inset-0 bg-black/80 glass-blur z-100 flex items-center justify-center p-4 text-left",children:l.jsxs("div",{className:"bg-slate-900 border border-slate-700 rounded-xl max-w-lg w-full shadow-2xl relative",children:[l.jsxs("div",{className:"flex justify-between p-4 pr-2",children:[l.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[l.jsx(x,{className:"w-6 h-6 text-yellow-500"}),C({en:"Game Rules: Billiard (8-Ball)",vi:"Lu·∫≠t Ch∆°i: Bi-a (8 B√≥ng)"})]}),l.jsx("button",{onClick:()=>E(!1),className:"p-2 hover:bg-white/10 rounded-full transition-colors text-slate-400 hover:text-white",children:l.jsx(f,{className:"w-5 h-5"})})]}),l.jsxs("div",{className:"p-4 space-y-6 text-slate-300 leading-relaxed font-sans text-sm md:text-base max-h-[80vh] overflow-y-auto",children:[l.jsxs("section",{children:[l.jsx("h3",{className:"text-lg font-bold text-yellow-400 mb-2",children:C({en:"Objective",vi:"M·ª•c ti√™u"})}),l.jsx("p",{children:C({en:"Pocket all of your assigned balls (Solids or Stripes) and then pocket the 8-Ball to win.",vi:"ƒê∆∞a t·∫•t c·∫£ c√°c bi m·ª•c ti√™u c·ªßa b·∫°n (bi Tr∆°n ho·∫∑c bi S·ªçc) v√†o l·ªó v√† cu·ªëi c√πng l√† bi s·ªë 8 ƒë·ªÉ chi·∫øn th·∫Øng."})})]}),l.jsxs("section",{children:[l.jsx("h3",{className:"text-lg font-bold text-yellow-400 mb-2",children:C({en:"Key Rules",vi:"Quy T·∫Øc Ch√≠nh"})}),l.jsxs("ul",{className:"list-disc pl-5 space-y-1",children:[l.jsx("li",{children:C({en:"First ball pocketed determines your group (Solids 1-7 or Stripes 9-15).",vi:"Bi ƒë·∫ßu ti√™n v√†o l·ªó s·∫Ω quy·∫øt ƒë·ªãnh nh√≥m bi c·ªßa b·∫°n (Tr∆°n 1-7 ho·∫∑c S·ªçc 9-15)."})}),l.jsx("li",{children:C({en:"You must hit your own ball group first.",vi:"Ban ph·∫£i ch·∫°m v√†o bi thu·ªôc nh√≥m c·ªßa m√¨nh tr∆∞·ªõc."})}),l.jsx("li",{children:C({en:"Pocketing the wrong ball or scratching (white ball in pocket) is a foul.",vi:"ƒê∆∞a nh·∫ßm bi v√†o l·ªó ho·∫∑c l√†m r∆°i bi tr·∫Øng l√† ph·∫°m l·ªói."})}),l.jsxs("li",{children:[l.jsx("strong",{className:"text-red-400",children:C({en:"Do NOT pocket the 8-Ball early!",vi:"KH√îNG ƒë∆∞·ª£c l√†m r∆°i bi s·ªë 8 s·ªõm!"})})," ",C({en:"You lose instantly if the 8-Ball enters a pocket before your other balls are cleared.",vi:"B·∫°n s·∫Ω thua ngay l·∫≠p t·ª©c n·∫øu bi s·ªë 8 v√†o l·ªó tr∆∞·ªõc khi b·∫°n d·ªçn s·∫°ch c√°c bi kh√°c."})]})]})]}),l.jsxs("section",{children:[l.jsx("h3",{className:"text-lg font-bold text-yellow-400 mb-2",children:C({en:"Controls",vi:"ƒêi·ªÅu Khi·ªÉn"})}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{children:[l.jsx("strong",{className:"text-blue-400",children:C({en:"Drag Mode (Default):",vi:"Ch·∫ø ƒë·ªô K√©o (M·∫∑c ƒë·ªãnh):"})}),l.jsx("p",{className:"ml-2 text-slate-400 text-sm",children:C({en:"Click/Touch near the cue ball and pull back to aim and set power. Release to shoot.",vi:"Nh·∫•p/Ch·∫°m g·∫ßn bi tr·∫Øng v√† k√©o v·ªÅ ph√≠a sau ƒë·ªÉ ng·∫Øm v√† ch·ªânh l·ª±c. Th·∫£ tay ƒë·ªÉ b·∫Øn."})})]}),l.jsxs("div",{children:[l.jsx("strong",{className:"text-blue-400",children:C({en:"Slider Mode:",vi:"Ch·∫ø ƒë·ªô Thanh l·ª±c:"})}),l.jsx("p",{className:"ml-2 text-slate-400 text-sm",children:C({en:"Click anywhere to place aim stick. Use the slider below to set power, then press SHOOT.",vi:"Nh·∫•p b·∫•t k·ª≥ ƒë√¢u ƒë·ªÉ ƒë·∫∑t g·∫≠y ng·∫Øm. D√πng thanh tr∆∞·ª£t b√™n d∆∞·ªõi ƒë·ªÉ ch·ªânh l·ª±c, sau ƒë√≥ b·∫•m n√∫t B·∫ÆN."})})]})]})]})]})]})}),document.body)]})}export{P as default};
