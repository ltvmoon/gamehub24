import{j as e,C as s,e as n}from"./index-DvVjFfh0.js";import{i as t,y as a,X as l,J as r,Y as i,M as o,l as d}from"./react-vendor-DdoU0YZ6.js";import"./socket-DRbsQkF5.js";import"./zustand-BHVQ_asN.js";import"./chess-DTd62Tay.js";function c({game:c,currentUserId:m}){const[u,x]=t.useState(c.getState()),[g,h]=t.useState(null);t.useEffect(()=>{c.onUpdate(x),x(c.getState()),c.requestSync()},[c]);const p=c.getMyPlayerIndex(),f=p>=0?u.players[p].color:null,j=u.players[u.currentPlayerIndex],b=j?.id===m,y=c.isHostUser,w=e=>{"playing"===u.gamePhase&&b&&(c.isColumnFull(e)||c.requestMove(e))},N=(s,n)=>{const t=u.board[s][n],a=((e,s)=>u.winningCells?.some(n=>n.row===e&&n.col===s))(s,n),l=((e,s)=>u.lastMove?.row===e&&u.lastMove?.col===s)(s,n);return e.jsx("div",{className:"aspect-square flex items-center justify-center bg-blue-700 p-1",children:e.jsx("div",{className:`\n            w-full h-full rounded-full transition-all duration-200\n            ${t?"":"bg-blue-900"}\n            ${"red"===t?"bg-red-500":""}\n            ${"yellow"===t?"bg-yellow-400":""}\n            ${a?"ring-4 ring-white animate-pulse":""}\n            ${l&&!a?"ring-2 ring-white/50":""}\n          `,style:l&&t?{animation:"drop 0.5s ease-out"}:void 0})},`${s}-${n}`)};return e.jsxs("div",{className:"flex flex-col items-center gap-4 p-4 w-full max-w-lg mx-auto",children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:"\n@keyframes drop {\n  0% { transform: translateY(-400px); }\n  60% { transform: translateY(10px); }\n  80% { transform: translateY(-5px); }\n  100% { transform: translateY(0); }\n}\n"}}),e.jsxs("div",{className:"flex flex-col gap-2 p-4 bg-slate-800 rounded-lg w-full",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-400 mb-1",children:"Players"}),u.players.map((s,n)=>e.jsxs("div",{className:`\n              flex items-center justify-between p-2 rounded-lg\n              ${u.currentPlayerIndex===n&&"playing"===u.gamePhase?"bg-slate-600 ring-2 ring-blue-400":"bg-slate-700"}\n            `,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`\n                  w-6 h-6 rounded-full\n                  ${"red"===s.color?"bg-red-500":"bg-yellow-400"}\n                `}),e.jsxs("span",{className:"text-white",children:[s.id?s.username:"(waiting...)",s.isBot&&" ðŸ¤–",s.id===m&&" (You)"]})]}),s.isBot&&y&&"waiting"===u.gamePhase&&e.jsx("button",{onClick:()=>c.requestRemoveBot(),className:"text-xs px-2 py-1 bg-red-600 hover:bg-red-500 text-white rounded transition-colors",children:"Remove"})]},n))]}),"playing"===u.gamePhase&&e.jsx("div",{className:"text-lg text-gray-400",children:b?e.jsx("span",{className:"text-green-400",children:"Your turn! Click a column."}):e.jsxs("span",{children:["Waiting for ",j?.username,"..."]})}),u.undoRequest&&u.undoRequest.fromId!==m&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-slate-800 rounded-xl p-6 shadow-xl max-w-sm mx-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Undo Request"}),e.jsxs("p",{className:"text-gray-400 mb-4",children:[u.undoRequest.fromName," wants to undo their last move."]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>c.acceptUndo(),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-500 text-white rounded-lg transition-colors",children:[e.jsx(a,{className:"w-4 h-4"})," Accept"]}),e.jsxs("button",{onClick:()=>c.declineUndo(),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-red-600 hover:bg-red-500 text-white rounded-lg transition-colors",children:[e.jsx(l,{className:"w-4 h-4"})," Decline"]})]})]})}),u.undoRequest&&u.undoRequest.fromId===m&&e.jsx("div",{className:"text-yellow-400 text-sm",children:"Waiting for opponent to accept undo..."}),"ended"===u.gamePhase&&e.jsxs("div",{className:"text-center p-4 bg-slate-800 rounded-lg",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Game Over!"}),e.jsx("p",{className:"text-gray-300",children:"draw"===u.winner?"It's a draw!":u.winner===m?"ðŸŽ‰ You won!":`${u.players.find(e=>e.id===u.winner)?.username} wins!`})]}),e.jsxs("div",{className:"flex gap-3 flex-wrap justify-center",children:["waiting"===u.gamePhase&&e.jsxs(e.Fragment,{children:[y&&!u.players[1].id&&e.jsxs("button",{onClick:()=>c.requestAddBot(),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white rounded-lg transition-colors",children:[e.jsx(r,{className:"w-4 h-4"})," Add Bot"]}),y&&c.canStartGame()&&e.jsxs("button",{onClick:()=>c.requestStartGame(),className:"flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-500 text-white rounded-lg transition-colors",children:[e.jsx(i,{className:"w-4 h-4"})," Start Game"]})]}),"playing"===u.gamePhase&&e.jsx(e.Fragment,{children:p>=0&&u.moveHistory.length>0&&!u.undoRequest&&e.jsxs("button",{onClick:()=>c.requestUndo(),className:"flex items-center gap-2 px-4 py-2 bg-slate-600 hover:bg-slate-500 text-white rounded-lg transition-colors",children:[e.jsx(o,{className:"w-4 h-4"})," Undo"]})}),"ended"===u.gamePhase&&e.jsxs("button",{onClick:()=>c.requestNewGame(),className:"flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-500 text-white rounded-lg transition-colors",children:[e.jsx(d,{className:"w-4 h-4"})," Play Again"]})]}),e.jsxs("div",{className:"w-full max-w-[400px]",children:["playing"===u.gamePhase&&e.jsx("div",{className:"grid grid-cols-7 gap-1 mb-1",children:Array(s).fill(null).map((s,n)=>{const t="playing"===u.gamePhase&&b&&!c.isColumnFull(n),a=g===n&&t;return e.jsx("div",{className:`\n                  aspect-square flex items-center justify-center\n                  rounded-full transition-all duration-200\n                  ${t?"cursor-pointer":"cursor-default"}\n                `,onMouseEnter:()=>h(n),onMouseLeave:()=>h(null),onClick:()=>w(n),children:a&&e.jsx("div",{className:`\n                      w-[80%] h-[80%] rounded-full opacity-60\n                      ${"red"===f?"bg-red-500":"bg-yellow-400"}\n                    `})},n)})}),e.jsx("div",{className:"grid gap-1 p-2 bg-blue-800 rounded-lg shadow-xl",style:{gridTemplateColumns:`repeat(${s}, 1fr)`},onMouseLeave:()=>h(null),children:Array(n).fill(null).map((n,t)=>Array(s).fill(null).map((s,n)=>e.jsx("div",{className:"cursor-pointer",onMouseEnter:()=>h(n),onClick:()=>w(n),children:N(t,n)},`${t}-${n}`)))})]})]})}export{c as default};
