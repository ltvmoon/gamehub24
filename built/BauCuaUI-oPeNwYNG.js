import{u as e,j as s,b as t,d as l}from"./index-DMqWoiuV.js";import{c as a,ab as n,X as r,J as i,B as c,a9 as o,a3 as d,$ as x,ae as m,u as h,az as u,ax as b,aC as g}from"./react-vendor-BYtLKAeB.js";import{S as p,f as j,M as f,A as v,P as y,J as N,b as w}from"./index-D0AV-RDe.js";import"./socket-DRbsQkF5.js";import"./zustand-BLoNJECv.js";function k({isOpen:t,onClose:l,onConfirm:c,onClear:o,symbol:d,currentBalance:x,currentBet:m}){const{ti:h}=e(),[u,b]=a.useState(m);if(a.useEffect(()=>{t&&b(m)},[t,m]),!t||!d)return null;const g=x;return n.createPortal(s.jsx("div",{className:"fixed inset-0 z-100 flex items-center justify-center bg-black/80 backdrop-blur-sm p-4",children:s.jsxs("div",{className:"w-full max-w-md bg-slate-900 border border-slate-700 rounded-xl shadow-2xl overflow-hidden animate-in fade-in zoom-in duration-200",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-800 bg-slate-800/50",children:[s.jsxs("h3",{className:"text-lg font-bold text-white flex items-center gap-2",children:[s.jsx("span",{children:p[d].emoji}),s.jsx("span",{children:h({vi:`C∆∞·ª£c v√†o ${p[d].vi}`,en:`Bet on ${p[d].en}`})})]}),s.jsx("button",{onClick:l,className:"p-2 text-slate-400 hover:text-white hover:bg-slate-700 rounded-lg transition-colors",children:s.jsx(r,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex justify-between text-sm text-slate-400",children:[s.jsx("label",{children:h({vi:"S·ªë ti·ªÅn c∆∞·ª£c",en:"Bet Amount"})}),s.jsxs("span",{children:[h({vi:"S·ªë d∆∞:",en:"Balance:"})," ",s.jsx("span",{className:"text-green-400 font-bold",children:j(x)})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"number",value:u,onChange:e=>{let s=Number(e.target.value);s>x&&(s=x),b(s)},min:0,max:g,className:"flex-1 bg-slate-800 border border-slate-700 rounded-lg px-4 py-3 text-xl font-bold text-white focus:outline-hidden focus:ring-2 focus:ring-blue-500"}),s.jsx("button",{onClick:()=>b(g),className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white font-bold rounded-lg transition-colors text-sm",children:h({vi:"X·∫¢ L√ÅNG",en:"MAX"})})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("input",{type:"range",min:0,max:g,step:10,value:u,onChange:e=>{b(Number(e.target.value))},className:"w-full h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer accent-blue-500"}),s.jsxs("div",{className:"flex justify-between text-xs text-slate-500 font-mono",children:[s.jsx("span",{children:j(0)}),s.jsx("span",{children:j(g/2)}),s.jsx("span",{children:j(g)})]})]}),s.jsx("div",{className:"grid grid-cols-4 gap-2",children:[100,500,1e3,5e3].map(e=>s.jsxs("button",{onClick:()=>b(s=>Math.min(s+e,g)),disabled:u+e>g,className:"px-2 py-2 bg-slate-800 hover:bg-slate-700 disabled:opacity-50 disabled:cursor-not-allowed text-slate-300 text-xs font-semibold rounded-lg transition-colors border border-slate-700",children:["+",j(e)]},e))})]}),s.jsxs("div",{className:"p-4 border-t border-slate-800 bg-slate-800/50 flex gap-3",children:[s.jsx("button",{onClick:o,className:"flex-1 px-4 py-3 bg-slate-700 hover:bg-slate-600 text-white font-bold rounded-lg transition-colors",children:h({vi:"Xo√° c∆∞·ª£c",en:"Clear bet"})}),s.jsxs("button",{onClick:()=>{u>=f&&u<=x&&(c(u),l())},disabled:u<f||u>g,className:"flex-1 px-4 py-3 bg-blue-600 hover:bg-blue-500 disabled:bg-slate-700 disabled:text-slate-500 text-white font-bold rounded-lg transition-colors flex items-center justify-center gap-2",children:[s.jsx(i,{className:"w-5 h-5"}),h({vi:"X√°c nh·∫≠n",en:"Confirm"})]})]})]})}),document.body)}function P({game:i,currentUserId:P=""}){const B=i,[R,C]=a.useState(B.getState()),{confirm:$}=t(),{ti:S,ts:H}=e(),{currentRoom:U}=l(),[M,q]=a.useState([]),[I,T]=a.useState(null),[O,A]=a.useState(null),L=O?R.playerPowerUps[P||""]?.[O]:void 0,[W,G]=a.useState(!1),[z,J]=a.useState([[],[],[]]),[E,_]=a.useState([0,0,0]),[D,K]=a.useState(!1),[V,X]=a.useState(null),[F,Y]=a.useState(null),[Q,Z]=a.useState(null),ee=null!==F?F:P&&R.playersReady[P]||!1,se=P?R.playerBalances[P]:void 0,te=(P?ee?R.currentBets[P]||[]:M:[]).filter(e=>e.amount>0),le=V?te.filter(e=>e.symbol===V).reduce((e,s)=>e+s.amount,0):0,ae=te.reduce((e,s)=>e+s.amount,0),ne=se?se.currentBalance-se.balanceHistory[se.balanceHistory.length-2]:0;a.useEffect(()=>B.onUpdate(e=>{if("rolling"===e.gamePhase&&"betting"===R.gamePhase){G(!0);const s=e=>{const s=[];for(let t=0;t<20;t++)s.push(v[Math.floor(Math.random()*v.length)]);return s.push(e),s},t=e.diceRoll;J([s(t[0]),s(t[1]),s(t[2])]),_([0,0,0]),[0,1,2].forEach(e=>{const s=1500+500*e,t=setInterval(()=>{_(s=>{const t=[...s];return t[e]=(t[e]+1)%21,t})},100);setTimeout(()=>{clearInterval(t),_(s=>{const t=[...s];return t[e]=20,t})},s)}),setTimeout(()=>{G(!1)},3e3)}C(e),"betting"===e.gamePhase&&e.currentRound!==R.currentRound&&(q([]),A(null)),"betting"!==e.gamePhase&&"betting"===R.gamePhase&&A(null),P&&null!==F&&e.playersReady[P]===F&&Y(null),P&&null!==Q&&e.activePowerUps[P]===Q&&Z(null)}),[B,R.currentRound,R.gamePhase]);const re=e=>{const s=[];return Object.entries(R.currentBets).forEach(([t,l])=>{const a=l.find(s=>s.symbol===e);if(a){const e=R.playerBalances[t];e&&s.push({playerId:t,username:e.username,amount:a.amount,isBot:e.isBot})}}),s.sort((e,s)=>s.amount-e.amount)},ie=e=>{if(e.length<2)return s.jsx("div",{className:"w-16 h-8"});const t=Math.max(...e),l=Math.min(...e),a=t-l||1,n=e.map((s,l)=>`${2+l/(e.length-1)*60},${2+(t-s)/a*28}`).join(" "),r=e[e.length-1],i=e[e.length-2],c=r===i?"#6b7280":r>i?"#10b981":"#ef4444";return s.jsx("svg",{width:64,height:32,className:"inline-block",children:s.jsx("polyline",{points:n,fill:"none",stroke:c,strokeWidth:"2",strokeLinejoin:"round"})})},ce=async()=>{if(!B.isHost)return;M.length>0&&!ee&&B.requestSyncBets(M);const e=Object.values(R.playerBalances).filter(e=>!e.isBot).filter(e=>(e.playerId!==P||!(M.length>0||ee))&&(0===(R.currentBets[e.playerId]||[]).length||!R.playersReady[e.playerId]));if(e.length>0){if(!(await $(H({vi:`C√≥ ${e.length} ng∆∞·ªùi ch∆∞a s·∫µn s√†ng (${e.map(e=>e.username).join(", ")}). B·∫°n c√≥ mu·ªën l·∫Øc x√∫c x·∫Øc lu√¥n kh√¥ng? `,en:`${e.length} player(s) haven't ready yet (${e.map(e=>e.username).join(", ")}). Roll dice anyway? `}),H({vi:"L·∫Øc x√∫c x·∫Øc",en:"Roll Dice"}))))return}B.requestRollDice()},oe=()=>s.jsxs("div",{className:"bg-slate-800/50 backdrop-blur-sm rounded-xl p-6 border border-slate-700",children:[s.jsx("h3",{className:"text-lg font-semibold mb-4 text-center",children:S({vi:"K·∫øt qu·∫£ x√∫c x·∫Øc",en:"Dice Roll"})}),s.jsx("div",{className:"flex justify-center gap-2 mb-4",children:W||R.diceRoll?z.map((e,t)=>{const l=E[t],a=R.diceRoll?R.diceRoll[t]:e[e.length-1];return s.jsx("div",{className:"relative w-20 h-20 bg-white rounded-xl overflow-hidden shadow-lg",children:W&&e.length>0?s.jsx("div",{className:"absolute transition-transform duration-100 ease-linear",style:{transform:`translateY(-${80*l}px)`},children:e.map((e,t)=>s.jsx("div",{className:"w-20 h-20 flex items-center justify-center text-5xl border-b border-slate-200",children:p[e].emoji},t))}):s.jsx("div",{className:"w-20 h-20 flex items-center justify-center text-5xl",children:p[a].emoji})},t)}):s.jsx("div",{className:"text-slate-500 text-center",children:ee?S({vi:"ƒêang ch·ªù ch·ªß ph√≤ng quay x√∫c x·∫Øc...",en:"Waiting for host roll..."}):te.length?B.isHost?null:S({vi:"Vui l√≤ng b·∫•m S·∫µn s√†ng...",en:"Please press Ready..."}):S({vi:"Vui l√≤ng ƒë·∫∑t c∆∞·ª£c tr∆∞·ªõc...",en:"Please place bets first..."})})}),B.isHost&&"betting"===R.gamePhase&&s.jsxs("button",{onClick:ce,className:"w-full px-6 py-3 bg-linear-to-r from-red-600 to-orange-600 hover:from-red-700 hover:to-orange-700 rounded-lg font-bold text-lg transition-all transform hover:scale-105",disabled:W,children:["üé≤ ",S({vi:"L·∫Øc x√∫c x·∫Øc",en:"Roll Dice"})," üé≤"]}),B.isHost&&"results"===R.gamePhase&&s.jsx("button",{onClick:()=>B.requestStartNewRound(),className:"w-full px-6 py-3 bg-green-600 hover:bg-green-700 rounded-lg font-bold transition-colors",children:S({vi:"V√≤ng ti·∫øp theo",en:"Next Round"})})]});return s.jsxs(s.Fragment,{children:[s.jsx(k,{isOpen:!!V,onClose:()=>X(null),onConfirm:e=>{if(!V)return;const s=V;if("betting"!==R.gamePhase)return;if(!se)return;const t=Math.min(e,se.currentBalance-ae);if(t<f)T(H({en:`Minimum bet is ${j(f)}`,vi:`C∆∞·ª£c t·ªëi thi·ªÉu ${j(f)}`}));else if(ee)T(H({en:"Cancel your bet to change the symbol",vi:"B·∫•m Hu·ª∑ c∆∞·ª£c ƒë·ªÉ thay ƒë·ªïi linh v·∫≠t"}));else{const e=M.findIndex(e=>e.symbol===s),l=[...M];e>=0?l[e].amount=t:l.push({symbol:s,amount:t}),q(l),T(null)}},onClear:()=>{q(e=>e.filter(e=>e.symbol!==V)),X(null)},symbol:V,currentBalance:se?se.currentBalance-ae:0,currentBet:le}),s.jsxs("div",{className:"relative w-full h-full flex flex-col @md:gap-4 gap-2 @md:p-2 pb-20 overflow-y-auto",children:["ended"===R.gamePhase&&s.jsxs("div",{className:"bg-linear-to-br from-yellow-600 to-orange-600 rounded-xl p-8 text-center border-4 border-yellow-400",children:[s.jsxs("h2",{className:"text-3xl font-bold mb-4",children:["üéâ ",S({vi:"K·∫øt th√∫c!",en:"Game Over!"})," üéâ"]}),R.winner&&s.jsx("p",{className:"text-xl mb-6",children:S({vi:`Ng∆∞·ªùi chi·∫øn th·∫Øng: ${R.playerBalances[R.winner]?.username}`,en:`Winner: ${R.playerBalances[R.winner]?.username}`})}),B.isHost&&s.jsx("button",{onClick:()=>B.requestResetGame(),className:"px-6 py-3 bg-white text-black rounded-lg font-bold hover:bg-slate-200 transition-colors",children:S({vi:"Ch∆°i l·∫°i",en:"Play Again"})})]}),!R.isMegaRound||"betting"!==R.gamePhase&&"rolling"!==R.gamePhase&&"results"!==R.gamePhase?s.jsxs("div",{className:"bg-linear-to-r from-slate-600 to-slate-800 rounded-xl p-2 text-white",children:[s.jsxs("h2",{className:"text-2xl font-bold text-center",children:["üé≤ ",S({vi:"B·∫ßu Cua",en:"Bau Cua"})," üé≤"]}),s.jsxs("p",{className:"text-center text-sm opacity-90",children:[S({vi:`V√≤ng ${R.currentRound}`,en:`Round ${R.currentRound}`}),R.jackpotPool>0&&` ‚Ä¢ ${S({vi:"H≈©",en:"Jackpot"})}: ${R.jackpotPool} üíé`]})]}):s.jsxs("div",{className:"bg-linear-to-r from-yellow-600 via-orange-500 to-yellow-600 rounded-xl p-4 text-white border-4 border-yellow-400 shadow-lg shadow-yellow-500/50 animate-pulse",children:[s.jsxs("h2",{className:"text-3xl font-bold text-center flex items-center justify-center gap-2",children:[s.jsx("span",{className:"animate-bounce",children:"üåü"}),S({vi:"V√íNG N·ªî H≈®",en:"MEGA ROUND"}),s.jsx("span",{className:"animate-bounce",children:"üåü"})]}),s.jsx("p",{className:"text-center text-lg font-bold mt-2",children:S({vi:`H≈©: ${R.jackpotPool} üíé`,en:`Jackpot: ${R.jackpotPool} üíé`})}),s.jsx("p",{className:"text-center text-sm opacity-90",children:S({vi:"Ra 3 con gi·ªëng nhau = ƒÇn h·∫øt H≈©!",en:"Triple match = Win the Jackpot!"})})]}),"waiting"===R.gamePhase&&s.jsx("div",{className:"space-y-4",children:s.jsxs("div",{className:"bg-slate-800/50 backdrop-blur-sm rounded-xl @md:p-6 p-2 py-6 border border-slate-700",children:[s.jsx("p",{className:"text-xl mb-4 text-center",children:S({vi:"ƒêang ch·ªù b·∫Øt ƒë·∫ßu game...",en:"Waiting to start game..."})}),s.jsxs("div",{className:"mb-6",children:[s.jsx("h3",{className:"text-lg font-semibold mb-3 text-slate-300",children:S({vi:`Ng∆∞·ªùi ch∆°i (${Object.keys(R.playerBalances).length}/${U?.maxPlayers})`,en:`Players (${Object.keys(R.playerBalances).length}/${U?.maxPlayers})`})}),s.jsx("div",{className:"flex flex-wrap gap-2 justify-center",children:Object.values(R.playerBalances).map(e=>s.jsxs("div",{className:"bg-slate-700/50 rounded-lg p-3 flex items-center justify-between w-[150px]",children:[s.jsxs("div",{className:"flex-1 text-left",children:[s.jsx("p",{className:"font-semibold text-sm truncate",children:e.username}),s.jsxs("p",{className:"text-xs text-slate-400",children:[j(e.currentBalance),"üí∞"]})]}),e.isBot&&s.jsx("span",{className:"text-lg ml-2",children:"ü§ñ"}),B.isHost&&e.isBot&&s.jsx("button",{onClick:()=>B.requestRemoveBot(e.playerId),className:"p-2 text-red-400 hover:bg-slate-600 rounded-lg hover:cursor-pointer",children:s.jsx(c,{className:"w-4 h-4"})})]},e.playerId))})]}),B.isHost&&s.jsxs("div",{className:"flex gap-2 justify-center flex-wrap",children:[s.jsxs("button",{onClick:()=>B.requestAddBot(),className:"flex items-center gap-1 px-4 py-2 bg-slate-600 hover:bg-slate-500 rounded-lg transition-colors disabled:bg-slate-800",disabled:Object.keys(R.playerBalances).length>=20,children:[S({vi:"Th√™m Bot",en:"Add Bot"}),s.jsx(o,{className:"w-4 h-4"})]}),s.jsxs("button",{onClick:()=>B.requestStartNewRound(),className:"flex items-center gap-1 px-4 py-2 bg-green-600 hover:bg-green-500 rounded-lg transition-colors disabled:bg-slate-800",disabled:0===Object.keys(R.playerBalances).length,children:[S({vi:"B·∫Øt ƒë·∫ßu",en:"Start Game"}),s.jsx(d,{className:"w-4 h-4"})]})]})]})}),("betting"===R.gamePhase||"rolling"===R.gamePhase||"results"===R.gamePhase)&&s.jsxs("div",{className:"flex flex-col @md:grid @md:grid-cols-[1fr_300px] gap-4",children:[s.jsxs("div",{className:"flex flex-col gap-4",children:[se&&s.jsxs("div",{className:"bg-slate-800/50 backdrop-blur-sm rounded-xl p-4 border border-slate-700",children:[s.jsxs("div",{className:"flex justify-between items-center mb-3",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-slate-400",children:S({vi:"S·ªë d∆∞",en:"Your Balance"})}),s.jsxs("p",{className:"text-2xl font-bold text-green-400 flex items-center gap-0",children:[j(se.currentBalance),se.balanceHistory.length>1&&s.jsxs("span",{className:"ml-2 text-sm font-bold animate-pulse "+(ne>=0?"text-green-300":"text-red-400"),children:[ne>=0?"+":"",j(ne)]})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-sm text-slate-400",children:S({vi:"T·ªïng c∆∞·ª£c",en:"Total Bet"})}),s.jsx("p",{className:"text-xl font-semibold text-orange-400",children:j(ae)})]})]}),"betting"===R.gamePhase&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex gap-2",children:[!ee&&s.jsxs("button",{onClick:()=>{T(null),ee||q([]),B.requestClearBets()},className:"flex-1 px-4 py-2 bg-slate-700 hover:bg-slate-600 rounded-lg transition-colors disabled:bg-slate-800 disabled:cursor-not-allowed",disabled:0===te.length,children:[S({vi:"X√≥a c∆∞·ª£c",en:"Clear Bets"})," ",te.length||""]}),!B.isHost&&s.jsx("button",{onClick:()=>{!ee&&M.length>0&&B.requestSyncBets(M),T(null),B.requestToggleReady(),Y(!ee)},className:"flex-1 px-4 py-2 rounded-lg transition-colors disabled:bg-slate-800 disabled:cursor-not-allowed "+(ee?"bg-red-700 hover:bg-red-800":"bg-blue-700 hover:bg-blue-800"),disabled:0===te.length,children:S(ee?{vi:"Hu·ª∑ s·∫µn s√†ng",en:"Cancel Ready"}:{vi:"S·∫µn s√†ng",en:"Ready"})})]}),0===te.length?s.jsx("p",{className:"text-sm text-orange-500 pt-2 animate-bounce",children:S({vi:"Vui l√≤ng ch·ªçn linh v·∫≠t",en:"Please select a symbol"})}):ee||B.isHost?null:s.jsx("p",{className:"text-sm text-orange-500 pt-2 animate-bounce",children:S({vi:"B·∫•m S·∫µn s√†ng khi ƒë·∫∑t c∆∞·ª£c xong",en:"Press Ready when you finish betting"})}),I&&s.jsx("p",{className:"text-sm text-red-500 pt-2 animate-bounce",children:I})]})]}),s.jsxs("div",{className:"grid grid-cols-3 @md:gap-3 gap-1 relative",children:[ee&&"betting"===R.gamePhase&&s.jsx("div",{className:"absolute inset-0 bg-black/50 z-10 flex items-center justify-center",children:s.jsx("p",{className:"text-md text-orange-500 pt-2 animate-bounce",children:S({vi:"ƒêang ch·ªù ch·ªß ph√≤ng quay x√∫c x·∫Øc..",en:"Waiting for host to roll dice.."})})}),v.map(e=>{const t=(e=>{const s=te.find(s=>s.symbol===e);return s?.amount||0})(e),l=re(e),a=(e=>re(e).reduce((e,s)=>e+s.amount,0))(e),n=R.diceRoll?.includes(e)&&"results"===R.gamePhase,r=(()=>{if(0===R.recentRolls.length)return[];const e={gourd:0,crab:0,shrimp:0,fish:0,chicken:0,deer:0};return R.recentRolls.forEach(s=>{s.forEach(s=>{e[s]++})}),v.map(s=>({symbol:s,count:e[s]})).sort((e,s)=>s.count-e.count)})(),i=r.find(s=>s.symbol===e),c=i?.count||0,o=3*R.recentRolls.length,d=r.findIndex(s=>s.symbol===e),x=d<2&&R.recentRolls.length>=3,m=d>=4&&R.recentRolls.length>=3,h=t>=(se?.currentBalance||0)||l.filter(e=>{const s=R.playerBalances[e.playerId];return s&&s.totalBet>=s.currentBalance}).length>0;return s.jsxs("button",{onClick:()=>(e=>{"betting"===R.gamePhase&&se&&X(e)})(e),disabled:"betting"!==R.gamePhase,className:`relative p-4 rounded-xl border-2 transition-all transform active:scale-95 ${n?"bg-linear-to-br from-yellow-500 to-orange-500 border-yellow-400 animate-pulse":t>0?"bg-linear-to-br from-blue-600 to-purple-600 border-blue-400":"bg-slate-800/50 border-slate-700 hover:border-slate-500"} ${"betting"===R.gamePhase?"cursor-pointer":"cursor-not-allowed opacity-75"} ${h&&"betting"===R.gamePhase?"ring-4 ring-red-500 ring-opacity-75 shadow-lg shadow-red-500/50 animate-pulse":""}`,children:[s.jsx("div",{className:"text-4xl mb-2",children:p[e].emoji}),R.recentRolls.length>=3&&s.jsxs("div",{className:"absolute @md:top-2 @md:left-2 top-1 left-1 flex items-center gap-1 bg-black/60 px-2 py-1 rounded-full text-xs font-bold",children:[x&&"üî•",m&&"‚ùÑÔ∏è",s.jsxs("span",{className:x?"text-orange-400":m?"text-cyan-400":"text-slate-300",children:[c,"/",o]})]}),h&&"betting"===R.gamePhase&&s.jsx("div",{className:"absolute @md:top-2 @md:left-2 top-1 left-1 bg-red-600 text-white px-2 py-1 rounded-full text-xs font-bold animate-bounce flex items-center gap-1",children:"üî• ALL-IN"}),s.jsx("div",{className:"text-sm font-semibold mb-2",children:S(p[e])}),t>0&&s.jsx("div",{className:"absolute @md:top-2 @md:right-2 top-1 right-1 bg-white text-black px-2 py-1 rounded-full text-xs font-bold",children:j(t)}),l.length>0&&s.jsxs("div",{className:"mt-2 space-y-1",children:[s.jsx("div",{className:"text-xs font-bold text-yellow-400 border-t border-slate-600 pt-2",children:S({vi:`T·ªïng: ${a}`,en:`Total: ${a}`})}),s.jsx("div",{className:"max-h-20 overflow-y-auto space-y-0.5",children:l.map(e=>s.jsxs("div",{className:"text-xs flex justify-between items-center gap-1",children:[s.jsxs("span",{className:"truncate flex-1 text-left",children:[e.username,e.isBot&&" ü§ñ"]}),s.jsx("span",{className:"font-semibold text-green-400",children:j(e.amount)})]},e.playerId))})]})]},e)})]}),se&&R.playerPowerUps[P]&&s.jsxs("div",{className:"flex flex-col gap-2 bg-slate-800/50 backdrop-blur-sm rounded-xl @md:p-4 p-2 border border-slate-700",children:[s.jsx("h3",{className:"font-semibold mb-3 text-slate-300",children:S({vi:"K·ªπ nƒÉng",en:"Power-ups"})}),s.jsx("div",{className:"flex flex-wrap gap-2 justify-center",children:Object.keys(R.playerPowerUps[P]).map(e=>{const t=R.playerPowerUps[P][e],l=O===e,a=R.activePowerUps[P]===e,n=0===t.cooldown&&!a;return s.jsx("button",{onClick:()=>A(l?null:e),className:"relative p-3 rounded-lg border-2 transition-all cursor-pointer "+(a?"bg-linear-to-br from-green-600 to-emerald-600 border-green-400":l?"bg-linear-to-br from-blue-600 to-purple-600 border-blue-400 ring-2 ring-blue-300":n?"bg-slate-700 border-slate-600 hover:border-blue-400 hover:bg-slate-600":"bg-slate-800 border-slate-700 opacity-50"),children:s.jsxs("div",{className:"flex flex-col items-center gap-1",children:[(r=e,{double_down:s.jsx(g,{className:"w-5 h-5"}),insurance:s.jsx(b,{className:"w-5 h-5"}),reveal_one:s.jsx(u,{className:"w-5 h-5"}),lucky_star:s.jsx(h,{className:"w-5 h-5"})}[r]),s.jsx("div",{className:"text-sm font-semibold truncate w-full text-center",children:S(y[e].name)}),!n&&!l&&!a&&s.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/70 rounded-lg",children:s.jsx("span",{className:"text-2xl font-bold text-white",children:t.cooldown})}),a&&s.jsxs("div",{className:"text-xs text-green-300 font-bold",children:["‚úì ",S({vi:"ƒêang d√πng",en:"Active"})]})]})},e);var r})}),O&&s.jsxs("div",{className:"p-3 bg-purple-600/20 border border-purple-500 rounded-lg",children:[s.jsx("p",{className:"text-sm text-purple-300 font-semibold mb-1",children:S(y[O].name)}),s.jsx("p",{className:"text-sm text-slate-300",children:S(y[O].description)})]}),O&&!R.activePowerUps[P]&&"betting"===R.gamePhase&&s.jsx("button",{onClick:()=>{B.requestActivatePowerUp(O),Z(O),A(null)},disabled:L&&L.cooldown>0,className:"w-full px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-slate-800 disabled:cursor-not-allowed rounded-lg font-bold text-white transition-colors",children:L&&L.cooldown>0?H({en:`ü™´ Wait for cooldown (${L.cooldown} rounds left)`,vi:`ü™´ ƒêang h·ªìi chi√™u (c√≤n ${L.cooldown} v√≤ng)`}):H({en:"‚ö° Use Power-up",vi:"‚ö° S·ª≠ d·ª•ng k·ªπ nƒÉng"})}),R.activePowerUps[P]&&R.playerPowerUps[P]&&"post_roll"===y[R.activePowerUps[P]]?.timing&&s.jsx("button",{onClick:()=>{B.requestDeactivatePowerUp(),Z(null)},className:"w-full px-4 py-2 bg-red-600 hover:bg-red-700 rounded-lg transition-colors",children:S({vi:"Hu·ª∑ k·ªπ nƒÉng",en:"Cancel Power-up"})}),R.powerUpPredictions[P]&&s.jsxs("div",{className:"p-3 bg-green-600/20 border border-green-500 rounded-lg",children:[s.jsxs("p",{className:"text-xs text-green-300 font-semibold mb-2",children:["üîÆ"," ",S({vi:"D·ª± ƒëo√°n c·ªßa M·∫Øt Th·∫ßn",en:"Mystic Prediction"})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"text-3xl flex items-center",children:[s.jsx("span",{className:"mr-2 text-xl",children:S(p[R.powerUpPredictions[P]?.symbol])}),p[R.powerUpPredictions[P]?.symbol]?.emoji]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-xs text-slate-400",children:S({vi:"ƒê·ªô ch√≠nh x√°c",en:"Accuracy"})}),s.jsxs("p",{className:"text-lg font-bold text-purple-300",children:[Math.round(100*R.powerUpPredictions[P]?.accuracy),"%"]})]})]})]}),R.playerPowerUps[P]?.lucky_star?.lastMultiplier&&R.playerPowerUps[P].lucky_star.lastUsedRound===R.currentRound-1&&s.jsxs("div",{className:"p-3 bg-yellow-600/20 border border-yellow-500 rounded-lg mt-2",children:[s.jsxs("p",{className:"text-xs text-yellow-300 font-semibold mb-2",children:["üåü"," ",S({vi:"K·∫øt qu·∫£ Sao May M·∫Øn",en:"Lucky Star Result"})]}),s.jsx("div",{className:"text-center",children:s.jsxs("p",{className:"text-2xl font-bold text-yellow-300",children:["x",R.playerPowerUps[P].lucky_star.lastMultiplier?.toFixed(1)]})})]})]})]}),s.jsxs("div",{className:"flex flex-col gap-4",children:[oe(),n.createPortal(s.jsx("div",{className:`fixed top-0 left-0 right-0 bottom-0 bg-slate-900/90 backdrop-blur-sm rounded-xl p-2 z-50 md:hidden ${W?"flex":"hidden"} items-center justify-center`,children:s.jsx("div",{className:"flex items-center justify-between",children:oe()})}),document.getElementById("root")),s.jsxs("div",{className:"bg-slate-800/50 backdrop-blur-sm rounded-xl p-4 border border-slate-700",children:[s.jsx("h3",{className:"text-lg font-semibold mb-3",children:S({vi:"B·∫£ng x·∫øp h·∫°ng",en:"Leaderboard"})}),s.jsx("div",{className:"space-y-2 max-h-120 overflow-y-auto",children:Object.values(R.playerBalances).sort((e,s)=>s.currentBalance-e.currentBalance).map((e,t)=>s.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg "+(e.playerId===P?"bg-blue-600/30 border border-blue-500":"bg-slate-700/50"),children:[s.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[s.jsxs("span",{className:"text-xl font-bold text-slate-400",children:["#",t+1]}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("p",{className:"font-semibold",children:[e.username,e.isBot&&" ü§ñ"]}),s.jsxs("p",{className:"text-xs text-slate-400",children:[S({vi:"C∆∞·ª£c: ",en:"Bet: "}),j(e.totalBet),R.playersReady[e.playerId]&&" ‚úì"]})]})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[R.currentRound>0&&ie(e.balanceHistory),s.jsx("div",{className:"text-right",children:s.jsx("p",{className:"text-lg font-bold text-green-400",children:j(e.currentBalance)})})]})]},e.playerId))})]})]})]}),B.isHost&&"waiting"!==R.gamePhase&&s.jsx("div",{className:"flex gap-2 w-full items-center justify-center",children:s.jsxs("button",{onClick:async()=>{await $(H({en:"Are you sure you want to reset the game?",vi:"B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën ch∆°i l·∫°i kh√¥ng?"}),H({en:"Reset Game",vi:"Ch∆°i l·∫°i"}))&&B.requestResetGame()},className:"rounded-lg text-xs bg-slate-700 hover:bg-slate-600 px-4 py-2 flex items-center gap-2",children:[s.jsx(x,{className:"w-4 h-4"}),S({en:"Reset Game",vi:"Ch∆°i l·∫°i"})]})}),s.jsx("button",{onClick:()=>K(!0),className:"fixed bottom-4 right-4 p-3 bg-slate-700 hover:bg-slate-600 rounded-full text-yellow-500 transition-colors z-50 shadow-lg border border-slate-500",title:H({en:"Rules",vi:"Lu·∫≠t ch∆°i"}),children:s.jsx(m,{size:24})}),D&&n.createPortal(s.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-100 flex items-center justify-center p-4",children:s.jsxs("div",{className:"bg-slate-900 border border-slate-700 rounded-xl max-w-lg w-full max-h-[80vh] overflow-y-auto shadow-2xl relative",children:[s.jsx("button",{onClick:()=>K(!1),className:"absolute top-4 right-4 p-2 hover:bg-white/10 rounded-full transition-colors text-slate-400 hover:text-white",children:s.jsx(r,{className:"w-5 h-5"})}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[s.jsx(m,{className:"w-6 h-6 text-yellow-500"}),S({en:"Game Rules",vi:"Lu·∫≠t Ch∆°i"})]}),s.jsxs("div",{className:"space-y-4 text-slate-300 leading-relaxed",children:[s.jsxs("section",{children:[s.jsx("h3",{className:"text-lg font-bold text-yellow-400 mt-4",children:S({en:"Objective",vi:"M·ª•c ti√™u"})}),s.jsx("p",{children:S({en:"Place bets on the symbols you think will appear on the dice. The last player with money wins!",vi:"ƒê·∫∑t c∆∞·ª£c v√†o c√°c linh v·∫≠t b·∫°n nghƒ© s·∫Ω xu·∫•t hi·ªán tr√™n x√∫c x·∫Øc. Ng∆∞·ªùi cu·ªëi c√πng c√≤n ti·ªÅn s·∫Ω th·∫Øng!"})})]}),s.jsxs("section",{children:[s.jsx("h3",{className:"text-lg font-bold text-yellow-400 mt-4",children:S({en:"Rules",vi:"Quy T·∫Øc"})}),s.jsxs("ul",{className:"space-y-2 list-disc pl-4",children:[s.jsx("li",{children:S({en:"One symbol matches: Win 1x your bet.",vi:"Tr√∫ng 1 linh v·∫≠t: ƒÇn 1 l·∫ßn ti·ªÅn c∆∞·ª£c."})}),s.jsx("li",{children:S({en:"Two symbols match: Win 2x your bet.",vi:"Tr√∫ng 2 linh v·∫≠t: ƒÇn 2 l·∫ßn ti·ªÅn c∆∞·ª£c."})}),s.jsx("li",{children:S({en:"Three symbols match: Win 3x your bet + Jackpot chance!",vi:"Tr√∫ng 3 linh v·∫≠t: ƒÇn 3 l·∫ßn ti·ªÅn c∆∞·ª£c + C∆° h·ªôi n·ªï h≈©!"})})]})]}),s.jsxs("section",{children:[s.jsx("h3",{className:"text-lg font-bold text-yellow-400 mt-4",children:S({en:"Power-ups",vi:"K·ªπ NƒÉng"})}),s.jsx("p",{className:"mb-2",children:S({en:"Can use 1 power-up per round.",vi:"ƒê∆∞·ª£c d√πng 1 k·ªπ nƒÉng m·ªói v√≤ng."})}),s.jsx("ul",{className:"space-y-2 list-disc pl-4",children:Object.keys(y).map(e=>s.jsxs("li",{children:[s.jsxs("strong",{children:[S(y[e].name),":"]})," ",S(y[e].description)]},e))})]}),s.jsxs("section",{children:[s.jsx("h3",{className:"text-lg font-bold text-yellow-400 mt-4",children:S({en:"Jackpot",vi:"N·ªï H≈©"})}),s.jsxs("ul",{className:"space-y-2 list-disc pl-4",children:[s.jsx("li",{children:S({en:`Jackpot is accumulated from ${100*N}% of all bets each round.`,vi:`H≈© ƒë∆∞·ª£c t√≠ch l≈©y t·ª´ ${100*N}% t·ªïng ti·ªÅn c∆∞·ª£c m·ªói v√≤ng.`})}),s.jsx("li",{children:S({en:`After every ${w} rounds, there will be a Jackpot round.`,vi:`Sau m·ªói ${w} v√≤ng, c√≥ 1 v√≤ng N·ªï H≈©.`})}),s.jsx("li",{children:S({en:"When 3 same symbols appear, the jackpot is triggered, split equally among those who has correct bet.",vi:"Khi 3 linh v·∫≠t gi·ªëng nhau xu·∫•t hi·ªán, h≈© s·∫Ω n·ªï, chia ƒë·ªÅu cho ai c∆∞·ª£c ƒë√∫ng."})})]})]})]})]})]})}),document.body)]})]})}export{P as default};
