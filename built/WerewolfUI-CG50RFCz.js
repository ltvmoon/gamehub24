import{b as e,u as s,j as t,a as n}from"./index-uDYi226y.js";import{c as a,am as i,an as l,ao as r,Y as o,ak as c,ap as d,aa as h,X as x,a0 as m,ad as u,af as g,s as p,aq as f,I as v,v as j,ar as b,V as w,M as y,as as N,aj as k,at as S,R as C,a6 as R,U as T,q as I,au as P,a8 as A,b as M,B,av as q,H as E,J as V,z as L,aw as G,ax as H,ay as $}from"./react-vendor-Dar9jqHp.js";import"./socket-DRbsQkF5.js";import{a as W,Q as z,D}from"./types-CsNQcsE1.js";import"./zustand-B0TGVVuy.js";const U=e=>{switch(e){case"night":return t.jsx(y,{className:"w-5 h-5"});case"morning":return t.jsx(r,{className:"w-5 h-5"});case"discussion":return t.jsx(w,{className:"w-5 h-5"});case"voting":return t.jsx(l,{className:"w-5 h-5"});case"elimination":case"hunterRevenge":return t.jsx(b,{className:"w-5 h-5"});default:return t.jsx(j,{className:"w-5 h-5"})}},O=({endTime:e,isPaused:s,pausedTimeRemaining:n})=>{const[i,l]=a.useState(0);if(a.useEffect(()=>{if(s&&null!=n)return void l(Math.max(0,Math.floor(n/1e3)));if(!e)return;const t=()=>l(Math.max(0,Math.floor((e-Date.now())/1e3)));t();const a=setInterval(t,1e3);return()=>clearInterval(a)},[e,s,n]),!e&&!n)return null;const r=Math.floor(i/60),o=i%60;return t.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 rounded-full text-lg font-bold font-mono transition-colors "+(s?"bg-yellow-500/30 text-yellow-400":i<=15?"bg-red-500/30 text-red-400 animate-bounce":"bg-white/15 text-white"),children:[s?t.jsx(u,{className:"w-5 h-5"}):t.jsx(N,{className:"w-5 h-5"}),r,":",o.toString().padStart(2,"0")]})},K=({state:e,currentUserId:n})=>{const{ti:i}=s(),l=a.useMemo(()=>{const s={};e.logs.forEach(e=>{s[e.day]||(s[e.day]=[]),s[e.day].push({type:"log",data:e})}),e.chatMessages.forEach(e=>{const t=e.day||1;s[t]||(s[t]=[]),s[t].push({type:"chat",data:e})});const t=e.players.find(e=>e.id===n);return t?.history&&t.history.forEach(e=>{s[e.day]||(s[e.day]=[]),s[e.day].push({type:"log",data:{id:e.id,message:e.content,type:e.type,timestamp:e.timestamp,day:e.day}})}),Object.keys(s).forEach(e=>{const t=Number(e);s[t].sort((e,s)=>s.data.timestamp-e.data.timestamp)}),s},[e.logs,e.chatMessages,e.players,n]),r=Object.keys(l).map(Number).sort((e,s)=>s-e);return 0===e.logs.length&&0===e.chatMessages.length?null:t.jsx("div",{className:"h-full overflow-y-auto pb-16 px-2 pt-0",children:r.map(e=>{const s=l[e],n=[];return s.forEach(e=>{const s=n[n.length-1];"chat"===e.type&&"chat"===s?.type&&s.data[0].playerName===e.data.playerName?s.data.push(e.data):"chat"===e.type?n.push({type:"chat",data:[e.data]}):n.push(e)}),t.jsxs("div",{className:"mb-4 relative",children:[t.jsxs("div",{className:"sticky top-0 z-10 py-1.5 bg-slate-900/95 backdrop-blur border-b border-white/10 mb-2 flex items-center gap-2",children:[t.jsx("div",{className:"p-1 rounded bg-blue-500/20 text-blue-400",children:0===e?t.jsx(p,{className:"w-4 h-4"}):t.jsx(f,{className:"w-4 h-4"})}),t.jsx("span",{className:"font-bold text-blue-100",children:i(0===e?{vi:"B·∫Øt ƒë·∫ßu game",en:"Start game"}:{vi:`Ng√†y ${e}`,en:`Day ${e}`})})]}),t.jsx("div",{className:"ml-2 pl-4 border-l-2 border-white/10 space-y-1",children:n.map((e,s)=>{if("chat"===e.type){const n=e.data,a=n[0];return t.jsxs("div",{className:"relative group",children:[t.jsx("div",{className:"absolute -left-[21px] top-1 w-2.5 h-2.5 rounded-full border-2 border-slate-900 bg-blue-500"}),t.jsxs("div",{className:"bg-white/5 rounded-lg ml-1 overflow-hidden",children:[t.jsx("div",{className:"px-2 py-1 bg-white/5 border-b border-white/5 flex items-center justify-between",children:t.jsx("span",{className:"text-blue-400 font-bold text-xs",children:a.playerName})}),t.jsx("div",{className:"p-1 space-y-0.5",children:n.map(e=>t.jsx("div",{className:"px-2 py-1 hover:bg-white/5 rounded transition-colors",children:t.jsxs("div",{className:"flex justify-between items-baseline gap-2",children:[t.jsx("p",{className:"text-sm text-white/90 break-words leading-tight flex-1",children:e.content}),t.jsx("span",{className:"text-[10px] text-white/40 shrink-0",children:new Date(e.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})},e.id))})]})]},`chat-group-${s}`)}const n=e.data;let a=v,l="text-gray-400 bg-gray-500/10",r="border-gray-500/20";return"death"===n.type?(a=b,l="text-red-400 bg-red-500/10",r="border-red-500/20"):"vote"===n.type&&(a=$,l="text-orange-400 bg-orange-500/10",r="border-orange-500/20"),t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute -left-[21px] top-1 w-2.5 h-2.5 rounded-full border-2 border-slate-900 "+("death"===n.type?"bg-red-500":"vote"===n.type?"bg-orange-500":"bg-gray-500")}),t.jsxs("div",{className:`p-2 rounded-lg border flex flex-col gap-1 ${r} ${l}`,children:[t.jsxs("div",{className:"flex items-start gap-2",children:[t.jsx(a,{className:"w-4 h-4 mt-0.5 shrink-0"}),t.jsx("p",{className:"text-sm leading-tight text-white/90",children:i(n.message)})]}),t.jsx("div",{className:"flex justify-end",children:t.jsx("span",{className:"text-[10px] text-white/40",children:new Date(n.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"})})})]})]},n.id)})})]},e)})})},Y=({player:e,onClose:a})=>{const{ti:i}=s(),l=n(e=>e.userId)===e.id;return t.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm",children:t.jsxs("div",{className:"bg-slate-800 w-full max-w-md rounded-2xl shadow-2xl overflow-hidden flex flex-col max-h-[80vh]",children:[t.jsxs("div",{className:"px-4 py-3 border-b border-white/10 flex items-center justify-between bg-slate-900",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center font-bold text-base",children:e.username.charAt(0).toUpperCase()}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-bold text-white text-sm",children:e.username}),t.jsx("p",{className:"text-[10px] text-white/60",children:i({vi:"L·ªãch s·ª≠ ho·∫°t ƒë·ªông",en:"Activity History"})})]})]}),t.jsx("button",{onClick:a,className:"p-1.5 hover:bg-white/10 rounded-full transition-colors",children:t.jsx(x,{className:"w-4 h-4"})})]}),t.jsx("div",{className:"flex-1 overflow-y-auto p-3 space-y-2",children:0===e.history.length?t.jsx("div",{className:"text-center text-white/40 py-8 italic text-xs",children:i({vi:"Ch∆∞a c√≥ ho·∫°t ƒë·ªông n√†o",en:"No activity recorded"})}):[...e.history].filter(e=>!e.isSecret||l).reverse().map(e=>t.jsxs("div",{className:"relative pl-3 border-l border-white/10 py-0.5",children:[t.jsx("div",{className:"absolute -left-[5px] top-3 w-2.5 h-2.5 rounded-full bg-slate-600 border-2 border-slate-800"}),t.jsxs("div",{className:"bg-white/5 p-2 rounded-lg",children:[t.jsxs("div",{className:"flex items-start justify-between gap-2 mb-0.5",children:[t.jsxs("span",{className:"text-[10px] px-1.5 py-0.5 rounded uppercase font-bold "+("chat"===e.type?"bg-blue-500/20 text-blue-400":"vote"===e.type?"bg-orange-500/20 text-orange-400":"action"===e.type?"bg-purple-500/20 text-purple-400":"bg-gray-500/20 text-gray-400"),children:[e.type," ",e.isSecret&&i({vi:"(b√≠ m·∫≠t)",en:"(secret)"})]}),t.jsxs("span",{className:"text-[10px] text-white/40",children:[i({vi:`Ng√†y ${e.day}`,en:`Day ${e.day}`})," ","‚Ä¢"," ",new Date(e.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]})]}),t.jsx("p",{className:"text-sm text-white/90 leading-tight",children:i(e.content)})]})]},e.id))})]})})},F=({players:e,hoveredPlayerId:s,suspicionMarkers:n,votes:i,playerRefs:l})=>{const[r,o]=a.useState([]);return a.useEffect(()=>{if(!s)return void o([]);const e=()=>{const e=[],t=l.current.get(s)?.parentElement?.getBoundingClientRect();if(!t)return;const a=e=>{const s=l.current.get(e);if(!s)return null;const n=s.getBoundingClientRect();return{x:n.left+n.width/2-t.left,y:n.top+n.height/2-t.top}};a(s)&&(n.forEach(t=>{if(t.fromPlayerId===s||t.toPlayerId===s){const s=a(t.fromPlayerId),n=a(t.toPlayerId);s&&n&&e.push({x1:s.x,y1:s.y,x2:n.x,y2:n.y,color:"#fb923c",moving:!0})}}),i.forEach(t=>{const n=t.playerId||t.voterId,i=t.targetId;if(n===s||i===s){const s=a(n),t=a(i);s&&t&&e.push({x1:s.x,y1:s.y,x2:t.x,y2:t.y,color:"#ef4444",moving:!1})}}),o(e))};e(),window.addEventListener("resize",e),window.addEventListener("scroll",e);const t=setInterval(e,100);return()=>{window.removeEventListener("resize",e),window.removeEventListener("scroll",e),clearInterval(t)}},[s,e,n,i]),s&&0!==r.length?t.jsxs("svg",{className:"absolute inset-0 w-full h-full pointer-events-none z-10 overflow-visible",children:[r.map((e,s)=>t.jsxs(C.Fragment,{children:[t.jsx("line",{x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,stroke:e.color,strokeWidth:"2",strokeDasharray:e.moving?"5,5":"none",className:e.moving?"animate-[dash_0.3s_linear_infinite]":"",markerEnd:`url(#arrowhead-${e.color.replace("#","")})`}),t.jsx("circle",{cx:e.x1,cy:e.y1,r:"3",fill:e.color})]},s)),t.jsxs("defs",{children:[t.jsx("marker",{id:"arrowhead-fb923c",markerWidth:"10",markerHeight:"7",refX:"9",refY:"3.5",orient:"auto",children:t.jsx("polygon",{points:"0 0, 10 3.5, 0 7",fill:"#fb923c"})}),t.jsx("marker",{id:"arrowhead-ef4444",markerWidth:"10",markerHeight:"7",refX:"9",refY:"3.5",orient:"auto",children:t.jsx("polygon",{points:"0 0, 10 3.5, 0 7",fill:"#ef4444"})})]}),t.jsx("style",{children:"\n        @keyframes dash {\n          to {\n            stroke-dashoffset: -10;\n          }\n        }\n      "})]}):null},X=({player:e,isMe:n,isSelected:a,canSelect:i,showRole:r,suspicionCount:o,voteCount:c,phase:d,isWolfTarget:h,isProtected:x,onViewHistory:m,onClick:u,innerRef:g,onMouseEnter:p,onMouseLeave:f})=>{const{ti:v,ts:j}=s(),w=e.role?W[e.role]:null,y=!e.isAlive;return t.jsxs("div",{ref:g,onMouseEnter:p,onMouseLeave:f,onTouchStart:p,onTouchEnd:f,onTouchCancel:f,className:"relative group/card",children:[t.jsxs("button",{onClick:u,disabled:!i,className:`relative flex flex-col items-center p-2 rounded-xl transition-all w-[100px] min-h-[120px] border border-slate-700 ${y?"opacity-80":"bg-white/5"} ${a?"ring-2 ring-yellow-400 bg-yellow-400/20":i?" hover:bg-white/10":""} ${i?"cursor-pointer":"cursor-default"} ${n?"ring-2 ring-blue-400":""}`,children:[t.jsxs("div",{className:"relative w-12 h-12 rounded-full flex items-center justify-center text-xl "+(y?"bg-gray-700":"bg-gradient-to-br from-green-500 to-blue-500"),children:[r&&w?w.icon:e.isBot?t.jsx(R,{className:"w-5 h-5"}):t.jsx(T,{className:"w-5 h-5"}),y&&t.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50 rounded-full hover:opacity-10 transition-opacity",children:t.jsx(b,{className:"w-6 h-6 text-red-400"})})]}),t.jsxs("span",{className:"mt-1 text-xs font-medium max-w-full text-center flex items-center justify-center",children:[e.username,n&&t.jsx(I,{className:"w-4 h-4 text-blue-400 ml-1 inline"})]}),r&&w&&t.jsx("span",{className:"text-xs mt-0.5 px-1.5 py-0.5 rounded-full max-w-full",style:{backgroundColor:w.color+"30",color:w.color},children:v(w.name)}),t.jsxs("div",{className:"flex flex-wrap justify-center gap-1 mt-1",children:[e.loverId&&t.jsxs("span",{className:"text-[10px] bg-pink-500/30 text-pink-400 px-1.5 py-0.5 rounded flex items-center gap-1",children:[t.jsx(S,{className:"w-3 h-3"}),t.jsx("span",{className:"max-w-0 overflow-hidden opacity-0 group-hover/card:max-w-[80px] group-hover/card:opacity-100 transition-all duration-300 ease-out whitespace-nowrap",children:v({vi:"C·∫∑p ƒë√¥i",en:"Lover"})})]}),x&&t.jsxs("span",{className:"text-[10px] bg-green-500/30 text-green-400 px-1.5 py-0.5 rounded flex items-center gap-1",children:[t.jsx(P,{className:"w-3 h-3"}),t.jsx("span",{className:"max-w-0 overflow-hidden opacity-0 group-hover/card:max-w-[80px] group-hover/card:opacity-100 transition-all duration-300 ease-out whitespace-nowrap",children:v({vi:"ƒê∆∞·ª£c b·∫£o v·ªá",en:"Protected"})})]}),h&&t.jsxs("span",{className:"text-[10px] bg-red-500/30 text-red-400 px-1.5 py-0.5 rounded flex items-center gap-1",children:[t.jsx(A,{className:"w-3 h-3"}),t.jsx("span",{className:"max-w-0 overflow-hidden opacity-0 group-hover/card:max-w-[100px] group-hover/card:opacity-100 transition-all duration-300 ease-out whitespace-nowrap",children:v({vi:"M·ª•c ti√™u c·ªßa s√≥i",en:"Wolf target"})})]}),o>0&&t.jsxs("span",{className:"text-[10px] bg-red-500/30 px-1.5 py-0.5 rounded flex items-center gap-1",children:[t.jsx(M,{className:"w-3 h-3"}),t.jsx("span",{className:"max-w-0 overflow-hidden opacity-0 group-hover/card:max-w-[80px] group-hover/card:opacity-100 transition-all duration-300 ease-out whitespace-nowrap",children:v({vi:"B·ªã nghi ng·ªù",en:"Suspicion"})}),o]}),c>0&&t.jsxs("span",{className:"text-[10px] bg-orange-500/30 px-1.5 py-0.5 rounded flex items-center gap-1",children:[t.jsx(l,{className:"w-3 h-3"}),t.jsx("span",{className:"max-w-0 overflow-hidden opacity-0 group-hover/card:max-w-[80px] group-hover/card:opacity-100 transition-all duration-300 ease-out whitespace-nowrap",children:v({vi:"S·ªë phi·∫øu",en:"Vote count"})}),c]}),e.hasVoted&&"voting"===d&&t.jsxs("span",{className:"text-[10px] bg-green-500/30 text-green-400 px-1.5 py-0.5 rounded flex items-center gap-1",children:[t.jsx(B,{className:"w-3 h-3"}),t.jsx("span",{className:"max-w-0 overflow-hidden opacity-0 group-hover/card:max-w-[60px] group-hover/card:opacity-100 transition-all duration-300 ease-out whitespace-nowrap",children:v({vi:"ƒê√£ vote",en:"Voted"})})]})]})]}),e.history.length>0&&t.jsx("button",{onClick:e=>{m?.(),e.stopPropagation()},className:"absolute -top-1 -right-1 p-1 bg-slate-600/80 rounded-full hover:bg-slate-500 transition-colors flex items-center justify-center w-6 h-6",title:j({vi:"Xem l·ªãch s·ª≠",en:"View history"}),children:t.jsx("span",{className:"text-xs text-white/70",children:e.history.filter(e=>!e.isSecret).length})})]})},J=({state:e,currentUserId:s,selectedTargetIds:n,onPlayerClick:i,canSelectPlayer:l,showRoles:r=!1})=>{const[o,c]=a.useState(null),[d,h]=a.useState(null),x=a.useRef(new Map),m=e.players.filter(e=>null!==e.id),u=e.players.find(e=>e.id===s),g="wolf"===u?.role,p=s=>"night"===e.phase&&g?e.nightActions.wolfVotes.filter(e=>e.targetId===s).length:"voting"===e.phase||"hunterRevenge"===e.phase?e.eliminationVotes.filter(e=>e.targetId===s).length:0,f=a.useMemo(()=>{let s=[];return"night"===e.phase&&g?s=[...e.nightActions.wolfVotes]:"voting"!==e.phase&&"hunterRevenge"!==e.phase||(s=[...e.eliminationVotes]),s},[e.phase,e.nightActions.wolfVotes,e.eliminationVotes,g]);return t.jsxs("div",{className:"relative flex flex-wrap justify-center gap-1 md:gap-2 md:p-2",children:[t.jsx(F,{players:m,hoveredPlayerId:d,suspicionMarkers:e.suspicionMarkers,votes:f,playerRefs:x}),o&&t.jsx(Y,{player:o,onClose:()=>c(null)}),m.map(a=>{const o=!!l&&l(a),d=n.includes(a.id),m=g&&e.nightActions.wolfTarget===a.id,f=e.nightActions.bodyguardTarget===a.id&&("bodyguard"===u?.role||"end"===e.phase);return t.jsx(X,{player:a,isMe:a.id===s,isSelected:d,canSelect:o,showRole:r||"end"===e.phase||e.config.revealRolesOnDeath&&!a.isAlive||g&&"wolf"===a.role||"seer"===u?.role&&u.history.some(e=>"info"===e.type&&e.content.en.startsWith("Seer Result:")&&e.content.en.includes(a.username)),suspicionCount:(v=a.id,e.suspicionMarkers.filter(e=>e.toPlayerId===v).length),voteCount:p(a.id),phase:e.phase,isWolfTarget:m,isProtected:f,onViewHistory:()=>{c(a)},onClick:()=>o&&a.id&&i?.(a.id),innerRef:e=>{e&&a.id?x.current.set(a.id,e):a.id&&x.current.delete(a.id)},onMouseEnter:()=>a.id&&h(a.id),onMouseLeave:()=>h(null)},a.id);var v})]})},_=({game:e,state:i,currentUserId:l,isHost:r})=>{const{ti:o}=s(),c=n(e=>e.username),[d,h]=a.useState(""),u=i.players.findIndex(e=>e.id===l),g=i.players.filter(e=>null!==e.id).length;return t.jsxs("div",{className:"flex flex-col h-full items-center",children:[t.jsxs("div",{className:"text-center mb-4",children:[t.jsxs("h2",{className:"text-xl font-bold flex items-center justify-center gap-2",children:[t.jsx(y,{className:"w-6 h-6"})," ",o({vi:"Ma S√≥i Online",en:"Werewolf Online"})]}),t.jsxs("p",{className:"text-white/60 text-sm pt-2",style:{color:g<i.minPlayers?"#ee5555":"white"},children:[o({vi:"Ch·ªù ng∆∞·ªùi ch∆°i...",en:"Waiting for players..."})," (",g,"/",i.minPlayers," ",o({vi:"t·ªëi thi·ªÉu",en:"minimum"}),")"]})]}),t.jsx("div",{className:"flex flex-wrap justify-center gap-1 md:gap-2 mb-4",children:i.players.slice(0,12).map((s,n)=>t.jsx("div",{className:"p-2 rounded-xl flex flex-col items-center justify-center w-[100px] min-h-[120px] "+(s.id?"bg-white/10":"bg-white/5 border-2 border-dashed border-white/20"),children:s.id?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"w-10 h-10 mx-auto rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center text-xl",children:s.isBot?t.jsx(R,{className:"w-5 h-5"}):t.jsx(T,{className:"w-5 h-5"})}),t.jsx("p",{className:"text-sm mt-1 truncate",children:s.username}),r&&s.id!==l&&t.jsxs("button",{onClick:()=>s.isBot?e.requestRemoveBot(n):e.requestLeaveSlot(n),className:"text-xs bg-red-500/20 text-red-400 hover:bg-red-500/30 px-2 py-1 rounded-lg mt-1 flex items-center justify-center gap-1",children:[t.jsx(x,{className:"w-3 h-3"})," ",o({vi:"X√≥a",en:"Remove"})]})]}):t.jsx("div",{className:"py-2",children:-1===u?t.jsxs("button",{onClick:()=>e.requestJoinSlot(n,c||`Guest ${Date.now().toString().slice(-4)}`),className:"text-xs bg-blue-500/20 text-blue-400 hover:bg-blue-500/30 px-3 py-1.5 rounded-lg flex items-center justify-center gap-1",children:[t.jsx(T,{className:"w-3 h-3 inline"})," ",o({vi:"Tham gia",en:"Join"})]}):r?t.jsxs("button",{onClick:()=>e.requestAddBot(n),className:"text-xs bg-green-500/20 text-green-400 hover:bg-green-500/30 px-3 py-1.5 rounded-lg flex items-center justify-center gap-1",children:[t.jsx(R,{className:"w-3 h-3"})," ",o({vi:"Th√™m Bot",en:"Add Bot"})]}):t.jsx("span",{className:"text-xs text-white/40",children:o({vi:"Tr·ªëng",en:"Empty"})})})},n))}),r&&t.jsxs("div",{className:"w-full max-w-[300px] flex flex-col gap-2",children:[t.jsxs("div",{className:"flex items-center gap-2 bg-white/5 p-2 rounded-lg",children:[t.jsx("label",{className:"text-xs text-white/60 whitespace-nowrap",children:o({vi:"Ch·ªçn vai tr√≤:",en:"Select Role:"})}),t.jsxs("select",{value:d,onChange:e=>h(e.target.value),className:"flex-1 bg-white/10 text-white text-sm rounded outline-none p-1 border border-white/10",children:[t.jsx("option",{value:"",children:o({vi:"Ng·∫´u nhi√™n",en:"Random"})}),Object.keys(W).map(e=>t.jsxs("option",{value:e,children:[W[e]?.icon," ",o(W[e]?.name)]},e))]})]}),t.jsxs("button",{onClick:()=>e.requestStartGame(""===d?void 0:d),disabled:!e.canStartGame(),className:"w-full py-3 rounded-xl font-bold flex items-center justify-center gap-2 "+(e.canStartGame()?"bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600":"bg-gray-600 text-gray-400 cursor-not-allowed"),children:[t.jsx(m,{className:"w-5 h-5"})," ",o({vi:"B·∫Øt ƒë·∫ßu game",en:"Start game"})]})]})]})},Q=({game:e,state:n,currentUserId:i,selectedTarget:l,secondSelectedTarget:r})=>{const{ti:o}=s(),[c,d]=a.useState(!1),[h,x]=a.useState(!1),m=n.players.find(e=>e.id===i),u=m?.role,g=u===n.nightSubPhase||"wolf"===u&&"wolf"===n.nightSubPhase,p=u?W[u]:null,f="witch"===u&&i?n.witchPotions[i]:null,v=n.nightActions.wolfTarget?n.players.find(e=>e.id===n.nightActions.wolfTarget):null,j=n.players.find(e=>e.id===l);if(!m)return t.jsx("div",{className:"flex flex-col items-center justify-center h-full text-white/50 pt-10",children:o({vi:"B·∫°n l√† kh√°ch, kh√¥ng th·ªÉ tham gia h√†nh ƒë·ªông",en:"You are a guest, you cannot participate in actions"})});if(!m?.isAlive)return t.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-white/50",children:[t.jsx(b,{className:"w-16 h-16 mb-4"}),t.jsxs("p",{children:[o({vi:"B·∫°n ƒë√£ ch·∫øt",en:"You are dead"}),"."," ",o({vi:"ƒêang ch·ªù ƒë√™m k·∫øt th√∫c...",en:"Waiting for night to end..."})]})]});if(!p?.hasNightAction||!g){const e="seer"===u?m.history.find(e=>"info"===e.type&&e.day===n.day):null;return t.jsxs("div",{className:"flex flex-col items-center justify-center h-full",children:[t.jsx(y,{className:"w-16 h-16 text-indigo-400 mb-4 animate-pulse"}),t.jsxs("p",{className:"text-white/70 flex items-center justify-center gap-2",children:[t.jsx(y,{className:"w-4 h-4"})," ",o({vi:"L√†ng ƒëang ng·ªß",en:"Village is sleeping"})]}),t.jsxs("p",{className:"text-white/50 text-sm mt-2",children:[o({vi:"Ch·ªù c√°c vai tr√≤ kh√°c h√†nh ƒë·ªông",en:"Waiting for other roles to act"}),"..."]}),e&&t.jsxs("div",{className:"mt-6 p-4 bg-indigo-500/20 rounded-xl border border-indigo-500/50 max-w-xs",children:[t.jsxs("p",{className:"text-indigo-300 font-bold mb-1 flex items-center justify-center gap-2",children:[t.jsx(G,{className:"w-4 h-4"}),o({vi:"K·∫øt qu·∫£ soi:",en:"Seer Result:"})]}),t.jsx("p",{className:"text-white font-medium text-center",children:o(e.content)})]})]})}return t.jsxs("div",{className:"flex flex-col h-full",children:[t.jsxs("div",{className:"text-center mb-4",children:[t.jsx("span",{className:"text-3xl",children:p.icon}),t.jsx("h3",{className:"text-lg font-bold",style:{color:p.color},children:o(p.name)}),t.jsx("p",{className:"text-sm text-white/60",children:o(p.nightActionDescription)}),l&&t.jsxs("p",{className:"text-sm mt-2 text-yellow-400 flex items-center justify-center gap-1",children:[t.jsx(A,{className:"w-4 h-4"})," ",n.players.find(e=>e.id===l)?.username,r&&t.jsxs("span",{children:[" ","&"," ",n.players.find(e=>e.id===r)?.username]})]})]}),"witch"===u&&f&&t.jsxs("div",{className:"flex flex-col gap-2 mb-4",children:[n.nightActions.wolfTarget&&t.jsx("div",{className:"p-2 bg-red-500/20 rounded-lg text-center mb-1",children:t.jsxs("p",{className:"text-sm text-red-200",children:[o({vi:"N·∫°n nh√¢n ƒë√™m nay:",en:"Tonight's victim:"})," ",t.jsx("span",{className:"font-bold",children:v?.username})]})}),t.jsxs("div",{className:"flex gap-2",children:[f.hasHealPotion&&n.nightActions.wolfTarget&&t.jsxs("button",{onClick:()=>{d(!c),c||x(!1)},className:"flex-1 p-3 rounded-xl flex flex-col items-center transition-all "+(c?"bg-green-500/30 ring-2 ring-green-400":"bg-white/10 hover:bg-white/30"),children:[t.jsx(H,{className:"w-6 h-6 text-green-400"}),t.jsxs("span",{className:"text-xs mt-1",children:[o({vi:"C·ª©u n·∫°n nh√¢n",en:"Heal victim"}),":"," ",v?.username]})]}),f.hasKillPotion&&t.jsxs("button",{onClick:()=>{x(!h),h||d(!1)},disabled:!l,className:"flex-1 p-3 rounded-xl flex flex-col items-center transition-all "+(h?"bg-red-500/30 ring-2 ring-red-400":l?"bg-white/10 hover:bg-white/30":"bg-slate-500/10 cursor-not-allowed"),children:[t.jsx(b,{className:"w-6 h-6 text-red-400"}),t.jsxs("span",{className:"text-xs mt-1",children:[o({vi:"Gi·∫øt ng∆∞·ªùi ƒë∆∞·ª£c ch·ªçn",en:"Kill selected"}),":"," ",j?.username||o({vi:"[Ch∆∞a ch·ªçn]",en:"[Please select]"})]})]})]})]}),t.jsxs("button",{onClick:()=>{u&&("cupid"===u&&l&&r?e.requestNightAction(u,l,!1,!1,r):"witch"===u?e.requestNightAction(u,h?l:null,c,h,void 0):l&&e.requestNightAction(u,l,!1,!1,void 0))},disabled:"cupid"===u?!l||!r:"witch"!==u&&!l,className:"w-full py-3 rounded-xl font-bold bg-gradient-to-r from-indigo-500 to-purple-500 disabled:opacity-50 disabled:cursor-not-allowed",children:[t.jsx(B,{className:"w-5 h-5 inline mr-2"}),o({vi:"X√°c nh·∫≠n",en:"Confirm"})]})]})},Z=({game:e,state:n,currentUserId:i,selectedTarget:l})=>{const[r,o]=a.useState(""),[c,d]=a.useState(!1),{ti:h,ts:x}=s(),m=n.players.find(e=>e.id===i),u=n.players.find(e=>e.id===l),g=()=>{r.trim()&&m?.isAlive&&(e.requestSendMessage(r.trim(),"text"),o(""))},p=n.suspicionMarkers.some(e=>e.fromPlayerId===i&&e.toPlayerId===l);return t.jsxs("div",{className:"flex flex-col h-full p-2",children:[l&&t.jsxs("div",{className:"text-center mb-2 text-sm text-yellow-400 flex items-center justify-center gap-1",children:[t.jsx(q,{className:"w-4 h-4"})," ",h({vi:"ƒêang ch·ªçn:",en:"Selected:"})," ",n.players.find(e=>e.id===l)?.username]}),l&&m?.isAlive&&t.jsxs("button",{onClick:()=>e.requestAddSuspicion(l),className:"w-full mb-2 py-2 rounded-lg text-sm transition-colors "+(p?"bg-gray-500/20 text-gray-400 hover:bg-gray-500/30":"bg-red-500/20 text-red-400 hover:bg-red-500/30"),children:[t.jsx(v,{className:"w-4 h-4 inline mr-1"}),h(p?{vi:"B·ªè nghi ng·ªù",en:"Unsuspect"}:{vi:"Nghi ng·ªù",en:"Suspect"})," ",u?.username]}),t.jsxs("button",{onClick:()=>d(!c),className:"flex items-center justify-between w-full p-2 bg-white/5 rounded-lg mb-2 text-sm",children:[t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx(w,{className:"w-4 h-4"})," ",h({vi:"Tin nh·∫Øn nhanh",en:"Quick messages"})]}),c?t.jsx(E,{className:"w-4 h-4"}):t.jsx(V,{className:"w-4 h-4"})]}),c&&t.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 mb-2",children:z.map(s=>t.jsxs("button",{onClick:()=>(s=>{if(!m?.isAlive)return;if(s.targetRequired&&!l)return;const t=s.targetRequired&&l?x(s.text).replace("{target}",n.players.find(e=>e.id===l)?.username||""):x(s.text);e.requestSendMessage(t,"quick",l||void 0,s.id)})(s),disabled:s.targetRequired&&!l,className:"p-2 bg-white/10 hover:bg-white/20 rounded-lg text-sm text-left flex items-center gap-2 disabled:opacity-30 disabled:cursor-not-allowed transition-colors",children:[t.jsx("span",{className:"text-lg",children:s.icon}),t.jsx("span",{className:"",children:s.targetRequired?x(s.text).replace("{target}",l?n.players.find(e=>e.id===l)?.username||"...":x({vi:"[ch·ªçn ng∆∞·ªùi]",en:"[select]"})):x(s.text)})]},s.id))}),t.jsx("div",{className:"flex-1 overflow-auto bg-black/20 rounded-lg p-2 mb-2 min-h-[100px] max-h-[200px]",children:n.chatMessages.slice(-20).map(e=>t.jsxs("div",{className:"mb-1 text-sm text-left",children:[t.jsxs("span",{className:"font-medium text-blue-400",children:[e.playerName,":"]})," ",t.jsx("span",{className:"text-white/80",children:e.content})]},e.id))}),m?.isAlive&&(m.messagesRemaining||0)>0&&t.jsxs("div",{className:"flex gap-2",children:[t.jsx("input",{type:"text",value:r,onChange:e=>o(e.target.value.slice(0,100)),onKeyDown:e=>"Enter"===e.key&&g(),placeholder:x({vi:`Nh·∫≠p tin nh·∫Øn... (${m.messagesRemaining}/${D.chatLimit})`,en:`Type message... (${m.messagesRemaining}/${D.chatLimit})`}),className:"flex-1 bg-white/10 rounded-lg px-3 py-2 text-sm outline-none"}),t.jsx("button",{onClick:g,className:"p-2 bg-blue-500 rounded-lg",children:t.jsx(L,{className:"w-5 h-5"})})]})]})},ee=({game:e,state:n,currentUserId:a,selectedTarget:i})=>{const{ti:r}=s(),o=n.players.find(e=>e.id===a),c="hunterRevenge"===n.phase,d=c&&"hunter"===o?.role&&n.pendingElimination===o.id;if(c&&!d)return t.jsxs("div",{className:"flex flex-col items-center justify-center h-full",children:[t.jsx(A,{className:"w-16 h-16 text-red-500 mb-4 animate-pulse"}),t.jsx("p",{className:"text-white/70 text-center",children:r({vi:"Th·ª£ sƒÉn ƒëang t√¨m m·ª•c ti√™u...",en:"Hunter is choosing a target..."})})]});if(o?.hasVoted){const e=n.eliminationVotes?.find(e=>e.voterId===a),s=e?.targetId?n.players.find(s=>s.id===e.targetId):null;return t.jsxs("div",{className:"flex flex-col items-center justify-center h-full",children:[t.jsx(B,{className:"w-16 h-16 text-green-400 mb-4"}),t.jsx("p",{className:"text-white/70",children:r(c?{vi:"ƒê√£ b·∫Øn!",en:"Shot fired!"}:{vi:"ƒê√£ b√¨nh ch·ªçn! ƒêang ch·ªù ng∆∞·ªùi kh√°c...",en:"Voted! Waiting for others..."})}),s&&!c&&t.jsx("p",{className:"text-yellow-400 mt-2 text-sm font-medium",children:r({vi:`B·∫°n ƒë√£ ch·ªçn: ${s.username}`,en:`You voted for: ${s.username}`})})]})}return t.jsxs("div",{className:"flex flex-col h-full",children:[t.jsxs("div",{className:"text-center mb-4",children:[c?t.jsx(A,{className:"w-10 h-10 mx-auto text-red-500 mb-2"}):t.jsx(l,{className:"w-10 h-10 mx-auto text-orange-400 mb-2"}),t.jsx("h3",{className:"text-lg font-bold",children:r(c?{vi:"K√©o ai ƒëi c√πng?",en:"Who to take with you?"}:{vi:"B√¨nh ch·ªçn lo·∫°i ai?",en:"Who do you vote?"})}),i&&t.jsxs("p",{className:"text-sm mt-2 text-yellow-400 flex items-center justify-center gap-1",children:[t.jsx(A,{className:"w-4 h-4"})," ",n.players.find(e=>e.id===i)?.username]})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:()=>{c?e.requestHunterShoot(""):e.requestCastVote(null)},className:"flex-1 py-3 bg-gray-600 rounded-xl font-bold",children:r({vi:"B·ªè qua",en:"Skip"})}),t.jsx("button",{onClick:()=>{c?i&&e.requestHunterShoot(i):i&&e.requestCastVote(i)},disabled:!i,className:"flex-1 py-3 rounded-xl font-bold disabled:opacity-50 "+(c?"bg-gradient-to-r from-red-600 to-red-800":"bg-gradient-to-r from-orange-500 to-red-500"),children:r(c?{vi:"B·∫Øn!",en:"Shoot!"}:{vi:"B√¨nh ch·ªçn",en:"Vote"})})]})]})},se=({game:e,state:n,showResetButton:a})=>{const{ts:i}=s(),l="wolf"===n.winner?i({vi:"Ma S√≥i th·∫Øng!",en:"Wolf wins!"}):"village"===n.winner?i({vi:"D√¢n L√†ng th·∫Øng!",en:"Village wins!"}):i({vi:"T√¨nh Nh√¢n th·∫Øng!",en:"Lover wins!"}),r="wolf"===n.winner?b:"village"===n.winner?k:S;return t.jsxs("div",{className:"flex flex-col items-center justify-center h-full",children:[t.jsxs("h2",{className:"text-xl font-bold flex items-center justify-center gap-2",children:[t.jsx(r,{className:"w-8 h-8"})," ",l]}),a&&t.jsxs("button",{onClick:()=>e.requestResetGame(),className:"mt-4 px-6 py-3 bg-gradient-to-r from-green-500 to-emerald-500 rounded-xl font-bold flex items-center gap-2",children:[t.jsx(o,{className:"w-5 h-5"})," Ch∆°i l·∫°i"]})]})},te=({game:n,currentUserId:p=""})=>{const{confirm:f}=e(),{ti:v,ts:j}=s(),b=n,[w,y]=a.useState(b.getState()),[N,k]=a.useState(!1),[S,C]=a.useState(!1),[R,T]=a.useState(null),[I,P]=a.useState(null),[A,M]=a.useState(!1),B=a.useRef(null);a.useEffect(()=>{const e=new IntersectionObserver(([e])=>{M(!e.isIntersecting&&e.boundingClientRect.top<0)},{threshold:0});return B.current&&e.observe(B.current),()=>e.disconnect()},[w.isGameStarted]);const[q,E]=a.useState(""),[V,L]=a.useState(null),G=w.players.find(e=>e.id===p),H=G?.role?W[G.role]:null;a.useEffect(()=>b.onUpdate(y),[b]),a.useEffect(()=>{T(null),P(null)},[w.phase,w.nightSubPhase]),a.useEffect(()=>{const e=(e=>{switch(e){case"setup":return"bg-gradient-to-b from-slate-900 to-slate-800";case"night":return"bg-gradient-to-b from-slate-950 to-indigo-950";case"voting":return"bg-gradient-to-b from-orange-950 to-blue-800";case"elimination":return"bg-gradient-to-b from-red-950 to-brown-800";default:return"bg-gradient-to-b from-slate-800 to-slate-700"}})(w.phase);""===q?E(e):e!==q&&e!==V&&L(e)},[w.phase]);const $=e=>{return t.jsx("div",{className:(e?"fixed top-0 left-0 right-0 z-[100] bg-slate-900/95 backdrop-blur-md border-b border-white/10 py-2 animate-in slide-in-from-top duration-300 shadow-2xl":"mb-3")+" flex justify-center w-full",children:t.jsxs("div",{className:"flex justify-between w-full max-w-[450px] "+(e?"px-4":"bg-slate-900/60 backdrop-blur-md p-2 px-4 rounded-xl border border-white/10 shadow-lg"),children:[t.jsxs("div",{className:"flex items-center gap-2",children:[U(w.phase),t.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:gap-2",children:[t.jsx("span",{className:"font-bold",children:v((s=w.phase,{setup:{en:"Setup",vi:"Thi·∫øt l·∫≠p"},night:{en:"Night",vi:"ƒê√™m"},morning:{en:"Morning",vi:"S√°ng"},discussion:{en:"Discussion",vi:"Th·∫£o lu·∫≠n"},voting:{en:"Voting",vi:"B√¨nh ch·ªçn"},elimination:{en:"Elimination",vi:"Lo·∫°i b·ªè"},hunterRevenge:{en:"Hunter's Revenge",vi:"Th·ª£ SƒÉn tr·∫£ th√π"},end:{en:"Game Over",vi:"K·∫øt th√∫c"}}[s]||s))}),w.day>0&&t.jsxs("span",{className:"text-white/60 text-sm",children:[v({vi:"Ng√†y",en:"Day"})," ",w.day]})]})]}),t.jsxs("div",{className:"flex items-center gap-1",children:["end"!==w.phase?t.jsx(O,{endTime:w.phaseEndTime,isPaused:w.isPaused,pausedTimeRemaining:w.pausedTimeRemaining}):t.jsx(se,{game:b,state:w,showResetButton:!1}),b.isHost&&"end"!==w.phase&&t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:()=>w.isPaused?b.requestResumeGame():b.requestPauseGame(),className:"p-2 rounded-full transition-colors "+(w.isPaused?"bg-green-500/20 text-green-400 hover:bg-green-500/30":"bg-white/10 text-white/60 hover:bg-white/20"),title:w.isPaused?"Resume":"Pause",children:w.isPaused?t.jsx(m,{className:"w-5 h-5"}):t.jsx(u,{className:"w-5 h-5"})}),t.jsx("button",{onClick:async()=>{await f(j({vi:"ƒê·∫øm ng∆∞·ª£c s·∫Ω ƒë∆∞·ª£c ƒë·∫∑t v·ªÅ 5 gi√¢y",en:"The countdown will be reset to 5 seconds"}),j({vi:"TƒÉng t·ªëc giai ƒëo·∫°n?",en:"Skip phase?"}))&&b.requestSkipPhase()},className:"p-2 rounded-full transition-colors bg-white/10 text-white/60 hover:bg-white/20",title:"Skip",children:t.jsx(g,{className:"w-5 h-5"})})]})]})]})});var s},z=()=>t.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-[100] flex items-center justify-center p-4",children:t.jsxs("div",{className:"bg-slate-900 border border-slate-700 rounded-xl max-w-lg w-full max-h-[80vh] overflow-y-auto shadow-2xl relative",children:[t.jsx("button",{onClick:()=>k(!1),className:"absolute top-4 right-4 p-2 hover:bg-white/10 rounded-full transition-colors text-slate-400 hover:text-white",children:t.jsx(x,{className:"w-5 h-5"})}),t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[t.jsx(h,{className:"w-6 h-6 text-yellow-500"}),v({en:"Werewolf Rules",vi:"Lu·∫≠t Ma S√≥i"})]}),t.jsxs("div",{className:"space-y-4 text-slate-300 leading-relaxed",children:[t.jsxs("section",{children:[t.jsx("h3",{className:"text-lg font-bold text-yellow-400 mt-4",children:v({en:"Objective",vi:"M·ª•c ti√™u"})}),t.jsxs("ul",{className:"space-y-2 list-disc pl-4 text-sm",children:[t.jsxs("li",{children:[t.jsxs("strong",{className:"text-red-400",children:["üê∫ ",v({en:"Werewolves",vi:"Ma S√≥i"})]}),":"," ",v({en:"Kill villagers until wolves equal villagers.",vi:"Gi·∫øt d√¢n l√†ng cho ƒë·∫øn khi s·ªë s√≥i b·∫±ng s·ªë d√¢n."})]}),t.jsxs("li",{children:[t.jsxs("strong",{className:"text-blue-400",children:["üë§ ",v({en:"Villagers",vi:"D√¢n L√†ng"})]}),":"," ",v({en:"Find and eliminate all wolves.",vi:"T√¨m v√† lo·∫°i b·ªè t·∫•t c·∫£ ma s√≥i."})]})]})]}),t.jsxs("section",{children:[t.jsx("h3",{className:"text-lg font-bold text-yellow-400 mt-4",children:v({en:"Roles",vi:"Vai Tr√≤"})}),t.jsxs("ul",{className:"space-y-2 list-disc pl-4 text-sm",children:[t.jsxs("li",{children:[t.jsxs("strong",{children:["üîÆ ",v({en:"Seer",vi:"Ti√™n Tri"})]}),":"," ",v({en:"Check one player's role each night.",vi:"Soi vai tr√≤ c·ªßa m·ªôt ng∆∞·ªùi ch∆°i m·ªói ƒë√™m."})]}),t.jsxs("li",{children:[t.jsxs("strong",{children:["üõ°Ô∏è ",v({en:"Bodyguard",vi:"B·∫£o V·ªá"})]}),":"," ",v({en:"Protect one player from wolves each night.",vi:"B·∫£o v·ªá m·ªôt ng∆∞·ªùi kh·ªèi s√≥i m·ªói ƒë√™m."})]}),t.jsxs("li",{children:[t.jsxs("strong",{children:["üßô ",v({en:"Witch",vi:"Ph√π Th·ªßy"})]}),":"," ",v({en:"Has one healing potion and one killing potion.",vi:"C√≥ m·ªôt b√¨nh thu·ªëc c·ª©u v√† m·ªôt b√¨nh thu·ªëc ƒë·ªôc."})]}),t.jsxs("li",{children:[t.jsxs("strong",{children:["üèπ ",v({en:"Hunter",vi:"Th·ª£ SƒÉn"})]}),":"," ",v({en:"Can shoot one person when dying.",vi:"C√≥ th·ªÉ b·∫Øn m·ªôt ng∆∞·ªùi khi ch·∫øt."})]}),t.jsxs("li",{children:[t.jsxs("strong",{children:["üíò ",v({en:"Cupid",vi:"Th·∫ßn T√¨nh Y√™u"})]}),":"," ",v({en:"Links two lovers. If one dies, the other follows.",vi:"K·∫øt ƒë√¥i hai ng∆∞·ªùi. N·∫øu m·ªôt ng∆∞·ªùi ch·∫øt, ng∆∞·ªùi kia ch·∫øt theo."})]})]})]}),t.jsxs("section",{children:[t.jsx("h3",{className:"text-lg font-bold text-yellow-400 mt-4",children:v({en:"Phases",vi:"Giai ƒêo·∫°n"})}),t.jsxs("ul",{className:"space-y-2 list-disc pl-4 text-sm",children:[t.jsxs("li",{children:[t.jsxs("strong",{children:["üåô ",v({en:"Night",vi:"ƒê√™m"})]}),":"," ",v({en:"Special roles wake up and perform actions.",vi:"C√°c vai tr√≤ ƒë·∫∑c bi·ªát th·ª©c d·∫≠y v√† h√†nh ƒë·ªông."})]}),t.jsxs("li",{children:[t.jsxs("strong",{children:["‚òÄÔ∏è ",v({en:"Morning",vi:"S√°ng"})]}),":"," ",v({en:"Announce who died last night.",vi:"Th√¥ng b√°o ai ƒë√£ ch·∫øt ƒë√™m qua."})]}),t.jsxs("li",{children:[t.jsxs("strong",{children:["üí¨ ",v({en:"Discussion",vi:"Th·∫£o Lu·∫≠n"})]}),":"," ",v({en:"Players discuss to find the wolves.",vi:"Ng∆∞·ªùi ch∆°i th·∫£o lu·∫≠n ƒë·ªÉ t√¨m ra s√≥i."})]}),t.jsxs("li",{children:[t.jsxs("strong",{children:["üëé ",v({en:"Voting",vi:"B√¨nh Ch·ªçn"})]}),":"," ",v({en:"Vote to eliminate one suspect.",vi:"B√¨nh ch·ªçn ƒë·ªÉ treo c·ªï m·ªôt k·∫ª t√¨nh nghi."})]})]})]})]})]})]})});return t.jsxs("div",{className:`relative flex flex-col h-full ${q} rounded-lg text-white overflow-hidden`,children:[N&&z(),V&&t.jsx("div",{className:`absolute inset-0 ${V} animate-slide-in z-0`,onAnimationEnd:()=>{E(V),L(null)}}),t.jsxs("div",{className:"relative z-10 flex flex-col h-full w-full pb-20 overflow-y-auto min-h-[500px] pt-2",children:["night"===w.phase?t.jsx(i,{className:"w-16 h-16 text-white absolute top-4 left-4 z-[-1]"}):"voting"==w.phase?t.jsx(l,{className:"w-16 h-16 text-yellow-500 absolute top-4 left-4 z-[-1]"}):"setup"!=w.phase?t.jsx(r,{className:"w-16 h-16 text-yellow-500 absolute top-4 left-4 z-[-1]"}):null,t.jsx("div",{className:"flex items-center gap-2 w-full justify-center",children:b.isHost&&w.isGameStarted&&t.jsxs("button",{onClick:async()=>{await f(j({vi:"B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën ch∆°i l·∫°i v√°n n√†y?",en:"Are you sure you want to reset this game?"}),j({vi:"Ch∆°i l·∫°i",en:"Play again"}))&&b.requestResetGame()},className:"p-2 bg-slate-500/20 text-slate-400 hover:bg-slate-500/30 rounded-lg text-xs flex items-center gap-1",children:[t.jsx(o,{className:"w-3 h-3"})," ",v({vi:"V√°n m·ªõi",en:"New Game"})]})}),w.isGameStarted&&H&&t.jsx("div",{className:"flex flex-col items-center justify-center gap-4 mb-3 py-2",children:t.jsxs("div",{className:"px-4 py-2 rounded-xl flex flex-col items-center gap-2",style:{backgroundColor:H.color+"30",border:`2px solid ${H.color}`},children:[t.jsx("span",{className:"text-sm text-white/60",children:v({en:"You are",vi:"B·∫°n l√†:"})}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-2xl",children:H.icon}),t.jsx("span",{className:"font-bold text-lg",style:{color:H.color},children:v(H.name)})]}),t.jsx("span",{className:"text-sm text-white/60",children:v(H.description)})]})}),w.isGameStarted&&t.jsxs(t.Fragment,{children:[t.jsx("div",{ref:B,className:"w-full h-px -mt-2 pointer-events-none"}),A&&c.createPortal($(!0),document.body),$(!1)]}),w.isGameStarted&&"setup"!==w.phase&&t.jsx(J,{state:w,currentUserId:p,selectedTargetIds:[R,I],showRoles:"end"===w.phase,canSelectPlayer:e=>{const s=w.players.find(e=>e.id===p),t="hunterRevenge"===w.phase&&"hunter"===s?.role&&w.pendingElimination===s.id;return!(!s?.isAlive&&!t)&&(!(!e.isAlive&&"night"!==w.phase)&&("night"===w.phase?"cupid"===s?.role?e.isAlive:"seer"===s?.role?e.id!==p&&e.isAlive:"bodyguard"===s?.role?e.isAlive&&e.id!==w.nightActions.lastBodyguardTarget:("wolf"===s?.role||"witch"===s?.role)&&e.isAlive:("discussion"===w.phase||"voting"===w.phase||"hunterRevenge"===w.phase)&&(("voting"!==w.phase&&"hunterRevenge"!==w.phase||!s?.hasVoted)&&(e.isAlive&&e.id!==p))))},onPlayerClick:e=>{const s=w.players.find(e=>e.id===p);"night"===w.phase&&"cupid"===s?.role?R?R===e?T(null):I?I===e&&P(null):P(e):T(e):T(R===e?null:e)}}),t.jsx("div",{className:"flex-1",children:(()=>{switch(w.phase){case"setup":return t.jsx(_,{game:b,state:w,currentUserId:p,isHost:b.isHost});case"night":return t.jsx(Q,{game:b,state:w,currentUserId:p,selectedTarget:R,secondSelectedTarget:I});case"morning":case"elimination":return t.jsxs("div",{className:"flex flex-col items-center justify-center h-full",children:[t.jsx(r,{className:"w-16 h-16 text-yellow-400 mb-4"}),w.logs.slice(-3).map(e=>t.jsx("p",{className:"text-center mb-2",children:v(e.message)},e.id)),"morning"===w.phase&&"seer"===G?.role&&w.nightResult?.seerCheck&&t.jsxs("div",{className:"mt-4 p-4 bg-indigo-500/20 rounded-xl border border-indigo-500/50",children:[t.jsx("p",{className:"text-center text-indigo-300 font-bold mb-1",children:v({vi:"K·∫øt qu·∫£ soi:",en:"Seer Result:"})}),t.jsxs("p",{className:"text-center",children:[t.jsx("span",{className:"font-bold text-white",children:w.players.find(e=>e.id===w.nightResult?.seerCheck?.targetId)?.username})," ",w.nightResult.seerCheck.isWolf?t.jsx("span",{className:"text-red-400 font-bold",children:v({vi:"l√† MA S√ìI!",en:"is a WEREWOLF!"})}):t.jsx("span",{className:"text-green-400 font-bold",children:v({vi:"l√† D√¢n L√†ng",en:"is a Villager"})})]})]})]});case"discussion":return t.jsx(Z,{game:b,state:w,currentUserId:p,selectedTarget:R});case"voting":case"hunterRevenge":return t.jsx(ee,{game:b,state:w,currentUserId:p,selectedTarget:R});case"end":return t.jsx(se,{game:b,state:w,showResetButton:b.isHost});default:return null}})()})]}),w.isGameStarted&&t.jsx("button",{onClick:()=>C(!0),className:"fixed bottom-4 left-4 p-3 bg-slate-700 hover:bg-slate-600 rounded-full text-blue-400 transition-colors z-40 shadow-lg border border-slate-500",title:j({en:"History",vi:"L·ªãch s·ª≠"}),children:t.jsx(d,{size:24})}),S&&t.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-[100] flex items-center justify-center p-4",children:t.jsxs("div",{className:"bg-slate-900 border border-white/10 rounded-2xl max-w-lg w-full h-[80vh] max-h-[90%] overflow-hidden shadow-2xl flex flex-col",children:[t.jsxs("div",{className:"px-4 py-3 border-b border-white/10 flex items-center justify-between bg-slate-900",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-blue-500 to-cyan-500 flex items-center justify-center font-bold text-base",children:t.jsx(d,{className:"w-4 h-4 text-white"})}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-bold text-white text-sm",children:v({en:"Game History",vi:"L·ªãch s·ª≠ v√°n ƒë·∫•u"})}),t.jsx("p",{className:"text-[10px] text-white/60",children:v({vi:"Nh·∫≠t k√Ω tr√≤ ch∆°i",en:"Game Log"})})]})]}),t.jsx("button",{onClick:()=>C(!1),className:"p-1.5 hover:bg-white/10 rounded-full transition-colors",children:t.jsx(x,{className:"w-4 h-4"})})]}),t.jsx("div",{className:"flex-1 overflow-hidden p-2",children:t.jsx(K,{state:w,currentUserId:p})})]})}),N&&z(),t.jsx("button",{onClick:()=>k(!0),className:"fixed bottom-4 right-4 p-3 bg-slate-700 hover:bg-slate-600 rounded-full text-yellow-500 transition-colors z-40 shadow-lg border border-slate-500",title:j({en:"Game Rules",vi:"Lu·∫≠t ch∆°i"}),children:t.jsx(h,{size:24})})]})};export{te as default};
